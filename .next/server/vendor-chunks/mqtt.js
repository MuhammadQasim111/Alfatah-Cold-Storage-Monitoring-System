"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/mqtt";
exports.ids = ["vendor-chunks/mqtt"];
exports.modules = {

/***/ "(ssr)/./node_modules/mqtt/build/index.js":
/*!******************************************!*\
  !*** ./node_modules/mqtt/build/index.js ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst mqtt = __importStar(__webpack_require__(/*! ./mqtt */ \"(ssr)/./node_modules/mqtt/build/mqtt.js\"));\nexports[\"default\"] = mqtt;\n__exportStar(__webpack_require__(/*! ./mqtt */ \"(ssr)/./node_modules/mqtt/build/mqtt.js\"), exports);\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxvQ0FBb0M7QUFDbkQ7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMENBQTBDLDRCQUE0QjtBQUN0RSxDQUFDO0FBQ0Q7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELGNBQWM7QUFDekU7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCwwQkFBMEIsbUJBQU8sQ0FBQyx1REFBUTtBQUMxQyxrQkFBZTtBQUNmLGFBQWEsbUJBQU8sQ0FBQyx1REFBUTtBQUM3QiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9pbmRleC5qcz9lM2YwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIG9bazJdID0gbVtrXTtcbn0pKTtcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCkgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcbn0pIDogZnVuY3Rpb24obywgdikge1xuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbn0pO1xudmFyIF9faW1wb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBvd25LZXlzID0gZnVuY3Rpb24obykge1xuICAgICAgICBvd25LZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgIHZhciBhciA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgayBpbiBvKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIGspKSBhclthci5sZW5ndGhdID0gaztcbiAgICAgICAgICAgIHJldHVybiBhcjtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG93bktleXMobyk7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1vZCkge1xuICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayA9IG93bktleXMobW9kKSwgaSA9IDA7IGkgPCBrLmxlbmd0aDsgaSsrKSBpZiAoa1tpXSAhPT0gXCJkZWZhdWx0XCIpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwga1tpXSk7XG4gICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbn0pKCk7XG52YXIgX19leHBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2V4cG9ydFN0YXIpIHx8IGZ1bmN0aW9uKG0sIGV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGV4cG9ydHMsIHApKSBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0cywgbSwgcCk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgbXF0dCA9IF9faW1wb3J0U3RhcihyZXF1aXJlKFwiLi9tcXR0XCIpKTtcbmV4cG9ydHMuZGVmYXVsdCA9IG1xdHQ7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vbXF0dFwiKSwgZXhwb3J0cyk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/BufferedDuplex.js":
/*!*******************************************************!*\
  !*** ./node_modules/mqtt/build/lib/BufferedDuplex.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.BufferedDuplex = void 0;\nexports.writev = writev;\nconst readable_stream_1 = __webpack_require__(/*! readable-stream */ \"(ssr)/./node_modules/readable-stream/lib/ours/index.js\");\nconst buffer_1 = __webpack_require__(/*! buffer */ \"buffer\");\nfunction writev(chunks, cb) {\n    const buffers = new Array(chunks.length);\n    for (let i = 0; i < chunks.length; i++) {\n        if (typeof chunks[i].chunk === 'string') {\n            buffers[i] = buffer_1.Buffer.from(chunks[i].chunk, 'utf8');\n        }\n        else {\n            buffers[i] = chunks[i].chunk;\n        }\n    }\n    this._write(buffer_1.Buffer.concat(buffers), 'binary', cb);\n}\nclass BufferedDuplex extends readable_stream_1.Duplex {\n    socket;\n    proxy;\n    isSocketOpen;\n    writeQueue;\n    constructor(opts, proxy, socket) {\n        super({\n            objectMode: true,\n        });\n        this.proxy = proxy;\n        this.socket = socket;\n        this.writeQueue = [];\n        if (!opts.objectMode) {\n            this._writev = writev.bind(this);\n        }\n        this.isSocketOpen = false;\n        this.proxy.on('data', (chunk) => {\n            if (!this.destroyed && this.readable) {\n                this.push(chunk);\n            }\n        });\n    }\n    _read(size) {\n        this.proxy.read(size);\n    }\n    _write(chunk, encoding, cb) {\n        if (!this.isSocketOpen) {\n            this.writeQueue.push({ chunk, encoding, cb });\n        }\n        else {\n            this.writeToProxy(chunk, encoding, cb);\n        }\n    }\n    _final(callback) {\n        this.writeQueue = [];\n        this.proxy.end(callback);\n    }\n    _destroy(err, callback) {\n        this.writeQueue = [];\n        this.proxy.destroy();\n        callback(err);\n    }\n    socketReady() {\n        this.emit('connect');\n        this.isSocketOpen = true;\n        this.processWriteQueue();\n    }\n    writeToProxy(chunk, encoding, cb) {\n        if (this.proxy.write(chunk, encoding) === false) {\n            this.proxy.once('drain', cb);\n        }\n        else {\n            cb();\n        }\n    }\n    processWriteQueue() {\n        while (this.writeQueue.length > 0) {\n            const { chunk, encoding, cb } = this.writeQueue.shift();\n            this.writeToProxy(chunk, encoding, cb);\n        }\n    }\n}\nexports.BufferedDuplex = BufferedDuplex;\n//# sourceMappingURL=BufferedDuplex.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvQnVmZmVyZWREdXBsZXguanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsc0JBQXNCO0FBQ3RCLGNBQWM7QUFDZCwwQkFBMEIsbUJBQU8sQ0FBQywrRUFBaUI7QUFDbkQsaUJBQWlCLG1CQUFPLENBQUMsc0JBQVE7QUFDakM7QUFDQTtBQUNBLG9CQUFvQixtQkFBbUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxxQkFBcUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL0J1ZmZlcmVkRHVwbGV4LmpzPzY2MzAiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkJ1ZmZlcmVkRHVwbGV4ID0gdm9pZCAwO1xuZXhwb3J0cy53cml0ZXYgPSB3cml0ZXY7XG5jb25zdCByZWFkYWJsZV9zdHJlYW1fMSA9IHJlcXVpcmUoXCJyZWFkYWJsZS1zdHJlYW1cIik7XG5jb25zdCBidWZmZXJfMSA9IHJlcXVpcmUoXCJidWZmZXJcIik7XG5mdW5jdGlvbiB3cml0ZXYoY2h1bmtzLCBjYikge1xuICAgIGNvbnN0IGJ1ZmZlcnMgPSBuZXcgQXJyYXkoY2h1bmtzLmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaHVua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjaHVua3NbaV0uY2h1bmsgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBidWZmZXJzW2ldID0gYnVmZmVyXzEuQnVmZmVyLmZyb20oY2h1bmtzW2ldLmNodW5rLCAndXRmOCcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYnVmZmVyc1tpXSA9IGNodW5rc1tpXS5jaHVuaztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aGlzLl93cml0ZShidWZmZXJfMS5CdWZmZXIuY29uY2F0KGJ1ZmZlcnMpLCAnYmluYXJ5JywgY2IpO1xufVxuY2xhc3MgQnVmZmVyZWREdXBsZXggZXh0ZW5kcyByZWFkYWJsZV9zdHJlYW1fMS5EdXBsZXgge1xuICAgIHNvY2tldDtcbiAgICBwcm94eTtcbiAgICBpc1NvY2tldE9wZW47XG4gICAgd3JpdGVRdWV1ZTtcbiAgICBjb25zdHJ1Y3RvcihvcHRzLCBwcm94eSwgc29ja2V0KSB7XG4gICAgICAgIHN1cGVyKHtcbiAgICAgICAgICAgIG9iamVjdE1vZGU6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnByb3h5ID0gcHJveHk7XG4gICAgICAgIHRoaXMuc29ja2V0ID0gc29ja2V0O1xuICAgICAgICB0aGlzLndyaXRlUXVldWUgPSBbXTtcbiAgICAgICAgaWYgKCFvcHRzLm9iamVjdE1vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3dyaXRldiA9IHdyaXRldi5iaW5kKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNTb2NrZXRPcGVuID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJveHkub24oJ2RhdGEnLCAoY2h1bmspID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5kZXN0cm95ZWQgJiYgdGhpcy5yZWFkYWJsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHVzaChjaHVuayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfcmVhZChzaXplKSB7XG4gICAgICAgIHRoaXMucHJveHkucmVhZChzaXplKTtcbiAgICB9XG4gICAgX3dyaXRlKGNodW5rLCBlbmNvZGluZywgY2IpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU29ja2V0T3Blbikge1xuICAgICAgICAgICAgdGhpcy53cml0ZVF1ZXVlLnB1c2goeyBjaHVuaywgZW5jb2RpbmcsIGNiIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy53cml0ZVRvUHJveHkoY2h1bmssIGVuY29kaW5nLCBjYik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2ZpbmFsKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMud3JpdGVRdWV1ZSA9IFtdO1xuICAgICAgICB0aGlzLnByb3h5LmVuZChjYWxsYmFjayk7XG4gICAgfVxuICAgIF9kZXN0cm95KGVyciwgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy53cml0ZVF1ZXVlID0gW107XG4gICAgICAgIHRoaXMucHJveHkuZGVzdHJveSgpO1xuICAgICAgICBjYWxsYmFjayhlcnIpO1xuICAgIH1cbiAgICBzb2NrZXRSZWFkeSgpIHtcbiAgICAgICAgdGhpcy5lbWl0KCdjb25uZWN0Jyk7XG4gICAgICAgIHRoaXMuaXNTb2NrZXRPcGVuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcm9jZXNzV3JpdGVRdWV1ZSgpO1xuICAgIH1cbiAgICB3cml0ZVRvUHJveHkoY2h1bmssIGVuY29kaW5nLCBjYikge1xuICAgICAgICBpZiAodGhpcy5wcm94eS53cml0ZShjaHVuaywgZW5jb2RpbmcpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5wcm94eS5vbmNlKCdkcmFpbicsIGNiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNiKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc1dyaXRlUXVldWUoKSB7XG4gICAgICAgIHdoaWxlICh0aGlzLndyaXRlUXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgeyBjaHVuaywgZW5jb2RpbmcsIGNiIH0gPSB0aGlzLndyaXRlUXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgIHRoaXMud3JpdGVUb1Byb3h5KGNodW5rLCBlbmNvZGluZywgY2IpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5CdWZmZXJlZER1cGxleCA9IEJ1ZmZlcmVkRHVwbGV4O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QnVmZmVyZWREdXBsZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/BufferedDuplex.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/KeepaliveManager.js":
/*!*********************************************************!*\
  !*** ./node_modules/mqtt/build/lib/KeepaliveManager.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst get_timer_1 = __importDefault(__webpack_require__(/*! ./get-timer */ \"(ssr)/./node_modules/mqtt/build/lib/get-timer.js\"));\nclass KeepaliveManager {\n    _keepalive;\n    timerId;\n    timer;\n    destroyed = false;\n    counter;\n    client;\n    _keepaliveTimeoutTimestamp;\n    _intervalEvery;\n    get keepaliveTimeoutTimestamp() {\n        return this._keepaliveTimeoutTimestamp;\n    }\n    get intervalEvery() {\n        return this._intervalEvery;\n    }\n    get keepalive() {\n        return this._keepalive;\n    }\n    constructor(client, variant) {\n        this.client = client;\n        this.timer =\n            typeof variant === 'object' &&\n                'set' in variant &&\n                'clear' in variant\n                ? variant\n                : (0, get_timer_1.default)(variant);\n        this.setKeepalive(client.options.keepalive);\n    }\n    clear() {\n        if (this.timerId) {\n            this.timer.clear(this.timerId);\n            this.timerId = null;\n        }\n    }\n    setKeepalive(value) {\n        value *= 1000;\n        if (isNaN(value) || value <= 0 || value > 2147483647) {\n            throw new Error(`Keepalive value must be an integer between 0 and 2147483647. Provided value is ${value}`);\n        }\n        this._keepalive = value;\n        this.reschedule();\n        this.client['log'](`KeepaliveManager: set keepalive to ${value}ms`);\n    }\n    destroy() {\n        this.clear();\n        this.destroyed = true;\n    }\n    reschedule() {\n        if (this.destroyed) {\n            return;\n        }\n        this.clear();\n        this.counter = 0;\n        const keepAliveTimeout = Math.ceil(this._keepalive * 1.5);\n        this._keepaliveTimeoutTimestamp = Date.now() + keepAliveTimeout;\n        this._intervalEvery = Math.ceil(this._keepalive / 2);\n        this.timerId = this.timer.set(() => {\n            if (this.destroyed) {\n                return;\n            }\n            this.counter += 1;\n            if (this.counter === 2) {\n                this.client.sendPing();\n            }\n            else if (this.counter > 2) {\n                this.client.onKeepaliveTimeout();\n            }\n        }, this._intervalEvery);\n    }\n}\nexports[\"default\"] = KeepaliveManager;\n//# sourceMappingURL=KeepaliveManager.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvS2VlcGFsaXZlTWFuYWdlci5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELG9DQUFvQyxtQkFBTyxDQUFDLHFFQUFhO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEdBQThHLE1BQU07QUFDcEg7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLE1BQU07QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL0tlZXBhbGl2ZU1hbmFnZXIuanM/NmE4YSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IGdldF90aW1lcl8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL2dldC10aW1lclwiKSk7XG5jbGFzcyBLZWVwYWxpdmVNYW5hZ2VyIHtcbiAgICBfa2VlcGFsaXZlO1xuICAgIHRpbWVySWQ7XG4gICAgdGltZXI7XG4gICAgZGVzdHJveWVkID0gZmFsc2U7XG4gICAgY291bnRlcjtcbiAgICBjbGllbnQ7XG4gICAgX2tlZXBhbGl2ZVRpbWVvdXRUaW1lc3RhbXA7XG4gICAgX2ludGVydmFsRXZlcnk7XG4gICAgZ2V0IGtlZXBhbGl2ZVRpbWVvdXRUaW1lc3RhbXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZWVwYWxpdmVUaW1lb3V0VGltZXN0YW1wO1xuICAgIH1cbiAgICBnZXQgaW50ZXJ2YWxFdmVyeSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludGVydmFsRXZlcnk7XG4gICAgfVxuICAgIGdldCBrZWVwYWxpdmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZWVwYWxpdmU7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGNsaWVudCwgdmFyaWFudCkge1xuICAgICAgICB0aGlzLmNsaWVudCA9IGNsaWVudDtcbiAgICAgICAgdGhpcy50aW1lciA9XG4gICAgICAgICAgICB0eXBlb2YgdmFyaWFudCA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgICAgICAgICAnc2V0JyBpbiB2YXJpYW50ICYmXG4gICAgICAgICAgICAgICAgJ2NsZWFyJyBpbiB2YXJpYW50XG4gICAgICAgICAgICAgICAgPyB2YXJpYW50XG4gICAgICAgICAgICAgICAgOiAoMCwgZ2V0X3RpbWVyXzEuZGVmYXVsdCkodmFyaWFudCk7XG4gICAgICAgIHRoaXMuc2V0S2VlcGFsaXZlKGNsaWVudC5vcHRpb25zLmtlZXBhbGl2ZSk7XG4gICAgfVxuICAgIGNsZWFyKCkge1xuICAgICAgICBpZiAodGhpcy50aW1lcklkKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVyLmNsZWFyKHRoaXMudGltZXJJZCk7XG4gICAgICAgICAgICB0aGlzLnRpbWVySWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldEtlZXBhbGl2ZSh2YWx1ZSkge1xuICAgICAgICB2YWx1ZSAqPSAxMDAwO1xuICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlIDw9IDAgfHwgdmFsdWUgPiAyMTQ3NDgzNjQ3KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEtlZXBhbGl2ZSB2YWx1ZSBtdXN0IGJlIGFuIGludGVnZXIgYmV0d2VlbiAwIGFuZCAyMTQ3NDgzNjQ3LiBQcm92aWRlZCB2YWx1ZSBpcyAke3ZhbHVlfWApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2tlZXBhbGl2ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnJlc2NoZWR1bGUoKTtcbiAgICAgICAgdGhpcy5jbGllbnRbJ2xvZyddKGBLZWVwYWxpdmVNYW5hZ2VyOiBzZXQga2VlcGFsaXZlIHRvICR7dmFsdWV9bXNgKTtcbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7XG4gICAgfVxuICAgIHJlc2NoZWR1bGUoKSB7XG4gICAgICAgIGlmICh0aGlzLmRlc3Ryb3llZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5jb3VudGVyID0gMDtcbiAgICAgICAgY29uc3Qga2VlcEFsaXZlVGltZW91dCA9IE1hdGguY2VpbCh0aGlzLl9rZWVwYWxpdmUgKiAxLjUpO1xuICAgICAgICB0aGlzLl9rZWVwYWxpdmVUaW1lb3V0VGltZXN0YW1wID0gRGF0ZS5ub3coKSArIGtlZXBBbGl2ZVRpbWVvdXQ7XG4gICAgICAgIHRoaXMuX2ludGVydmFsRXZlcnkgPSBNYXRoLmNlaWwodGhpcy5fa2VlcGFsaXZlIC8gMik7XG4gICAgICAgIHRoaXMudGltZXJJZCA9IHRoaXMudGltZXIuc2V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmRlc3Ryb3llZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY291bnRlciArPSAxO1xuICAgICAgICAgICAgaWYgKHRoaXMuY291bnRlciA9PT0gMikge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xpZW50LnNlbmRQaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmNvdW50ZXIgPiAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGllbnQub25LZWVwYWxpdmVUaW1lb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMuX2ludGVydmFsRXZlcnkpO1xuICAgIH1cbn1cbmV4cG9ydHMuZGVmYXVsdCA9IEtlZXBhbGl2ZU1hbmFnZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1LZWVwYWxpdmVNYW5hZ2VyLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/KeepaliveManager.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/TypedEmitter.js":
/*!*****************************************************!*\
  !*** ./node_modules/mqtt/build/lib/TypedEmitter.js ***!
  \*****************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.TypedEventEmitter = void 0;\nconst events_1 = __importDefault(__webpack_require__(/*! events */ \"events\"));\nconst shared_1 = __webpack_require__(/*! ./shared */ \"(ssr)/./node_modules/mqtt/build/lib/shared.js\");\nclass TypedEventEmitter {\n}\nexports.TypedEventEmitter = TypedEventEmitter;\n(0, shared_1.applyMixin)(TypedEventEmitter, events_1.default);\n//# sourceMappingURL=TypedEmitter.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvVHlwZWRFbWl0dGVyLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2I7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QseUJBQXlCO0FBQ3pCLGlDQUFpQyxtQkFBTyxDQUFDLHNCQUFRO0FBQ2pELGlCQUFpQixtQkFBTyxDQUFDLCtEQUFVO0FBQ25DO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvVHlwZWRFbWl0dGVyLmpzPzI0OWUiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLlR5cGVkRXZlbnRFbWl0dGVyID0gdm9pZCAwO1xuY29uc3QgZXZlbnRzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcImV2ZW50c1wiKSk7XG5jb25zdCBzaGFyZWRfMSA9IHJlcXVpcmUoXCIuL3NoYXJlZFwiKTtcbmNsYXNzIFR5cGVkRXZlbnRFbWl0dGVyIHtcbn1cbmV4cG9ydHMuVHlwZWRFdmVudEVtaXR0ZXIgPSBUeXBlZEV2ZW50RW1pdHRlcjtcbigwLCBzaGFyZWRfMS5hcHBseU1peGluKShUeXBlZEV2ZW50RW1pdHRlciwgZXZlbnRzXzEuZGVmYXVsdCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1UeXBlZEVtaXR0ZXIuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/TypedEmitter.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/client.js":
/*!***********************************************!*\
  !*** ./node_modules/mqtt/build/lib/client.js ***!
  \***********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst mqtt_packet_1 = __importDefault(__webpack_require__(/*! mqtt-packet */ \"(ssr)/./node_modules/mqtt-packet/mqtt.js\"));\nconst readable_stream_1 = __webpack_require__(/*! readable-stream */ \"(ssr)/./node_modules/readable-stream/lib/ours/index.js\");\nconst default_1 = __importDefault(__webpack_require__(/*! rfdc/default */ \"(ssr)/./node_modules/rfdc/default.js\"));\nconst debug_1 = __importDefault(__webpack_require__(/*! debug */ \"(ssr)/./node_modules/debug/src/index.js\"));\nconst validations = __importStar(__webpack_require__(/*! ./validations */ \"(ssr)/./node_modules/mqtt/build/lib/validations.js\"));\nconst store_1 = __importDefault(__webpack_require__(/*! ./store */ \"(ssr)/./node_modules/mqtt/build/lib/store.js\"));\nconst handlers_1 = __importDefault(__webpack_require__(/*! ./handlers */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/index.js\"));\nconst default_message_id_provider_1 = __importDefault(__webpack_require__(/*! ./default-message-id-provider */ \"(ssr)/./node_modules/mqtt/build/lib/default-message-id-provider.js\"));\nconst topic_alias_recv_1 = __importDefault(__webpack_require__(/*! ./topic-alias-recv */ \"(ssr)/./node_modules/mqtt/build/lib/topic-alias-recv.js\"));\nconst shared_1 = __webpack_require__(/*! ./shared */ \"(ssr)/./node_modules/mqtt/build/lib/shared.js\");\nconst TypedEmitter_1 = __webpack_require__(/*! ./TypedEmitter */ \"(ssr)/./node_modules/mqtt/build/lib/TypedEmitter.js\");\nconst KeepaliveManager_1 = __importDefault(__webpack_require__(/*! ./KeepaliveManager */ \"(ssr)/./node_modules/mqtt/build/lib/KeepaliveManager.js\"));\nconst is_browser_1 = __importStar(__webpack_require__(/*! ./is-browser */ \"(ssr)/./node_modules/mqtt/build/lib/is-browser.js\"));\nconst setImmediate = globalThis.setImmediate ||\n    ((...args) => {\n        const callback = args.shift();\n        (0, shared_1.nextTick)(() => {\n            callback(...args);\n        });\n    });\nconst defaultConnectOptions = {\n    keepalive: 60,\n    reschedulePings: true,\n    protocolId: 'MQTT',\n    protocolVersion: 4,\n    reconnectPeriod: 1000,\n    connectTimeout: 30 * 1000,\n    clean: true,\n    resubscribe: true,\n    subscribeBatchSize: null,\n    writeCache: true,\n    timerVariant: 'auto',\n};\nclass MqttClient extends TypedEmitter_1.TypedEventEmitter {\n    static VERSION = shared_1.MQTTJS_VERSION;\n    connected;\n    disconnecting;\n    disconnected;\n    reconnecting;\n    incomingStore;\n    outgoingStore;\n    options;\n    queueQoSZero;\n    _reconnectCount;\n    log;\n    messageIdProvider;\n    outgoing;\n    messageIdToTopic;\n    noop;\n    keepaliveManager;\n    stream;\n    queue;\n    streamBuilder;\n    _resubscribeTopics;\n    connackTimer;\n    reconnectTimer;\n    _storeProcessing;\n    _packetIdsDuringStoreProcessing;\n    _storeProcessingQueue;\n    _firstConnection;\n    topicAliasRecv;\n    topicAliasSend;\n    _deferredReconnect;\n    connackPacket;\n    static defaultId() {\n        return `mqttjs_${Math.random().toString(16).substr(2, 8)}`;\n    }\n    constructor(streamBuilder, options) {\n        super();\n        this.options = options || {};\n        for (const k in defaultConnectOptions) {\n            if (typeof this.options[k] === 'undefined') {\n                this.options[k] = defaultConnectOptions[k];\n            }\n            else {\n                this.options[k] = options[k];\n            }\n        }\n        this.log = this.options.log || (0, debug_1.default)('mqttjs:client');\n        this.noop = this._noop.bind(this);\n        this.log('MqttClient :: version:', MqttClient.VERSION);\n        if (is_browser_1.isWebWorker) {\n            this.log('MqttClient :: environment', 'webworker');\n        }\n        else {\n            this.log('MqttClient :: environment', is_browser_1.default ? 'browser' : 'node');\n        }\n        this.log('MqttClient :: options.protocol', options.protocol);\n        this.log('MqttClient :: options.protocolVersion', options.protocolVersion);\n        this.log('MqttClient :: options.username', options.username);\n        this.log('MqttClient :: options.keepalive', options.keepalive);\n        this.log('MqttClient :: options.reconnectPeriod', options.reconnectPeriod);\n        this.log('MqttClient :: options.rejectUnauthorized', options.rejectUnauthorized);\n        this.log('MqttClient :: options.properties.topicAliasMaximum', options.properties\n            ? options.properties.topicAliasMaximum\n            : undefined);\n        this.options.clientId =\n            typeof options.clientId === 'string'\n                ? options.clientId\n                : MqttClient.defaultId();\n        this.log('MqttClient :: clientId', this.options.clientId);\n        this.options.customHandleAcks =\n            options.protocolVersion === 5 && options.customHandleAcks\n                ? options.customHandleAcks\n                : (...args) => {\n                    args[3](null, 0);\n                };\n        if (!this.options.writeCache) {\n            mqtt_packet_1.default.writeToStream.cacheNumbers = false;\n        }\n        this.streamBuilder = streamBuilder;\n        this.messageIdProvider =\n            typeof this.options.messageIdProvider === 'undefined'\n                ? new default_message_id_provider_1.default()\n                : this.options.messageIdProvider;\n        this.outgoingStore = options.outgoingStore || new store_1.default();\n        this.incomingStore = options.incomingStore || new store_1.default();\n        this.queueQoSZero =\n            options.queueQoSZero === undefined ? true : options.queueQoSZero;\n        this._resubscribeTopics = {};\n        this.messageIdToTopic = {};\n        this.keepaliveManager = null;\n        this.connected = false;\n        this.disconnecting = false;\n        this.reconnecting = false;\n        this.queue = [];\n        this.connackTimer = null;\n        this.reconnectTimer = null;\n        this._storeProcessing = false;\n        this._packetIdsDuringStoreProcessing = {};\n        this._storeProcessingQueue = [];\n        this.outgoing = {};\n        this._firstConnection = true;\n        if (options.properties && options.properties.topicAliasMaximum > 0) {\n            if (options.properties.topicAliasMaximum > 0xffff) {\n                this.log('MqttClient :: options.properties.topicAliasMaximum is out of range');\n            }\n            else {\n                this.topicAliasRecv = new topic_alias_recv_1.default(options.properties.topicAliasMaximum);\n            }\n        }\n        this.on('connect', () => {\n            const { queue } = this;\n            const deliver = () => {\n                const entry = queue.shift();\n                this.log('deliver :: entry %o', entry);\n                let packet = null;\n                if (!entry) {\n                    this._resubscribe();\n                    return;\n                }\n                packet = entry.packet;\n                this.log('deliver :: call _sendPacket for %o', packet);\n                let send = true;\n                if (packet.messageId && packet.messageId !== 0) {\n                    if (!this.messageIdProvider.register(packet.messageId)) {\n                        send = false;\n                    }\n                }\n                if (send) {\n                    this._sendPacket(packet, (err) => {\n                        if (entry.cb) {\n                            entry.cb(err);\n                        }\n                        deliver();\n                    });\n                }\n                else {\n                    this.log('messageId: %d has already used. The message is skipped and removed.', packet.messageId);\n                    deliver();\n                }\n            };\n            this.log('connect :: sending queued packets');\n            deliver();\n        });\n        this.on('close', () => {\n            this.log('close :: connected set to `false`');\n            this.connected = false;\n            this.log('close :: clearing connackTimer');\n            clearTimeout(this.connackTimer);\n            this._destroyKeepaliveManager();\n            if (this.topicAliasRecv) {\n                this.topicAliasRecv.clear();\n            }\n            this.log('close :: calling _setupReconnect');\n            this._setupReconnect();\n        });\n        if (!this.options.manualConnect) {\n            this.log('MqttClient :: setting up stream');\n            this.connect();\n        }\n    }\n    handleAuth(packet, callback) {\n        callback();\n    }\n    handleMessage(packet, callback) {\n        callback();\n    }\n    _nextId() {\n        return this.messageIdProvider.allocate();\n    }\n    getLastMessageId() {\n        return this.messageIdProvider.getLastAllocated();\n    }\n    connect() {\n        const writable = new readable_stream_1.Writable();\n        const parser = mqtt_packet_1.default.parser(this.options);\n        let completeParse = null;\n        const packets = [];\n        this.log('connect :: calling method to clear reconnect');\n        this._clearReconnect();\n        if (this.disconnected && !this.reconnecting) {\n            this.incomingStore = this.options.incomingStore || new store_1.default();\n            this.outgoingStore = this.options.outgoingStore || new store_1.default();\n            this.disconnecting = false;\n            this.disconnected = false;\n        }\n        this.log('connect :: using streamBuilder provided to client to create stream');\n        this.stream = this.streamBuilder(this);\n        parser.on('packet', (packet) => {\n            this.log('parser :: on packet push to packets array.');\n            packets.push(packet);\n        });\n        const work = () => {\n            this.log('work :: getting next packet in queue');\n            const packet = packets.shift();\n            if (packet) {\n                this.log('work :: packet pulled from queue');\n                (0, handlers_1.default)(this, packet, nextTickWork);\n            }\n            else {\n                this.log('work :: no packets in queue');\n                const done = completeParse;\n                completeParse = null;\n                this.log('work :: done flag is %s', !!done);\n                if (done)\n                    done();\n            }\n        };\n        const nextTickWork = () => {\n            if (packets.length) {\n                (0, shared_1.nextTick)(work);\n            }\n            else {\n                const done = completeParse;\n                completeParse = null;\n                done();\n            }\n        };\n        writable._write = (buf, enc, done) => {\n            completeParse = done;\n            this.log('writable stream :: parsing buffer');\n            parser.parse(buf);\n            work();\n        };\n        const streamErrorHandler = (error) => {\n            this.log('streamErrorHandler :: error', error.message);\n            if (error.code) {\n                this.log('streamErrorHandler :: emitting error');\n                this.emit('error', error);\n            }\n            else {\n                this.noop(error);\n            }\n        };\n        this.log('connect :: pipe stream to writable stream');\n        this.stream.pipe(writable);\n        this.stream.on('error', streamErrorHandler);\n        this.stream.on('close', () => {\n            this.log('(%s)stream :: on close', this.options.clientId);\n            this._flushVolatile();\n            this.log('stream: emit close to MqttClient');\n            this.emit('close');\n        });\n        this.log('connect: sending packet `connect`');\n        const connectPacket = {\n            cmd: 'connect',\n            protocolId: this.options.protocolId,\n            protocolVersion: this.options.protocolVersion,\n            clean: this.options.clean,\n            clientId: this.options.clientId,\n            keepalive: this.options.keepalive,\n            username: this.options.username,\n            password: this.options.password,\n            properties: this.options.properties,\n        };\n        if (this.options.will) {\n            connectPacket.will = {\n                ...this.options.will,\n                payload: this.options.will?.payload,\n            };\n        }\n        if (this.topicAliasRecv) {\n            if (!connectPacket.properties) {\n                connectPacket.properties = {};\n            }\n            if (this.topicAliasRecv) {\n                connectPacket.properties.topicAliasMaximum =\n                    this.topicAliasRecv.max;\n            }\n        }\n        this._writePacket(connectPacket);\n        parser.on('error', this.emit.bind(this, 'error'));\n        if (this.options.properties) {\n            if (!this.options.properties.authenticationMethod &&\n                this.options.properties.authenticationData) {\n                this.end(() => this.emit('error', new Error('Packet has no Authentication Method')));\n                return this;\n            }\n            if (this.options.properties.authenticationMethod &&\n                this.options.authPacket &&\n                typeof this.options.authPacket === 'object') {\n                const authPacket = {\n                    cmd: 'auth',\n                    reasonCode: 0,\n                    ...this.options.authPacket,\n                };\n                this._writePacket(authPacket);\n            }\n        }\n        this.stream.setMaxListeners(1000);\n        clearTimeout(this.connackTimer);\n        this.connackTimer = setTimeout(() => {\n            this.log('!!connectTimeout hit!! Calling _cleanUp with force `true`');\n            this.emit('error', new Error('connack timeout'));\n            this._cleanUp(true);\n        }, this.options.connectTimeout);\n        return this;\n    }\n    publish(topic, message, opts, callback) {\n        this.log('publish :: message `%s` to topic `%s`', message, topic);\n        const { options } = this;\n        if (typeof opts === 'function') {\n            callback = opts;\n            opts = null;\n        }\n        opts = opts || {};\n        const defaultOpts = {\n            qos: 0,\n            retain: false,\n            dup: false,\n        };\n        opts = { ...defaultOpts, ...opts };\n        const { qos, retain, dup, properties, cbStorePut } = opts;\n        if (this._checkDisconnecting(callback)) {\n            return this;\n        }\n        const publishProc = () => {\n            let messageId = 0;\n            if (qos === 1 || qos === 2) {\n                messageId = this._nextId();\n                if (messageId === null) {\n                    this.log('No messageId left');\n                    return false;\n                }\n            }\n            const packet = {\n                cmd: 'publish',\n                topic,\n                payload: message,\n                qos,\n                retain,\n                messageId,\n                dup,\n            };\n            if (options.protocolVersion === 5) {\n                packet.properties = properties;\n            }\n            this.log('publish :: qos', qos);\n            switch (qos) {\n                case 1:\n                case 2:\n                    this.outgoing[packet.messageId] = {\n                        volatile: false,\n                        cb: callback || this.noop,\n                    };\n                    this.log('MqttClient:publish: packet cmd: %s', packet.cmd);\n                    this._sendPacket(packet, undefined, cbStorePut);\n                    break;\n                default:\n                    this.log('MqttClient:publish: packet cmd: %s', packet.cmd);\n                    this._sendPacket(packet, callback, cbStorePut);\n                    break;\n            }\n            return true;\n        };\n        if (this._storeProcessing ||\n            this._storeProcessingQueue.length > 0 ||\n            !publishProc()) {\n            this._storeProcessingQueue.push({\n                invoke: publishProc,\n                cbStorePut: opts.cbStorePut,\n                callback,\n            });\n        }\n        return this;\n    }\n    publishAsync(topic, message, opts) {\n        return new Promise((resolve, reject) => {\n            this.publish(topic, message, opts, (err, packet) => {\n                if (err) {\n                    reject(err);\n                }\n                else {\n                    resolve(packet);\n                }\n            });\n        });\n    }\n    subscribe(topicObject, opts, callback) {\n        const version = this.options.protocolVersion;\n        if (typeof opts === 'function') {\n            callback = opts;\n        }\n        callback = callback || this.noop;\n        let resubscribe = false;\n        let topicsList = [];\n        if (typeof topicObject === 'string') {\n            topicObject = [topicObject];\n            topicsList = topicObject;\n        }\n        else if (Array.isArray(topicObject)) {\n            topicsList = topicObject;\n        }\n        else if (typeof topicObject === 'object') {\n            resubscribe = topicObject.resubscribe;\n            delete topicObject.resubscribe;\n            topicsList = Object.keys(topicObject);\n        }\n        const invalidTopic = validations.validateTopics(topicsList);\n        if (invalidTopic !== null) {\n            setImmediate(callback, new Error(`Invalid topic ${invalidTopic}`));\n            return this;\n        }\n        if (this._checkDisconnecting(callback)) {\n            this.log('subscribe: discconecting true');\n            return this;\n        }\n        const defaultOpts = {\n            qos: 0,\n        };\n        if (version === 5) {\n            defaultOpts.nl = false;\n            defaultOpts.rap = false;\n            defaultOpts.rh = 0;\n        }\n        opts = { ...defaultOpts, ...opts };\n        const { properties } = opts;\n        const subs = [];\n        const parseSub = (topic, subOptions) => {\n            subOptions = (subOptions || opts);\n            if (!Object.prototype.hasOwnProperty.call(this._resubscribeTopics, topic) ||\n                this._resubscribeTopics[topic].qos < subOptions.qos ||\n                resubscribe) {\n                const currentOpts = {\n                    topic,\n                    qos: subOptions.qos,\n                };\n                if (version === 5) {\n                    currentOpts.nl = subOptions.nl;\n                    currentOpts.rap = subOptions.rap;\n                    currentOpts.rh = subOptions.rh;\n                    currentOpts.properties = properties;\n                }\n                this.log('subscribe: pushing topic `%s` and qos `%s` to subs list', currentOpts.topic, currentOpts.qos);\n                subs.push(currentOpts);\n            }\n        };\n        if (Array.isArray(topicObject)) {\n            topicObject.forEach((topic) => {\n                this.log('subscribe: array topic %s', topic);\n                parseSub(topic);\n            });\n        }\n        else {\n            Object.keys(topicObject).forEach((topic) => {\n                this.log('subscribe: object topic %s, %o', topic, topicObject[topic]);\n                parseSub(topic, topicObject[topic]);\n            });\n        }\n        if (!subs.length) {\n            callback(null, []);\n            return this;\n        }\n        const subscribeChunkedSubs = (chunkedSubs, messageId) => {\n            const packet = {\n                cmd: 'subscribe',\n                subscriptions: chunkedSubs,\n                messageId,\n            };\n            if (properties) {\n                packet.properties = properties;\n            }\n            if (this.options.resubscribe) {\n                this.log('subscribe :: resubscribe true');\n                const topics = [];\n                chunkedSubs.forEach((sub) => {\n                    if (this.options.reconnectPeriod > 0) {\n                        const topic = { qos: sub.qos };\n                        if (version === 5) {\n                            topic.nl = sub.nl || false;\n                            topic.rap = sub.rap || false;\n                            topic.rh = sub.rh || 0;\n                            topic.properties = sub.properties;\n                        }\n                        this._resubscribeTopics[sub.topic] = topic;\n                        topics.push(sub.topic);\n                    }\n                });\n                this.messageIdToTopic[packet.messageId] = topics;\n            }\n            const promise = new Promise((resolve, reject) => {\n                this.outgoing[packet.messageId] = {\n                    volatile: true,\n                    cb(err, packet2) {\n                        if (!err) {\n                            const { granted } = packet2;\n                            for (let grantedI = 0; grantedI < granted.length; grantedI += 1) {\n                                chunkedSubs[grantedI].qos = granted[grantedI];\n                            }\n                        }\n                        if (!err) {\n                            resolve(packet2);\n                        }\n                        else {\n                            reject(new shared_1.ErrorWithSubackPacket(err.message, packet2));\n                        }\n                    },\n                };\n            });\n            this.log('subscribe :: call _sendPacket');\n            this._sendPacket(packet);\n            return promise;\n        };\n        const subscribeProc = () => {\n            const batchSize = this.options.subscribeBatchSize ?? subs.length;\n            const subscribePromises = [];\n            for (let i = 0; i < subs.length; i += batchSize) {\n                const chunkedSubs = subs.slice(i, i + batchSize);\n                const messageId = this._nextId();\n                if (messageId === null) {\n                    this.log('No messageId left');\n                    return false;\n                }\n                subscribePromises.push(subscribeChunkedSubs(chunkedSubs, messageId));\n            }\n            Promise.all(subscribePromises)\n                .then((packets) => {\n                callback(null, subs, packets.at(-1));\n            })\n                .catch((err) => {\n                callback(err, subs, err.packet);\n            });\n            return true;\n        };\n        if (this._storeProcessing ||\n            this._storeProcessingQueue.length > 0 ||\n            !subscribeProc()) {\n            this._storeProcessingQueue.push({\n                invoke: subscribeProc,\n                callback,\n            });\n        }\n        return this;\n    }\n    subscribeAsync(topicObject, opts) {\n        return new Promise((resolve, reject) => {\n            this.subscribe(topicObject, opts, (err, granted) => {\n                if (err) {\n                    reject(err);\n                }\n                else {\n                    resolve(granted);\n                }\n            });\n        });\n    }\n    unsubscribe(topic, opts, callback) {\n        if (typeof topic === 'string') {\n            topic = [topic];\n        }\n        if (typeof opts === 'function') {\n            callback = opts;\n        }\n        callback = callback || this.noop;\n        const invalidTopic = validations.validateTopics(topic);\n        if (invalidTopic !== null) {\n            setImmediate(callback, new Error(`Invalid topic ${invalidTopic}`));\n            return this;\n        }\n        if (this._checkDisconnecting(callback)) {\n            return this;\n        }\n        const unsubscribeProc = () => {\n            const messageId = this._nextId();\n            if (messageId === null) {\n                this.log('No messageId left');\n                return false;\n            }\n            const packet = {\n                cmd: 'unsubscribe',\n                messageId,\n                unsubscriptions: [],\n            };\n            if (typeof topic === 'string') {\n                packet.unsubscriptions = [topic];\n            }\n            else if (Array.isArray(topic)) {\n                packet.unsubscriptions = topic;\n            }\n            if (this.options.resubscribe) {\n                packet.unsubscriptions.forEach((topic2) => {\n                    delete this._resubscribeTopics[topic2];\n                });\n            }\n            if (typeof opts === 'object' && opts.properties) {\n                packet.properties = opts.properties;\n            }\n            this.outgoing[packet.messageId] = {\n                volatile: true,\n                cb: callback,\n            };\n            this.log('unsubscribe: call _sendPacket');\n            this._sendPacket(packet);\n            return true;\n        };\n        if (this._storeProcessing ||\n            this._storeProcessingQueue.length > 0 ||\n            !unsubscribeProc()) {\n            this._storeProcessingQueue.push({\n                invoke: unsubscribeProc,\n                callback,\n            });\n        }\n        return this;\n    }\n    unsubscribeAsync(topic, opts) {\n        return new Promise((resolve, reject) => {\n            this.unsubscribe(topic, opts, (err, packet) => {\n                if (err) {\n                    reject(err);\n                }\n                else {\n                    resolve(packet);\n                }\n            });\n        });\n    }\n    end(force, opts, cb) {\n        this.log('end :: (%s)', this.options.clientId);\n        if (force == null || typeof force !== 'boolean') {\n            cb = cb || opts;\n            opts = force;\n            force = false;\n        }\n        if (typeof opts !== 'object') {\n            cb = cb || opts;\n            opts = null;\n        }\n        this.log('end :: cb? %s', !!cb);\n        if (!cb || typeof cb !== 'function') {\n            cb = this.noop;\n        }\n        const closeStores = () => {\n            this.log('end :: closeStores: closing incoming and outgoing stores');\n            this.disconnected = true;\n            this.incomingStore.close((e1) => {\n                this.outgoingStore.close((e2) => {\n                    this.log('end :: closeStores: emitting end');\n                    this.emit('end');\n                    if (cb) {\n                        const err = e1 || e2;\n                        this.log('end :: closeStores: invoking callback with args');\n                        cb(err);\n                    }\n                });\n            });\n            if (this._deferredReconnect) {\n                this._deferredReconnect();\n            }\n            else if (this.options.reconnectPeriod === 0 ||\n                this.options.manualConnect) {\n                this.disconnecting = false;\n            }\n        };\n        const finish = () => {\n            this.log('end :: (%s) :: finish :: calling _cleanUp with force %s', this.options.clientId, force);\n            this._cleanUp(force, () => {\n                this.log('end :: finish :: calling process.nextTick on closeStores');\n                (0, shared_1.nextTick)(closeStores);\n            }, opts);\n        };\n        if (this.disconnecting) {\n            cb();\n            return this;\n        }\n        this._clearReconnect();\n        this.disconnecting = true;\n        if (!force && Object.keys(this.outgoing).length > 0) {\n            this.log('end :: (%s) :: calling finish in 10ms once outgoing is empty', this.options.clientId);\n            this.once('outgoingEmpty', setTimeout.bind(null, finish, 10));\n        }\n        else {\n            this.log('end :: (%s) :: immediately calling finish', this.options.clientId);\n            finish();\n        }\n        return this;\n    }\n    endAsync(force, opts) {\n        return new Promise((resolve, reject) => {\n            this.end(force, opts, (err) => {\n                if (err) {\n                    reject(err);\n                }\n                else {\n                    resolve();\n                }\n            });\n        });\n    }\n    removeOutgoingMessage(messageId) {\n        if (this.outgoing[messageId]) {\n            const { cb } = this.outgoing[messageId];\n            this._removeOutgoingAndStoreMessage(messageId, () => {\n                cb(new Error('Message removed'));\n            });\n        }\n        return this;\n    }\n    reconnect(opts) {\n        this.log('client reconnect');\n        const f = () => {\n            if (opts) {\n                this.options.incomingStore = opts.incomingStore;\n                this.options.outgoingStore = opts.outgoingStore;\n            }\n            else {\n                this.options.incomingStore = null;\n                this.options.outgoingStore = null;\n            }\n            this.incomingStore = this.options.incomingStore || new store_1.default();\n            this.outgoingStore = this.options.outgoingStore || new store_1.default();\n            this.disconnecting = false;\n            this.disconnected = false;\n            this._deferredReconnect = null;\n            this._reconnect();\n        };\n        if (this.disconnecting && !this.disconnected) {\n            this._deferredReconnect = f;\n        }\n        else {\n            f();\n        }\n        return this;\n    }\n    _flushVolatile() {\n        if (this.outgoing) {\n            this.log('_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function');\n            Object.keys(this.outgoing).forEach((messageId) => {\n                if (this.outgoing[messageId].volatile &&\n                    typeof this.outgoing[messageId].cb === 'function') {\n                    this.outgoing[messageId].cb(new Error('Connection closed'));\n                    delete this.outgoing[messageId];\n                }\n            });\n        }\n    }\n    _flush() {\n        if (this.outgoing) {\n            this.log('_flush: queue exists? %b', !!this.outgoing);\n            Object.keys(this.outgoing).forEach((messageId) => {\n                if (typeof this.outgoing[messageId].cb === 'function') {\n                    this.outgoing[messageId].cb(new Error('Connection closed'));\n                    delete this.outgoing[messageId];\n                }\n            });\n        }\n    }\n    _removeTopicAliasAndRecoverTopicName(packet) {\n        let alias;\n        if (packet.properties) {\n            alias = packet.properties.topicAlias;\n        }\n        let topic = packet.topic.toString();\n        this.log('_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o', alias, topic);\n        if (topic.length === 0) {\n            if (typeof alias === 'undefined') {\n                return new Error('Unregistered Topic Alias');\n            }\n            topic = this.topicAliasSend.getTopicByAlias(alias);\n            if (typeof topic === 'undefined') {\n                return new Error('Unregistered Topic Alias');\n            }\n            packet.topic = topic;\n        }\n        if (alias) {\n            delete packet.properties.topicAlias;\n        }\n    }\n    _checkDisconnecting(callback) {\n        if (this.disconnecting) {\n            if (callback && callback !== this.noop) {\n                callback(new Error('client disconnecting'));\n            }\n            else {\n                this.emit('error', new Error('client disconnecting'));\n            }\n        }\n        return this.disconnecting;\n    }\n    _reconnect() {\n        this.log('_reconnect: emitting reconnect to client');\n        this.emit('reconnect');\n        if (this.connected) {\n            this.end(() => {\n                this.connect();\n            });\n            this.log('client already connected. disconnecting first.');\n        }\n        else {\n            this.log('_reconnect: calling connect');\n            this.connect();\n        }\n    }\n    _setupReconnect() {\n        if (!this.disconnecting &&\n            !this.reconnectTimer &&\n            this.options.reconnectPeriod > 0) {\n            if (!this.reconnecting) {\n                this.log('_setupReconnect :: emit `offline` state');\n                this.emit('offline');\n                this.log('_setupReconnect :: set `reconnecting` to `true`');\n                this.reconnecting = true;\n            }\n            this.log('_setupReconnect :: setting reconnectTimer for %d ms', this.options.reconnectPeriod);\n            this.reconnectTimer = setInterval(() => {\n                this.log('reconnectTimer :: reconnect triggered!');\n                this._reconnect();\n            }, this.options.reconnectPeriod);\n        }\n        else {\n            this.log('_setupReconnect :: doing nothing...');\n        }\n    }\n    _clearReconnect() {\n        this.log('_clearReconnect : clearing reconnect timer');\n        if (this.reconnectTimer) {\n            clearInterval(this.reconnectTimer);\n            this.reconnectTimer = null;\n        }\n    }\n    _cleanUp(forced, done, opts = {}) {\n        if (done) {\n            this.log('_cleanUp :: done callback provided for on stream close');\n            this.stream.on('close', done);\n        }\n        this.log('_cleanUp :: forced? %s', forced);\n        if (forced) {\n            if (this.options.reconnectPeriod === 0 && this.options.clean) {\n                this._flush();\n            }\n            this.log('_cleanUp :: (%s) :: destroying stream', this.options.clientId);\n            this.stream.destroy();\n        }\n        else {\n            const packet = { cmd: 'disconnect', ...opts };\n            this.log('_cleanUp :: (%s) :: call _sendPacket with disconnect packet', this.options.clientId);\n            this._sendPacket(packet, () => {\n                this.log('_cleanUp :: (%s) :: destroying stream', this.options.clientId);\n                setImmediate(() => {\n                    this.stream.end(() => {\n                        this.log('_cleanUp :: (%s) :: stream destroyed', this.options.clientId);\n                    });\n                });\n            });\n        }\n        if (!this.disconnecting && !this.reconnecting) {\n            this.log('_cleanUp :: client not disconnecting/reconnecting. Clearing and resetting reconnect.');\n            this._clearReconnect();\n            this._setupReconnect();\n        }\n        this._destroyKeepaliveManager();\n        if (done && !this.connected) {\n            this.log('_cleanUp :: (%s) :: removing stream `done` callback `close` listener', this.options.clientId);\n            this.stream.removeListener('close', done);\n            done();\n        }\n    }\n    _storeAndSend(packet, cb, cbStorePut) {\n        this.log('storeAndSend :: store packet with cmd %s to outgoingStore', packet.cmd);\n        let storePacket = packet;\n        let err;\n        if (storePacket.cmd === 'publish') {\n            storePacket = (0, default_1.default)(packet);\n            err = this._removeTopicAliasAndRecoverTopicName(storePacket);\n            if (err) {\n                return cb && cb(err);\n            }\n        }\n        this.outgoingStore.put(storePacket, (err2) => {\n            if (err2) {\n                return cb && cb(err2);\n            }\n            cbStorePut();\n            this._writePacket(packet, cb);\n        });\n    }\n    _applyTopicAlias(packet) {\n        if (this.options.protocolVersion === 5) {\n            if (packet.cmd === 'publish') {\n                let alias;\n                if (packet.properties) {\n                    alias = packet.properties.topicAlias;\n                }\n                const topic = packet.topic.toString();\n                if (this.topicAliasSend) {\n                    if (alias) {\n                        if (topic.length !== 0) {\n                            this.log('applyTopicAlias :: register topic: %s - alias: %d', topic, alias);\n                            if (!this.topicAliasSend.put(topic, alias)) {\n                                this.log('applyTopicAlias :: error out of range. topic: %s - alias: %d', topic, alias);\n                                return new Error('Sending Topic Alias out of range');\n                            }\n                        }\n                    }\n                    else if (topic.length !== 0) {\n                        if (this.options.autoAssignTopicAlias) {\n                            alias = this.topicAliasSend.getAliasByTopic(topic);\n                            if (alias) {\n                                packet.topic = '';\n                                packet.properties = {\n                                    ...packet.properties,\n                                    topicAlias: alias,\n                                };\n                                this.log('applyTopicAlias :: auto assign(use) topic: %s - alias: %d', topic, alias);\n                            }\n                            else {\n                                alias = this.topicAliasSend.getLruAlias();\n                                this.topicAliasSend.put(topic, alias);\n                                packet.properties = {\n                                    ...packet.properties,\n                                    topicAlias: alias,\n                                };\n                                this.log('applyTopicAlias :: auto assign topic: %s - alias: %d', topic, alias);\n                            }\n                        }\n                        else if (this.options.autoUseTopicAlias) {\n                            alias = this.topicAliasSend.getAliasByTopic(topic);\n                            if (alias) {\n                                packet.topic = '';\n                                packet.properties = {\n                                    ...packet.properties,\n                                    topicAlias: alias,\n                                };\n                                this.log('applyTopicAlias :: auto use topic: %s - alias: %d', topic, alias);\n                            }\n                        }\n                    }\n                }\n                else if (alias) {\n                    this.log('applyTopicAlias :: error out of range. topic: %s - alias: %d', topic, alias);\n                    return new Error('Sending Topic Alias out of range');\n                }\n            }\n        }\n    }\n    _noop(err) {\n        this.log('noop ::', err);\n    }\n    _writePacket(packet, cb) {\n        this.log('_writePacket :: packet: %O', packet);\n        this.log('_writePacket :: emitting `packetsend`');\n        this.emit('packetsend', packet);\n        this.log('_writePacket :: writing to stream');\n        const result = mqtt_packet_1.default.writeToStream(packet, this.stream, this.options);\n        this.log('_writePacket :: writeToStream result %s', result);\n        if (!result && cb && cb !== this.noop) {\n            this.log('_writePacket :: handle events on `drain` once through callback.');\n            this.stream.once('drain', cb);\n        }\n        else if (cb) {\n            this.log('_writePacket :: invoking cb');\n            cb();\n        }\n    }\n    _sendPacket(packet, cb, cbStorePut, noStore) {\n        this.log('_sendPacket :: (%s) ::  start', this.options.clientId);\n        cbStorePut = cbStorePut || this.noop;\n        cb = cb || this.noop;\n        const err = this._applyTopicAlias(packet);\n        if (err) {\n            cb(err);\n            return;\n        }\n        if (!this.connected) {\n            if (packet.cmd === 'auth') {\n                this._writePacket(packet, cb);\n                return;\n            }\n            this.log('_sendPacket :: client not connected. Storing packet offline.');\n            this._storePacket(packet, cb, cbStorePut);\n            return;\n        }\n        if (noStore) {\n            this._writePacket(packet, cb);\n            return;\n        }\n        switch (packet.cmd) {\n            case 'publish':\n                break;\n            case 'pubrel':\n                this._storeAndSend(packet, cb, cbStorePut);\n                return;\n            default:\n                this._writePacket(packet, cb);\n                return;\n        }\n        switch (packet.qos) {\n            case 2:\n            case 1:\n                this._storeAndSend(packet, cb, cbStorePut);\n                break;\n            case 0:\n            default:\n                this._writePacket(packet, cb);\n                break;\n        }\n        this.log('_sendPacket :: (%s) ::  end', this.options.clientId);\n    }\n    _storePacket(packet, cb, cbStorePut) {\n        this.log('_storePacket :: packet: %o', packet);\n        this.log('_storePacket :: cb? %s', !!cb);\n        cbStorePut = cbStorePut || this.noop;\n        let storePacket = packet;\n        if (storePacket.cmd === 'publish') {\n            storePacket = (0, default_1.default)(packet);\n            const err = this._removeTopicAliasAndRecoverTopicName(storePacket);\n            if (err) {\n                return cb && cb(err);\n            }\n        }\n        const qos = storePacket.qos || 0;\n        if ((qos === 0 && this.queueQoSZero) || storePacket.cmd !== 'publish') {\n            this.queue.push({ packet: storePacket, cb });\n        }\n        else if (qos > 0) {\n            cb = this.outgoing[storePacket.messageId]\n                ? this.outgoing[storePacket.messageId].cb\n                : null;\n            this.outgoingStore.put(storePacket, (err) => {\n                if (err) {\n                    return cb && cb(err);\n                }\n                cbStorePut();\n            });\n        }\n        else if (cb) {\n            cb(new Error('No connection to broker'));\n        }\n    }\n    _setupKeepaliveManager() {\n        this.log('_setupKeepaliveManager :: keepalive %d (seconds)', this.options.keepalive);\n        if (!this.keepaliveManager && this.options.keepalive) {\n            this.keepaliveManager = new KeepaliveManager_1.default(this, this.options.timerVariant);\n        }\n    }\n    _destroyKeepaliveManager() {\n        if (this.keepaliveManager) {\n            this.log('_destroyKeepaliveManager :: destroying keepalive manager');\n            this.keepaliveManager.destroy();\n            this.keepaliveManager = null;\n        }\n    }\n    reschedulePing(force = false) {\n        if (this.keepaliveManager &&\n            this.options.keepalive &&\n            (force || this.options.reschedulePings)) {\n            this._reschedulePing();\n        }\n    }\n    _reschedulePing() {\n        this.log('_reschedulePing :: rescheduling ping');\n        this.keepaliveManager.reschedule();\n    }\n    sendPing() {\n        this.log('_sendPing :: sending pingreq');\n        this._sendPacket({ cmd: 'pingreq' });\n    }\n    onKeepaliveTimeout() {\n        this.emit('error', new Error('Keepalive timeout'));\n        this.log('onKeepaliveTimeout :: calling _cleanUp with force true');\n        this._cleanUp(true);\n    }\n    _resubscribe() {\n        this.log('_resubscribe');\n        const _resubscribeTopicsKeys = Object.keys(this._resubscribeTopics);\n        if (!this._firstConnection &&\n            (this.options.clean ||\n                (this.options.protocolVersion >= 4 &&\n                    !this.connackPacket.sessionPresent)) &&\n            _resubscribeTopicsKeys.length > 0) {\n            if (this.options.resubscribe) {\n                if (this.options.protocolVersion === 5) {\n                    this.log('_resubscribe: protocolVersion 5');\n                    for (let topicI = 0; topicI < _resubscribeTopicsKeys.length; topicI++) {\n                        const resubscribeTopic = {};\n                        resubscribeTopic[_resubscribeTopicsKeys[topicI]] =\n                            this._resubscribeTopics[_resubscribeTopicsKeys[topicI]];\n                        resubscribeTopic.resubscribe = true;\n                        this.subscribe(resubscribeTopic, {\n                            properties: resubscribeTopic[_resubscribeTopicsKeys[topicI]]\n                                .properties,\n                        });\n                    }\n                }\n                else {\n                    this._resubscribeTopics.resubscribe = true;\n                    this.subscribe(this._resubscribeTopics);\n                }\n            }\n            else {\n                this._resubscribeTopics = {};\n            }\n        }\n        this._firstConnection = false;\n    }\n    _onConnect(packet) {\n        if (this.disconnected) {\n            this.emit('connect', packet);\n            return;\n        }\n        this.connackPacket = packet;\n        this.messageIdProvider.clear();\n        this._setupKeepaliveManager();\n        this.connected = true;\n        const startStreamProcess = () => {\n            let outStore = this.outgoingStore.createStream();\n            const remove = () => {\n                outStore.destroy();\n                outStore = null;\n                this._flushStoreProcessingQueue();\n                clearStoreProcessing();\n            };\n            const clearStoreProcessing = () => {\n                this._storeProcessing = false;\n                this._packetIdsDuringStoreProcessing = {};\n            };\n            this.once('close', remove);\n            outStore.on('error', (err) => {\n                clearStoreProcessing();\n                this._flushStoreProcessingQueue();\n                this.removeListener('close', remove);\n                this.emit('error', err);\n            });\n            const storeDeliver = () => {\n                if (!outStore) {\n                    return;\n                }\n                const packet2 = outStore.read(1);\n                let cb;\n                if (!packet2) {\n                    outStore.once('readable', storeDeliver);\n                    return;\n                }\n                this._storeProcessing = true;\n                if (this._packetIdsDuringStoreProcessing[packet2.messageId]) {\n                    storeDeliver();\n                    return;\n                }\n                if (!this.disconnecting && !this.reconnectTimer) {\n                    cb = this.outgoing[packet2.messageId]\n                        ? this.outgoing[packet2.messageId].cb\n                        : null;\n                    this.outgoing[packet2.messageId] = {\n                        volatile: false,\n                        cb(err, status) {\n                            if (cb) {\n                                cb(err, status);\n                            }\n                            storeDeliver();\n                        },\n                    };\n                    this._packetIdsDuringStoreProcessing[packet2.messageId] =\n                        true;\n                    if (this.messageIdProvider.register(packet2.messageId)) {\n                        this._sendPacket(packet2, undefined, undefined, true);\n                    }\n                    else {\n                        this.log('messageId: %d has already used.', packet2.messageId);\n                    }\n                }\n                else if (outStore.destroy) {\n                    outStore.destroy();\n                }\n            };\n            outStore.on('end', () => {\n                let allProcessed = true;\n                for (const id in this._packetIdsDuringStoreProcessing) {\n                    if (!this._packetIdsDuringStoreProcessing[id]) {\n                        allProcessed = false;\n                        break;\n                    }\n                }\n                this.removeListener('close', remove);\n                if (allProcessed) {\n                    clearStoreProcessing();\n                    this._invokeAllStoreProcessingQueue();\n                    this.emit('connect', packet);\n                }\n                else {\n                    startStreamProcess();\n                }\n            });\n            storeDeliver();\n        };\n        startStreamProcess();\n    }\n    _invokeStoreProcessingQueue() {\n        if (!this._storeProcessing && this._storeProcessingQueue.length > 0) {\n            const f = this._storeProcessingQueue[0];\n            if (f && f.invoke()) {\n                this._storeProcessingQueue.shift();\n                return true;\n            }\n        }\n        return false;\n    }\n    _invokeAllStoreProcessingQueue() {\n        while (this._invokeStoreProcessingQueue()) {\n        }\n    }\n    _flushStoreProcessingQueue() {\n        for (const f of this._storeProcessingQueue) {\n            if (f.cbStorePut)\n                f.cbStorePut(new Error('Connection closed'));\n            if (f.callback)\n                f.callback(new Error('Connection closed'));\n        }\n        this._storeProcessingQueue.splice(0);\n    }\n    _removeOutgoingAndStoreMessage(messageId, cb) {\n        delete this.outgoing[messageId];\n        this.outgoingStore.del({ messageId }, (err, packet) => {\n            cb(err, packet);\n            this.messageIdProvider.deallocate(messageId);\n            this._invokeStoreProcessingQueue();\n        });\n    }\n}\nexports[\"default\"] = MqttClient;\n//# sourceMappingURL=client.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY2xpZW50LmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG9DQUFvQztBQUNuRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwwQ0FBMEMsNEJBQTRCO0FBQ3RFLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsY0FBYztBQUN6RTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsc0NBQXNDLG1CQUFPLENBQUMsNkRBQWE7QUFDM0QsMEJBQTBCLG1CQUFPLENBQUMsK0VBQWlCO0FBQ25ELGtDQUFrQyxtQkFBTyxDQUFDLDBEQUFjO0FBQ3hELGdDQUFnQyxtQkFBTyxDQUFDLHNEQUFPO0FBQy9DLGlDQUFpQyxtQkFBTyxDQUFDLHlFQUFlO0FBQ3hELGdDQUFnQyxtQkFBTyxDQUFDLDZEQUFTO0FBQ2pELG1DQUFtQyxtQkFBTyxDQUFDLHlFQUFZO0FBQ3ZELHNEQUFzRCxtQkFBTyxDQUFDLHlHQUErQjtBQUM3RiwyQ0FBMkMsbUJBQU8sQ0FBQyxtRkFBb0I7QUFDdkUsaUJBQWlCLG1CQUFPLENBQUMsK0RBQVU7QUFDbkMsdUJBQXVCLG1CQUFPLENBQUMsMkVBQWdCO0FBQy9DLDJDQUEyQyxtQkFBTyxDQUFDLG1GQUFvQjtBQUN2RSxrQ0FBa0MsbUJBQU8sQ0FBQyx1RUFBYztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsd0NBQXdDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixVQUFVO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGdCQUFnQiwyQ0FBMkM7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThELGFBQWE7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixnQkFBZ0IsYUFBYTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsVUFBVTtBQUM5QyxtREFBbUQsMkJBQTJCO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixpQkFBaUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThELGFBQWE7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixLQUFLO0FBQ3pCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHlCQUF5QjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixnQkFBZ0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyx3Q0FBd0M7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLFdBQVc7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxrQkFBZTtBQUNmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29sZC1zdG9yYWdlLXN5c3RlbS8uL25vZGVfbW9kdWxlcy9tcXR0L2J1aWxkL2xpYi9jbGllbnQuanM/ZmU5NyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3duS2V5cyA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgICAgb3duS2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICB2YXIgYXIgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gbykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBrKSkgYXJbYXIubGVuZ3RoXSA9IGs7XG4gICAgICAgICAgICByZXR1cm4gYXI7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvd25LZXlzKG8pO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgPSBvd25LZXlzKG1vZCksIGkgPSAwOyBpIDwgay5sZW5ndGg7IGkrKykgaWYgKGtbaV0gIT09IFwiZGVmYXVsdFwiKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGtbaV0pO1xuICAgICAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG59KSgpO1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgbXF0dF9wYWNrZXRfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwibXF0dC1wYWNrZXRcIikpO1xuY29uc3QgcmVhZGFibGVfc3RyZWFtXzEgPSByZXF1aXJlKFwicmVhZGFibGUtc3RyZWFtXCIpO1xuY29uc3QgZGVmYXVsdF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJyZmRjL2RlZmF1bHRcIikpO1xuY29uc3QgZGVidWdfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiZGVidWdcIikpO1xuY29uc3QgdmFsaWRhdGlvbnMgPSBfX2ltcG9ydFN0YXIocmVxdWlyZShcIi4vdmFsaWRhdGlvbnNcIikpO1xuY29uc3Qgc3RvcmVfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9zdG9yZVwiKSk7XG5jb25zdCBoYW5kbGVyc18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL2hhbmRsZXJzXCIpKTtcbmNvbnN0IGRlZmF1bHRfbWVzc2FnZV9pZF9wcm92aWRlcl8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL2RlZmF1bHQtbWVzc2FnZS1pZC1wcm92aWRlclwiKSk7XG5jb25zdCB0b3BpY19hbGlhc19yZWN2XzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vdG9waWMtYWxpYXMtcmVjdlwiKSk7XG5jb25zdCBzaGFyZWRfMSA9IHJlcXVpcmUoXCIuL3NoYXJlZFwiKTtcbmNvbnN0IFR5cGVkRW1pdHRlcl8xID0gcmVxdWlyZShcIi4vVHlwZWRFbWl0dGVyXCIpO1xuY29uc3QgS2VlcGFsaXZlTWFuYWdlcl8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL0tlZXBhbGl2ZU1hbmFnZXJcIikpO1xuY29uc3QgaXNfYnJvd3Nlcl8xID0gX19pbXBvcnRTdGFyKHJlcXVpcmUoXCIuL2lzLWJyb3dzZXJcIikpO1xuY29uc3Qgc2V0SW1tZWRpYXRlID0gZ2xvYmFsVGhpcy5zZXRJbW1lZGlhdGUgfHxcbiAgICAoKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBhcmdzLnNoaWZ0KCk7XG4gICAgICAgICgwLCBzaGFyZWRfMS5uZXh0VGljaykoKCkgPT4ge1xuICAgICAgICAgICAgY2FsbGJhY2soLi4uYXJncyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuY29uc3QgZGVmYXVsdENvbm5lY3RPcHRpb25zID0ge1xuICAgIGtlZXBhbGl2ZTogNjAsXG4gICAgcmVzY2hlZHVsZVBpbmdzOiB0cnVlLFxuICAgIHByb3RvY29sSWQ6ICdNUVRUJyxcbiAgICBwcm90b2NvbFZlcnNpb246IDQsXG4gICAgcmVjb25uZWN0UGVyaW9kOiAxMDAwLFxuICAgIGNvbm5lY3RUaW1lb3V0OiAzMCAqIDEwMDAsXG4gICAgY2xlYW46IHRydWUsXG4gICAgcmVzdWJzY3JpYmU6IHRydWUsXG4gICAgc3Vic2NyaWJlQmF0Y2hTaXplOiBudWxsLFxuICAgIHdyaXRlQ2FjaGU6IHRydWUsXG4gICAgdGltZXJWYXJpYW50OiAnYXV0bycsXG59O1xuY2xhc3MgTXF0dENsaWVudCBleHRlbmRzIFR5cGVkRW1pdHRlcl8xLlR5cGVkRXZlbnRFbWl0dGVyIHtcbiAgICBzdGF0aWMgVkVSU0lPTiA9IHNoYXJlZF8xLk1RVFRKU19WRVJTSU9OO1xuICAgIGNvbm5lY3RlZDtcbiAgICBkaXNjb25uZWN0aW5nO1xuICAgIGRpc2Nvbm5lY3RlZDtcbiAgICByZWNvbm5lY3Rpbmc7XG4gICAgaW5jb21pbmdTdG9yZTtcbiAgICBvdXRnb2luZ1N0b3JlO1xuICAgIG9wdGlvbnM7XG4gICAgcXVldWVRb1NaZXJvO1xuICAgIF9yZWNvbm5lY3RDb3VudDtcbiAgICBsb2c7XG4gICAgbWVzc2FnZUlkUHJvdmlkZXI7XG4gICAgb3V0Z29pbmc7XG4gICAgbWVzc2FnZUlkVG9Ub3BpYztcbiAgICBub29wO1xuICAgIGtlZXBhbGl2ZU1hbmFnZXI7XG4gICAgc3RyZWFtO1xuICAgIHF1ZXVlO1xuICAgIHN0cmVhbUJ1aWxkZXI7XG4gICAgX3Jlc3Vic2NyaWJlVG9waWNzO1xuICAgIGNvbm5hY2tUaW1lcjtcbiAgICByZWNvbm5lY3RUaW1lcjtcbiAgICBfc3RvcmVQcm9jZXNzaW5nO1xuICAgIF9wYWNrZXRJZHNEdXJpbmdTdG9yZVByb2Nlc3Npbmc7XG4gICAgX3N0b3JlUHJvY2Vzc2luZ1F1ZXVlO1xuICAgIF9maXJzdENvbm5lY3Rpb247XG4gICAgdG9waWNBbGlhc1JlY3Y7XG4gICAgdG9waWNBbGlhc1NlbmQ7XG4gICAgX2RlZmVycmVkUmVjb25uZWN0O1xuICAgIGNvbm5hY2tQYWNrZXQ7XG4gICAgc3RhdGljIGRlZmF1bHRJZCgpIHtcbiAgICAgICAgcmV0dXJuIGBtcXR0anNfJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zdWJzdHIoMiwgOCl9YDtcbiAgICB9XG4gICAgY29uc3RydWN0b3Ioc3RyZWFtQnVpbGRlciwgb3B0aW9ucykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IGsgaW4gZGVmYXVsdENvbm5lY3RPcHRpb25zKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9uc1trXSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnNba10gPSBkZWZhdWx0Q29ubmVjdE9wdGlvbnNba107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnNba10gPSBvcHRpb25zW2tdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubG9nID0gdGhpcy5vcHRpb25zLmxvZyB8fCAoMCwgZGVidWdfMS5kZWZhdWx0KSgnbXF0dGpzOmNsaWVudCcpO1xuICAgICAgICB0aGlzLm5vb3AgPSB0aGlzLl9ub29wLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMubG9nKCdNcXR0Q2xpZW50IDo6IHZlcnNpb246JywgTXF0dENsaWVudC5WRVJTSU9OKTtcbiAgICAgICAgaWYgKGlzX2Jyb3dzZXJfMS5pc1dlYldvcmtlcikge1xuICAgICAgICAgICAgdGhpcy5sb2coJ01xdHRDbGllbnQgOjogZW52aXJvbm1lbnQnLCAnd2Vid29ya2VyJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmxvZygnTXF0dENsaWVudCA6OiBlbnZpcm9ubWVudCcsIGlzX2Jyb3dzZXJfMS5kZWZhdWx0ID8gJ2Jyb3dzZXInIDogJ25vZGUnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxvZygnTXF0dENsaWVudCA6OiBvcHRpb25zLnByb3RvY29sJywgb3B0aW9ucy5wcm90b2NvbCk7XG4gICAgICAgIHRoaXMubG9nKCdNcXR0Q2xpZW50IDo6IG9wdGlvbnMucHJvdG9jb2xWZXJzaW9uJywgb3B0aW9ucy5wcm90b2NvbFZlcnNpb24pO1xuICAgICAgICB0aGlzLmxvZygnTXF0dENsaWVudCA6OiBvcHRpb25zLnVzZXJuYW1lJywgb3B0aW9ucy51c2VybmFtZSk7XG4gICAgICAgIHRoaXMubG9nKCdNcXR0Q2xpZW50IDo6IG9wdGlvbnMua2VlcGFsaXZlJywgb3B0aW9ucy5rZWVwYWxpdmUpO1xuICAgICAgICB0aGlzLmxvZygnTXF0dENsaWVudCA6OiBvcHRpb25zLnJlY29ubmVjdFBlcmlvZCcsIG9wdGlvbnMucmVjb25uZWN0UGVyaW9kKTtcbiAgICAgICAgdGhpcy5sb2coJ01xdHRDbGllbnQgOjogb3B0aW9ucy5yZWplY3RVbmF1dGhvcml6ZWQnLCBvcHRpb25zLnJlamVjdFVuYXV0aG9yaXplZCk7XG4gICAgICAgIHRoaXMubG9nKCdNcXR0Q2xpZW50IDo6IG9wdGlvbnMucHJvcGVydGllcy50b3BpY0FsaWFzTWF4aW11bScsIG9wdGlvbnMucHJvcGVydGllc1xuICAgICAgICAgICAgPyBvcHRpb25zLnByb3BlcnRpZXMudG9waWNBbGlhc01heGltdW1cbiAgICAgICAgICAgIDogdW5kZWZpbmVkKTtcbiAgICAgICAgdGhpcy5vcHRpb25zLmNsaWVudElkID1cbiAgICAgICAgICAgIHR5cGVvZiBvcHRpb25zLmNsaWVudElkID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgID8gb3B0aW9ucy5jbGllbnRJZFxuICAgICAgICAgICAgICAgIDogTXF0dENsaWVudC5kZWZhdWx0SWQoKTtcbiAgICAgICAgdGhpcy5sb2coJ01xdHRDbGllbnQgOjogY2xpZW50SWQnLCB0aGlzLm9wdGlvbnMuY2xpZW50SWQpO1xuICAgICAgICB0aGlzLm9wdGlvbnMuY3VzdG9tSGFuZGxlQWNrcyA9XG4gICAgICAgICAgICBvcHRpb25zLnByb3RvY29sVmVyc2lvbiA9PT0gNSAmJiBvcHRpb25zLmN1c3RvbUhhbmRsZUFja3NcbiAgICAgICAgICAgICAgICA/IG9wdGlvbnMuY3VzdG9tSGFuZGxlQWNrc1xuICAgICAgICAgICAgICAgIDogKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXJnc1szXShudWxsLCAwKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy53cml0ZUNhY2hlKSB7XG4gICAgICAgICAgICBtcXR0X3BhY2tldF8xLmRlZmF1bHQud3JpdGVUb1N0cmVhbS5jYWNoZU51bWJlcnMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0cmVhbUJ1aWxkZXIgPSBzdHJlYW1CdWlsZGVyO1xuICAgICAgICB0aGlzLm1lc3NhZ2VJZFByb3ZpZGVyID1cbiAgICAgICAgICAgIHR5cGVvZiB0aGlzLm9wdGlvbnMubWVzc2FnZUlkUHJvdmlkZXIgPT09ICd1bmRlZmluZWQnXG4gICAgICAgICAgICAgICAgPyBuZXcgZGVmYXVsdF9tZXNzYWdlX2lkX3Byb3ZpZGVyXzEuZGVmYXVsdCgpXG4gICAgICAgICAgICAgICAgOiB0aGlzLm9wdGlvbnMubWVzc2FnZUlkUHJvdmlkZXI7XG4gICAgICAgIHRoaXMub3V0Z29pbmdTdG9yZSA9IG9wdGlvbnMub3V0Z29pbmdTdG9yZSB8fCBuZXcgc3RvcmVfMS5kZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuaW5jb21pbmdTdG9yZSA9IG9wdGlvbnMuaW5jb21pbmdTdG9yZSB8fCBuZXcgc3RvcmVfMS5kZWZhdWx0KCk7XG4gICAgICAgIHRoaXMucXVldWVRb1NaZXJvID1cbiAgICAgICAgICAgIG9wdGlvbnMucXVldWVRb1NaZXJvID09PSB1bmRlZmluZWQgPyB0cnVlIDogb3B0aW9ucy5xdWV1ZVFvU1plcm87XG4gICAgICAgIHRoaXMuX3Jlc3Vic2NyaWJlVG9waWNzID0ge307XG4gICAgICAgIHRoaXMubWVzc2FnZUlkVG9Ub3BpYyA9IHt9O1xuICAgICAgICB0aGlzLmtlZXBhbGl2ZU1hbmFnZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgICB0aGlzLmNvbm5hY2tUaW1lciA9IG51bGw7XG4gICAgICAgIHRoaXMucmVjb25uZWN0VGltZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9zdG9yZVByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcGFja2V0SWRzRHVyaW5nU3RvcmVQcm9jZXNzaW5nID0ge307XG4gICAgICAgIHRoaXMuX3N0b3JlUHJvY2Vzc2luZ1F1ZXVlID0gW107XG4gICAgICAgIHRoaXMub3V0Z29pbmcgPSB7fTtcbiAgICAgICAgdGhpcy5fZmlyc3RDb25uZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgaWYgKG9wdGlvbnMucHJvcGVydGllcyAmJiBvcHRpb25zLnByb3BlcnRpZXMudG9waWNBbGlhc01heGltdW0gPiAwKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5wcm9wZXJ0aWVzLnRvcGljQWxpYXNNYXhpbXVtID4gMHhmZmZmKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2coJ01xdHRDbGllbnQgOjogb3B0aW9ucy5wcm9wZXJ0aWVzLnRvcGljQWxpYXNNYXhpbXVtIGlzIG91dCBvZiByYW5nZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b3BpY0FsaWFzUmVjdiA9IG5ldyB0b3BpY19hbGlhc19yZWN2XzEuZGVmYXVsdChvcHRpb25zLnByb3BlcnRpZXMudG9waWNBbGlhc01heGltdW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMub24oJ2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IHF1ZXVlIH0gPSB0aGlzO1xuICAgICAgICAgICAgY29uc3QgZGVsaXZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbnRyeSA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2coJ2RlbGl2ZXIgOjogZW50cnkgJW8nLCBlbnRyeSk7XG4gICAgICAgICAgICAgICAgbGV0IHBhY2tldCA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBhY2tldCA9IGVudHJ5LnBhY2tldDtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZygnZGVsaXZlciA6OiBjYWxsIF9zZW5kUGFja2V0IGZvciAlbycsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgbGV0IHNlbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChwYWNrZXQubWVzc2FnZUlkICYmIHBhY2tldC5tZXNzYWdlSWQgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1lc3NhZ2VJZFByb3ZpZGVyLnJlZ2lzdGVyKHBhY2tldC5tZXNzYWdlSWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VuZFBhY2tldChwYWNrZXQsIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbnRyeS5jYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5LmNiKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxpdmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coJ21lc3NhZ2VJZDogJWQgaGFzIGFscmVhZHkgdXNlZC4gVGhlIG1lc3NhZ2UgaXMgc2tpcHBlZCBhbmQgcmVtb3ZlZC4nLCBwYWNrZXQubWVzc2FnZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsaXZlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmxvZygnY29ubmVjdCA6OiBzZW5kaW5nIHF1ZXVlZCBwYWNrZXRzJyk7XG4gICAgICAgICAgICBkZWxpdmVyKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9uKCdjbG9zZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubG9nKCdjbG9zZSA6OiBjb25uZWN0ZWQgc2V0IHRvIGBmYWxzZWAnKTtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmxvZygnY2xvc2UgOjogY2xlYXJpbmcgY29ubmFja1RpbWVyJyk7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5jb25uYWNrVGltZXIpO1xuICAgICAgICAgICAgdGhpcy5fZGVzdHJveUtlZXBhbGl2ZU1hbmFnZXIoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRvcGljQWxpYXNSZWN2KSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b3BpY0FsaWFzUmVjdi5jbGVhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5sb2coJ2Nsb3NlIDo6IGNhbGxpbmcgX3NldHVwUmVjb25uZWN0Jyk7XG4gICAgICAgICAgICB0aGlzLl9zZXR1cFJlY29ubmVjdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMubWFudWFsQ29ubmVjdCkge1xuICAgICAgICAgICAgdGhpcy5sb2coJ01xdHRDbGllbnQgOjogc2V0dGluZyB1cCBzdHJlYW0nKTtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZUF1dGgocGFja2V0LCBjYWxsYmFjaykge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgIH1cbiAgICBoYW5kbGVNZXNzYWdlKHBhY2tldCwgY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICB9XG4gICAgX25leHRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUlkUHJvdmlkZXIuYWxsb2NhdGUoKTtcbiAgICB9XG4gICAgZ2V0TGFzdE1lc3NhZ2VJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUlkUHJvdmlkZXIuZ2V0TGFzdEFsbG9jYXRlZCgpO1xuICAgIH1cbiAgICBjb25uZWN0KCkge1xuICAgICAgICBjb25zdCB3cml0YWJsZSA9IG5ldyByZWFkYWJsZV9zdHJlYW1fMS5Xcml0YWJsZSgpO1xuICAgICAgICBjb25zdCBwYXJzZXIgPSBtcXR0X3BhY2tldF8xLmRlZmF1bHQucGFyc2VyKHRoaXMub3B0aW9ucyk7XG4gICAgICAgIGxldCBjb21wbGV0ZVBhcnNlID0gbnVsbDtcbiAgICAgICAgY29uc3QgcGFja2V0cyA9IFtdO1xuICAgICAgICB0aGlzLmxvZygnY29ubmVjdCA6OiBjYWxsaW5nIG1ldGhvZCB0byBjbGVhciByZWNvbm5lY3QnKTtcbiAgICAgICAgdGhpcy5fY2xlYXJSZWNvbm5lY3QoKTtcbiAgICAgICAgaWYgKHRoaXMuZGlzY29ubmVjdGVkICYmICF0aGlzLnJlY29ubmVjdGluZykge1xuICAgICAgICAgICAgdGhpcy5pbmNvbWluZ1N0b3JlID0gdGhpcy5vcHRpb25zLmluY29taW5nU3RvcmUgfHwgbmV3IHN0b3JlXzEuZGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5vdXRnb2luZ1N0b3JlID0gdGhpcy5vcHRpb25zLm91dGdvaW5nU3RvcmUgfHwgbmV3IHN0b3JlXzEuZGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubG9nKCdjb25uZWN0IDo6IHVzaW5nIHN0cmVhbUJ1aWxkZXIgcHJvdmlkZWQgdG8gY2xpZW50IHRvIGNyZWF0ZSBzdHJlYW0nKTtcbiAgICAgICAgdGhpcy5zdHJlYW0gPSB0aGlzLnN0cmVhbUJ1aWxkZXIodGhpcyk7XG4gICAgICAgIHBhcnNlci5vbigncGFja2V0JywgKHBhY2tldCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5sb2coJ3BhcnNlciA6OiBvbiBwYWNrZXQgcHVzaCB0byBwYWNrZXRzIGFycmF5LicpO1xuICAgICAgICAgICAgcGFja2V0cy5wdXNoKHBhY2tldCk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB3b3JrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5sb2coJ3dvcmsgOjogZ2V0dGluZyBuZXh0IHBhY2tldCBpbiBxdWV1ZScpO1xuICAgICAgICAgICAgY29uc3QgcGFja2V0ID0gcGFja2V0cy5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKHBhY2tldCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nKCd3b3JrIDo6IHBhY2tldCBwdWxsZWQgZnJvbSBxdWV1ZScpO1xuICAgICAgICAgICAgICAgICgwLCBoYW5kbGVyc18xLmRlZmF1bHQpKHRoaXMsIHBhY2tldCwgbmV4dFRpY2tXb3JrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nKCd3b3JrIDo6IG5vIHBhY2tldHMgaW4gcXVldWUnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBkb25lID0gY29tcGxldGVQYXJzZTtcbiAgICAgICAgICAgICAgICBjb21wbGV0ZVBhcnNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZygnd29yayA6OiBkb25lIGZsYWcgaXMgJXMnLCAhIWRvbmUpO1xuICAgICAgICAgICAgICAgIGlmIChkb25lKVxuICAgICAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IG5leHRUaWNrV29yayA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChwYWNrZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICgwLCBzaGFyZWRfMS5uZXh0VGljaykod29yayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkb25lID0gY29tcGxldGVQYXJzZTtcbiAgICAgICAgICAgICAgICBjb21wbGV0ZVBhcnNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHdyaXRhYmxlLl93cml0ZSA9IChidWYsIGVuYywgZG9uZSkgPT4ge1xuICAgICAgICAgICAgY29tcGxldGVQYXJzZSA9IGRvbmU7XG4gICAgICAgICAgICB0aGlzLmxvZygnd3JpdGFibGUgc3RyZWFtIDo6IHBhcnNpbmcgYnVmZmVyJyk7XG4gICAgICAgICAgICBwYXJzZXIucGFyc2UoYnVmKTtcbiAgICAgICAgICAgIHdvcmsoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc3RyZWFtRXJyb3JIYW5kbGVyID0gKGVycm9yKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvZygnc3RyZWFtRXJyb3JIYW5kbGVyIDo6IGVycm9yJywgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICBpZiAoZXJyb3IuY29kZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nKCdzdHJlYW1FcnJvckhhbmRsZXIgOjogZW1pdHRpbmcgZXJyb3InKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub29wKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2coJ2Nvbm5lY3QgOjogcGlwZSBzdHJlYW0gdG8gd3JpdGFibGUgc3RyZWFtJyk7XG4gICAgICAgIHRoaXMuc3RyZWFtLnBpcGUod3JpdGFibGUpO1xuICAgICAgICB0aGlzLnN0cmVhbS5vbignZXJyb3InLCBzdHJlYW1FcnJvckhhbmRsZXIpO1xuICAgICAgICB0aGlzLnN0cmVhbS5vbignY2xvc2UnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvZygnKCVzKXN0cmVhbSA6OiBvbiBjbG9zZScsIHRoaXMub3B0aW9ucy5jbGllbnRJZCk7XG4gICAgICAgICAgICB0aGlzLl9mbHVzaFZvbGF0aWxlKCk7XG4gICAgICAgICAgICB0aGlzLmxvZygnc3RyZWFtOiBlbWl0IGNsb3NlIHRvIE1xdHRDbGllbnQnKTtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnY2xvc2UnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubG9nKCdjb25uZWN0OiBzZW5kaW5nIHBhY2tldCBgY29ubmVjdGAnKTtcbiAgICAgICAgY29uc3QgY29ubmVjdFBhY2tldCA9IHtcbiAgICAgICAgICAgIGNtZDogJ2Nvbm5lY3QnLFxuICAgICAgICAgICAgcHJvdG9jb2xJZDogdGhpcy5vcHRpb25zLnByb3RvY29sSWQsXG4gICAgICAgICAgICBwcm90b2NvbFZlcnNpb246IHRoaXMub3B0aW9ucy5wcm90b2NvbFZlcnNpb24sXG4gICAgICAgICAgICBjbGVhbjogdGhpcy5vcHRpb25zLmNsZWFuLFxuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMub3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICAgIGtlZXBhbGl2ZTogdGhpcy5vcHRpb25zLmtlZXBhbGl2ZSxcbiAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLm9wdGlvbnMudXNlcm5hbWUsXG4gICAgICAgICAgICBwYXNzd29yZDogdGhpcy5vcHRpb25zLnBhc3N3b3JkLFxuICAgICAgICAgICAgcHJvcGVydGllczogdGhpcy5vcHRpb25zLnByb3BlcnRpZXMsXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMud2lsbCkge1xuICAgICAgICAgICAgY29ubmVjdFBhY2tldC53aWxsID0ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMub3B0aW9ucy53aWxsLFxuICAgICAgICAgICAgICAgIHBheWxvYWQ6IHRoaXMub3B0aW9ucy53aWxsPy5wYXlsb2FkLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50b3BpY0FsaWFzUmVjdikge1xuICAgICAgICAgICAgaWYgKCFjb25uZWN0UGFja2V0LnByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgICAgICBjb25uZWN0UGFja2V0LnByb3BlcnRpZXMgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnRvcGljQWxpYXNSZWN2KSB7XG4gICAgICAgICAgICAgICAgY29ubmVjdFBhY2tldC5wcm9wZXJ0aWVzLnRvcGljQWxpYXNNYXhpbXVtID1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3BpY0FsaWFzUmVjdi5tYXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fd3JpdGVQYWNrZXQoY29ubmVjdFBhY2tldCk7XG4gICAgICAgIHBhcnNlci5vbignZXJyb3InLCB0aGlzLmVtaXQuYmluZCh0aGlzLCAnZXJyb3InKSk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucHJvcGVydGllcykge1xuICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMucHJvcGVydGllcy5hdXRoZW50aWNhdGlvbk1ldGhvZCAmJlxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wcm9wZXJ0aWVzLmF1dGhlbnRpY2F0aW9uRGF0YSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZW5kKCgpID0+IHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ1BhY2tldCBoYXMgbm8gQXV0aGVudGljYXRpb24gTWV0aG9kJykpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucHJvcGVydGllcy5hdXRoZW50aWNhdGlvbk1ldGhvZCAmJlxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5hdXRoUGFja2V0ICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIHRoaXMub3B0aW9ucy5hdXRoUGFja2V0ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhQYWNrZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNtZDogJ2F1dGgnLFxuICAgICAgICAgICAgICAgICAgICByZWFzb25Db2RlOiAwLFxuICAgICAgICAgICAgICAgICAgICAuLi50aGlzLm9wdGlvbnMuYXV0aFBhY2tldCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuX3dyaXRlUGFja2V0KGF1dGhQYWNrZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RyZWFtLnNldE1heExpc3RlbmVycygxMDAwKTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuY29ubmFja1RpbWVyKTtcbiAgICAgICAgdGhpcy5jb25uYWNrVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubG9nKCchIWNvbm5lY3RUaW1lb3V0IGhpdCEhIENhbGxpbmcgX2NsZWFuVXAgd2l0aCBmb3JjZSBgdHJ1ZWAnKTtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ2Nvbm5hY2sgdGltZW91dCcpKTtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFuVXAodHJ1ZSk7XG4gICAgICAgIH0sIHRoaXMub3B0aW9ucy5jb25uZWN0VGltZW91dCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBwdWJsaXNoKHRvcGljLCBtZXNzYWdlLCBvcHRzLCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmxvZygncHVibGlzaCA6OiBtZXNzYWdlIGAlc2AgdG8gdG9waWMgYCVzYCcsIG1lc3NhZ2UsIHRvcGljKTtcbiAgICAgICAgY29uc3QgeyBvcHRpb25zIH0gPSB0aGlzO1xuICAgICAgICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICAgICAgICAgIG9wdHMgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgICAgICBjb25zdCBkZWZhdWx0T3B0cyA9IHtcbiAgICAgICAgICAgIHFvczogMCxcbiAgICAgICAgICAgIHJldGFpbjogZmFsc2UsXG4gICAgICAgICAgICBkdXA6IGZhbHNlLFxuICAgICAgICB9O1xuICAgICAgICBvcHRzID0geyAuLi5kZWZhdWx0T3B0cywgLi4ub3B0cyB9O1xuICAgICAgICBjb25zdCB7IHFvcywgcmV0YWluLCBkdXAsIHByb3BlcnRpZXMsIGNiU3RvcmVQdXQgfSA9IG9wdHM7XG4gICAgICAgIGlmICh0aGlzLl9jaGVja0Rpc2Nvbm5lY3RpbmcoY2FsbGJhY2spKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwdWJsaXNoUHJvYyA9ICgpID0+IHtcbiAgICAgICAgICAgIGxldCBtZXNzYWdlSWQgPSAwO1xuICAgICAgICAgICAgaWYgKHFvcyA9PT0gMSB8fCBxb3MgPT09IDIpIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlSWQgPSB0aGlzLl9uZXh0SWQoKTtcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUlkID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKCdObyBtZXNzYWdlSWQgbGVmdCcpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcGFja2V0ID0ge1xuICAgICAgICAgICAgICAgIGNtZDogJ3B1Ymxpc2gnLFxuICAgICAgICAgICAgICAgIHRvcGljLFxuICAgICAgICAgICAgICAgIHBheWxvYWQ6IG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgcW9zLFxuICAgICAgICAgICAgICAgIHJldGFpbixcbiAgICAgICAgICAgICAgICBtZXNzYWdlSWQsXG4gICAgICAgICAgICAgICAgZHVwLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnByb3RvY29sVmVyc2lvbiA9PT0gNSkge1xuICAgICAgICAgICAgICAgIHBhY2tldC5wcm9wZXJ0aWVzID0gcHJvcGVydGllcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubG9nKCdwdWJsaXNoIDo6IHFvcycsIHFvcyk7XG4gICAgICAgICAgICBzd2l0Y2ggKHFvcykge1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3V0Z29pbmdbcGFja2V0Lm1lc3NhZ2VJZF0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2b2xhdGlsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYjogY2FsbGJhY2sgfHwgdGhpcy5ub29wLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZygnTXF0dENsaWVudDpwdWJsaXNoOiBwYWNrZXQgY21kOiAlcycsIHBhY2tldC5jbWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZW5kUGFja2V0KHBhY2tldCwgdW5kZWZpbmVkLCBjYlN0b3JlUHV0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coJ01xdHRDbGllbnQ6cHVibGlzaDogcGFja2V0IGNtZDogJXMnLCBwYWNrZXQuY21kKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VuZFBhY2tldChwYWNrZXQsIGNhbGxiYWNrLCBjYlN0b3JlUHV0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuX3N0b3JlUHJvY2Vzc2luZyB8fFxuICAgICAgICAgICAgdGhpcy5fc3RvcmVQcm9jZXNzaW5nUXVldWUubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgIXB1Ymxpc2hQcm9jKCkpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0b3JlUHJvY2Vzc2luZ1F1ZXVlLnB1c2goe1xuICAgICAgICAgICAgICAgIGludm9rZTogcHVibGlzaFByb2MsXG4gICAgICAgICAgICAgICAgY2JTdG9yZVB1dDogb3B0cy5jYlN0b3JlUHV0LFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHB1Ymxpc2hBc3luYyh0b3BpYywgbWVzc2FnZSwgb3B0cykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wdWJsaXNoKHRvcGljLCBtZXNzYWdlLCBvcHRzLCAoZXJyLCBwYWNrZXQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShwYWNrZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3Vic2NyaWJlKHRvcGljT2JqZWN0LCBvcHRzLCBjYWxsYmFjaykge1xuICAgICAgICBjb25zdCB2ZXJzaW9uID0gdGhpcy5vcHRpb25zLnByb3RvY29sVmVyc2lvbjtcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCB0aGlzLm5vb3A7XG4gICAgICAgIGxldCByZXN1YnNjcmliZSA9IGZhbHNlO1xuICAgICAgICBsZXQgdG9waWNzTGlzdCA9IFtdO1xuICAgICAgICBpZiAodHlwZW9mIHRvcGljT2JqZWN0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdG9waWNPYmplY3QgPSBbdG9waWNPYmplY3RdO1xuICAgICAgICAgICAgdG9waWNzTGlzdCA9IHRvcGljT2JqZWN0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodG9waWNPYmplY3QpKSB7XG4gICAgICAgICAgICB0b3BpY3NMaXN0ID0gdG9waWNPYmplY3Q7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHRvcGljT2JqZWN0ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmVzdWJzY3JpYmUgPSB0b3BpY09iamVjdC5yZXN1YnNjcmliZTtcbiAgICAgICAgICAgIGRlbGV0ZSB0b3BpY09iamVjdC5yZXN1YnNjcmliZTtcbiAgICAgICAgICAgIHRvcGljc0xpc3QgPSBPYmplY3Qua2V5cyh0b3BpY09iamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW52YWxpZFRvcGljID0gdmFsaWRhdGlvbnMudmFsaWRhdGVUb3BpY3ModG9waWNzTGlzdCk7XG4gICAgICAgIGlmIChpbnZhbGlkVG9waWMgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHNldEltbWVkaWF0ZShjYWxsYmFjaywgbmV3IEVycm9yKGBJbnZhbGlkIHRvcGljICR7aW52YWxpZFRvcGljfWApKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9jaGVja0Rpc2Nvbm5lY3RpbmcoY2FsbGJhY2spKSB7XG4gICAgICAgICAgICB0aGlzLmxvZygnc3Vic2NyaWJlOiBkaXNjY29uZWN0aW5nIHRydWUnKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlZmF1bHRPcHRzID0ge1xuICAgICAgICAgICAgcW9zOiAwLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodmVyc2lvbiA9PT0gNSkge1xuICAgICAgICAgICAgZGVmYXVsdE9wdHMubmwgPSBmYWxzZTtcbiAgICAgICAgICAgIGRlZmF1bHRPcHRzLnJhcCA9IGZhbHNlO1xuICAgICAgICAgICAgZGVmYXVsdE9wdHMucmggPSAwO1xuICAgICAgICB9XG4gICAgICAgIG9wdHMgPSB7IC4uLmRlZmF1bHRPcHRzLCAuLi5vcHRzIH07XG4gICAgICAgIGNvbnN0IHsgcHJvcGVydGllcyB9ID0gb3B0cztcbiAgICAgICAgY29uc3Qgc3VicyA9IFtdO1xuICAgICAgICBjb25zdCBwYXJzZVN1YiA9ICh0b3BpYywgc3ViT3B0aW9ucykgPT4ge1xuICAgICAgICAgICAgc3ViT3B0aW9ucyA9IChzdWJPcHRpb25zIHx8IG9wdHMpO1xuICAgICAgICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5fcmVzdWJzY3JpYmVUb3BpY3MsIHRvcGljKSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3Vic2NyaWJlVG9waWNzW3RvcGljXS5xb3MgPCBzdWJPcHRpb25zLnFvcyB8fFxuICAgICAgICAgICAgICAgIHJlc3Vic2NyaWJlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcGljLFxuICAgICAgICAgICAgICAgICAgICBxb3M6IHN1Yk9wdGlvbnMucW9zLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHZlcnNpb24gPT09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudE9wdHMubmwgPSBzdWJPcHRpb25zLm5sO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T3B0cy5yYXAgPSBzdWJPcHRpb25zLnJhcDtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudE9wdHMucmggPSBzdWJPcHRpb25zLnJoO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T3B0cy5wcm9wZXJ0aWVzID0gcHJvcGVydGllcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5sb2coJ3N1YnNjcmliZTogcHVzaGluZyB0b3BpYyBgJXNgIGFuZCBxb3MgYCVzYCB0byBzdWJzIGxpc3QnLCBjdXJyZW50T3B0cy50b3BpYywgY3VycmVudE9wdHMucW9zKTtcbiAgICAgICAgICAgICAgICBzdWJzLnB1c2goY3VycmVudE9wdHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0b3BpY09iamVjdCkpIHtcbiAgICAgICAgICAgIHRvcGljT2JqZWN0LmZvckVhY2goKHRvcGljKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2coJ3N1YnNjcmliZTogYXJyYXkgdG9waWMgJXMnLCB0b3BpYyk7XG4gICAgICAgICAgICAgICAgcGFyc2VTdWIodG9waWMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0b3BpY09iamVjdCkuZm9yRWFjaCgodG9waWMpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZygnc3Vic2NyaWJlOiBvYmplY3QgdG9waWMgJXMsICVvJywgdG9waWMsIHRvcGljT2JqZWN0W3RvcGljXSk7XG4gICAgICAgICAgICAgICAgcGFyc2VTdWIodG9waWMsIHRvcGljT2JqZWN0W3RvcGljXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN1YnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBbXSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdWJzY3JpYmVDaHVua2VkU3VicyA9IChjaHVua2VkU3VicywgbWVzc2FnZUlkKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwYWNrZXQgPSB7XG4gICAgICAgICAgICAgICAgY21kOiAnc3Vic2NyaWJlJyxcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zOiBjaHVua2VkU3VicyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlSWQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQucHJvcGVydGllcyA9IHByb3BlcnRpZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJlc3Vic2NyaWJlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2coJ3N1YnNjcmliZSA6OiByZXN1YnNjcmliZSB0cnVlJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9waWNzID0gW107XG4gICAgICAgICAgICAgICAgY2h1bmtlZFN1YnMuZm9yRWFjaCgoc3ViKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmVjb25uZWN0UGVyaW9kID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9waWMgPSB7IHFvczogc3ViLnFvcyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZlcnNpb24gPT09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3BpYy5ubCA9IHN1Yi5ubCB8fCBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3BpYy5yYXAgPSBzdWIucmFwIHx8IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcGljLnJoID0gc3ViLnJoIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9waWMucHJvcGVydGllcyA9IHN1Yi5wcm9wZXJ0aWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzdWJzY3JpYmVUb3BpY3Nbc3ViLnRvcGljXSA9IHRvcGljO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9waWNzLnB1c2goc3ViLnRvcGljKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUlkVG9Ub3BpY1twYWNrZXQubWVzc2FnZUlkXSA9IHRvcGljcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5vdXRnb2luZ1twYWNrZXQubWVzc2FnZUlkXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdm9sYXRpbGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNiKGVyciwgcGFja2V0Mikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGdyYW50ZWQgfSA9IHBhY2tldDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZ3JhbnRlZEkgPSAwOyBncmFudGVkSSA8IGdyYW50ZWQubGVuZ3RoOyBncmFudGVkSSArPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rZWRTdWJzW2dyYW50ZWRJXS5xb3MgPSBncmFudGVkW2dyYW50ZWRJXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocGFja2V0Mik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IHNoYXJlZF8xLkVycm9yV2l0aFN1YmFja1BhY2tldChlcnIubWVzc2FnZSwgcGFja2V0MikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubG9nKCdzdWJzY3JpYmUgOjogY2FsbCBfc2VuZFBhY2tldCcpO1xuICAgICAgICAgICAgdGhpcy5fc2VuZFBhY2tldChwYWNrZXQpO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHN1YnNjcmliZVByb2MgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBiYXRjaFNpemUgPSB0aGlzLm9wdGlvbnMuc3Vic2NyaWJlQmF0Y2hTaXplID8/IHN1YnMubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3Qgc3Vic2NyaWJlUHJvbWlzZXMgPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3Vicy5sZW5ndGg7IGkgKz0gYmF0Y2hTaXplKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2h1bmtlZFN1YnMgPSBzdWJzLnNsaWNlKGksIGkgKyBiYXRjaFNpemUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VJZCA9IHRoaXMuX25leHRJZCgpO1xuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlSWQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coJ05vIG1lc3NhZ2VJZCBsZWZ0Jyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlUHJvbWlzZXMucHVzaChzdWJzY3JpYmVDaHVua2VkU3VicyhjaHVua2VkU3VicywgbWVzc2FnZUlkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBQcm9taXNlLmFsbChzdWJzY3JpYmVQcm9taXNlcylcbiAgICAgICAgICAgICAgICAudGhlbigocGFja2V0cykgPT4ge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHN1YnMsIHBhY2tldHMuYXQoLTEpKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnIsIHN1YnMsIGVyci5wYWNrZXQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuX3N0b3JlUHJvY2Vzc2luZyB8fFxuICAgICAgICAgICAgdGhpcy5fc3RvcmVQcm9jZXNzaW5nUXVldWUubGVuZ3RoID4gMCB8fFxuICAgICAgICAgICAgIXN1YnNjcmliZVByb2MoKSkge1xuICAgICAgICAgICAgdGhpcy5fc3RvcmVQcm9jZXNzaW5nUXVldWUucHVzaCh7XG4gICAgICAgICAgICAgICAgaW52b2tlOiBzdWJzY3JpYmVQcm9jLFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHN1YnNjcmliZUFzeW5jKHRvcGljT2JqZWN0LCBvcHRzKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZSh0b3BpY09iamVjdCwgb3B0cywgKGVyciwgZ3JhbnRlZCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGdyYW50ZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdW5zdWJzY3JpYmUodG9waWMsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdG9waWMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0b3BpYyA9IFt0b3BpY107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCB0aGlzLm5vb3A7XG4gICAgICAgIGNvbnN0IGludmFsaWRUb3BpYyA9IHZhbGlkYXRpb25zLnZhbGlkYXRlVG9waWNzKHRvcGljKTtcbiAgICAgICAgaWYgKGludmFsaWRUb3BpYyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgc2V0SW1tZWRpYXRlKGNhbGxiYWNrLCBuZXcgRXJyb3IoYEludmFsaWQgdG9waWMgJHtpbnZhbGlkVG9waWN9YCkpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2NoZWNrRGlzY29ubmVjdGluZyhjYWxsYmFjaykpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlUHJvYyA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VJZCA9IHRoaXMuX25leHRJZCgpO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2VJZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nKCdObyBtZXNzYWdlSWQgbGVmdCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBhY2tldCA9IHtcbiAgICAgICAgICAgICAgICBjbWQ6ICd1bnN1YnNjcmliZScsXG4gICAgICAgICAgICAgICAgbWVzc2FnZUlkLFxuICAgICAgICAgICAgICAgIHVuc3Vic2NyaXB0aW9uczogW10sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0b3BpYyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQudW5zdWJzY3JpcHRpb25zID0gW3RvcGljXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodG9waWMpKSB7XG4gICAgICAgICAgICAgICAgcGFja2V0LnVuc3Vic2NyaXB0aW9ucyA9IHRvcGljO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yZXN1YnNjcmliZSkge1xuICAgICAgICAgICAgICAgIHBhY2tldC51bnN1YnNjcmlwdGlvbnMuZm9yRWFjaCgodG9waWMyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9yZXN1YnNjcmliZVRvcGljc1t0b3BpYzJdO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRzID09PSAnb2JqZWN0JyAmJiBvcHRzLnByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQucHJvcGVydGllcyA9IG9wdHMucHJvcGVydGllcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub3V0Z29pbmdbcGFja2V0Lm1lc3NhZ2VJZF0gPSB7XG4gICAgICAgICAgICAgICAgdm9sYXRpbGU6IHRydWUsXG4gICAgICAgICAgICAgICAgY2I6IGNhbGxiYWNrLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMubG9nKCd1bnN1YnNjcmliZTogY2FsbCBfc2VuZFBhY2tldCcpO1xuICAgICAgICAgICAgdGhpcy5fc2VuZFBhY2tldChwYWNrZXQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLl9zdG9yZVByb2Nlc3NpbmcgfHxcbiAgICAgICAgICAgIHRoaXMuX3N0b3JlUHJvY2Vzc2luZ1F1ZXVlLmxlbmd0aCA+IDAgfHxcbiAgICAgICAgICAgICF1bnN1YnNjcmliZVByb2MoKSkge1xuICAgICAgICAgICAgdGhpcy5fc3RvcmVQcm9jZXNzaW5nUXVldWUucHVzaCh7XG4gICAgICAgICAgICAgICAgaW52b2tlOiB1bnN1YnNjcmliZVByb2MsXG4gICAgICAgICAgICAgICAgY2FsbGJhY2ssXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdW5zdWJzY3JpYmVBc3luYyh0b3BpYywgb3B0cykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZSh0b3BpYywgb3B0cywgKGVyciwgcGFja2V0KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocGFja2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVuZChmb3JjZSwgb3B0cywgY2IpIHtcbiAgICAgICAgdGhpcy5sb2coJ2VuZCA6OiAoJXMpJywgdGhpcy5vcHRpb25zLmNsaWVudElkKTtcbiAgICAgICAgaWYgKGZvcmNlID09IG51bGwgfHwgdHlwZW9mIGZvcmNlICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIGNiID0gY2IgfHwgb3B0cztcbiAgICAgICAgICAgIG9wdHMgPSBmb3JjZTtcbiAgICAgICAgICAgIGZvcmNlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBvcHRzICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgY2IgPSBjYiB8fCBvcHRzO1xuICAgICAgICAgICAgb3B0cyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sb2coJ2VuZCA6OiBjYj8gJXMnLCAhIWNiKTtcbiAgICAgICAgaWYgKCFjYiB8fCB0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNiID0gdGhpcy5ub29wO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNsb3NlU3RvcmVzID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5sb2coJ2VuZCA6OiBjbG9zZVN0b3JlczogY2xvc2luZyBpbmNvbWluZyBhbmQgb3V0Z29pbmcgc3RvcmVzJyk7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmluY29taW5nU3RvcmUuY2xvc2UoKGUxKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5vdXRnb2luZ1N0b3JlLmNsb3NlKChlMikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZygnZW5kIDo6IGNsb3NlU3RvcmVzOiBlbWl0dGluZyBlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBlMSB8fCBlMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKCdlbmQgOjogY2xvc2VTdG9yZXM6IGludm9raW5nIGNhbGxiYWNrIHdpdGggYXJncycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAodGhpcy5fZGVmZXJyZWRSZWNvbm5lY3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZlcnJlZFJlY29ubmVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5vcHRpb25zLnJlY29ubmVjdFBlcmlvZCA9PT0gMCB8fFxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5tYW51YWxDb25uZWN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGZpbmlzaCA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubG9nKCdlbmQgOjogKCVzKSA6OiBmaW5pc2ggOjogY2FsbGluZyBfY2xlYW5VcCB3aXRoIGZvcmNlICVzJywgdGhpcy5vcHRpb25zLmNsaWVudElkLCBmb3JjZSk7XG4gICAgICAgICAgICB0aGlzLl9jbGVhblVwKGZvcmNlLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2coJ2VuZCA6OiBmaW5pc2ggOjogY2FsbGluZyBwcm9jZXNzLm5leHRUaWNrIG9uIGNsb3NlU3RvcmVzJyk7XG4gICAgICAgICAgICAgICAgKDAsIHNoYXJlZF8xLm5leHRUaWNrKShjbG9zZVN0b3Jlcyk7XG4gICAgICAgICAgICB9LCBvcHRzKTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZGlzY29ubmVjdGluZykge1xuICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NsZWFyUmVjb25uZWN0KCk7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdGluZyA9IHRydWU7XG4gICAgICAgIGlmICghZm9yY2UgJiYgT2JqZWN0LmtleXModGhpcy5vdXRnb2luZykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5sb2coJ2VuZCA6OiAoJXMpIDo6IGNhbGxpbmcgZmluaXNoIGluIDEwbXMgb25jZSBvdXRnb2luZyBpcyBlbXB0eScsIHRoaXMub3B0aW9ucy5jbGllbnRJZCk7XG4gICAgICAgICAgICB0aGlzLm9uY2UoJ291dGdvaW5nRW1wdHknLCBzZXRUaW1lb3V0LmJpbmQobnVsbCwgZmluaXNoLCAxMCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2coJ2VuZCA6OiAoJXMpIDo6IGltbWVkaWF0ZWx5IGNhbGxpbmcgZmluaXNoJywgdGhpcy5vcHRpb25zLmNsaWVudElkKTtcbiAgICAgICAgICAgIGZpbmlzaCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBlbmRBc3luYyhmb3JjZSwgb3B0cykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbmQoZm9yY2UsIG9wdHMsIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmVtb3ZlT3V0Z29pbmdNZXNzYWdlKG1lc3NhZ2VJZCkge1xuICAgICAgICBpZiAodGhpcy5vdXRnb2luZ1ttZXNzYWdlSWRdKSB7XG4gICAgICAgICAgICBjb25zdCB7IGNiIH0gPSB0aGlzLm91dGdvaW5nW21lc3NhZ2VJZF07XG4gICAgICAgICAgICB0aGlzLl9yZW1vdmVPdXRnb2luZ0FuZFN0b3JlTWVzc2FnZShtZXNzYWdlSWQsICgpID0+IHtcbiAgICAgICAgICAgICAgICBjYihuZXcgRXJyb3IoJ01lc3NhZ2UgcmVtb3ZlZCcpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICByZWNvbm5lY3Qob3B0cykge1xuICAgICAgICB0aGlzLmxvZygnY2xpZW50IHJlY29ubmVjdCcpO1xuICAgICAgICBjb25zdCBmID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKG9wdHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuaW5jb21pbmdTdG9yZSA9IG9wdHMuaW5jb21pbmdTdG9yZTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub3V0Z29pbmdTdG9yZSA9IG9wdHMub3V0Z29pbmdTdG9yZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5pbmNvbWluZ1N0b3JlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub3V0Z29pbmdTdG9yZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmluY29taW5nU3RvcmUgPSB0aGlzLm9wdGlvbnMuaW5jb21pbmdTdG9yZSB8fCBuZXcgc3RvcmVfMS5kZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLm91dGdvaW5nU3RvcmUgPSB0aGlzLm9wdGlvbnMub3V0Z29pbmdTdG9yZSB8fCBuZXcgc3RvcmVfMS5kZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9kZWZlcnJlZFJlY29ubmVjdCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9yZWNvbm5lY3QoKTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZGlzY29ubmVjdGluZyAmJiAhdGhpcy5kaXNjb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2RlZmVycmVkUmVjb25uZWN0ID0gZjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGYoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgX2ZsdXNoVm9sYXRpbGUoKSB7XG4gICAgICAgIGlmICh0aGlzLm91dGdvaW5nKSB7XG4gICAgICAgICAgICB0aGlzLmxvZygnX2ZsdXNoVm9sYXRpbGUgOjogZGVsZXRpbmcgdm9sYXRpbGUgbWVzc2FnZXMgZnJvbSB0aGUgcXVldWUgYW5kIHNldHRpbmcgdGhlaXIgY2FsbGJhY2tzIGFzIGVycm9yIGZ1bmN0aW9uJyk7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLm91dGdvaW5nKS5mb3JFYWNoKChtZXNzYWdlSWQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vdXRnb2luZ1ttZXNzYWdlSWRdLnZvbGF0aWxlICYmXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiB0aGlzLm91dGdvaW5nW21lc3NhZ2VJZF0uY2IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRnb2luZ1ttZXNzYWdlSWRdLmNiKG5ldyBFcnJvcignQ29ubmVjdGlvbiBjbG9zZWQnKSk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLm91dGdvaW5nW21lc3NhZ2VJZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2ZsdXNoKCkge1xuICAgICAgICBpZiAodGhpcy5vdXRnb2luZykge1xuICAgICAgICAgICAgdGhpcy5sb2coJ19mbHVzaDogcXVldWUgZXhpc3RzPyAlYicsICEhdGhpcy5vdXRnb2luZyk7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLm91dGdvaW5nKS5mb3JFYWNoKChtZXNzYWdlSWQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMub3V0Z29pbmdbbWVzc2FnZUlkXS5jYiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm91dGdvaW5nW21lc3NhZ2VJZF0uY2IobmV3IEVycm9yKCdDb25uZWN0aW9uIGNsb3NlZCcpKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMub3V0Z29pbmdbbWVzc2FnZUlkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfcmVtb3ZlVG9waWNBbGlhc0FuZFJlY292ZXJUb3BpY05hbWUocGFja2V0KSB7XG4gICAgICAgIGxldCBhbGlhcztcbiAgICAgICAgaWYgKHBhY2tldC5wcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBhbGlhcyA9IHBhY2tldC5wcm9wZXJ0aWVzLnRvcGljQWxpYXM7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHRvcGljID0gcGFja2V0LnRvcGljLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMubG9nKCdfcmVtb3ZlVG9waWNBbGlhc0FuZFJlY292ZXJUb3BpY05hbWUgOjogYWxpYXMgJWQsIHRvcGljICVvJywgYWxpYXMsIHRvcGljKTtcbiAgICAgICAgaWYgKHRvcGljLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBhbGlhcyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdVbnJlZ2lzdGVyZWQgVG9waWMgQWxpYXMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRvcGljID0gdGhpcy50b3BpY0FsaWFzU2VuZC5nZXRUb3BpY0J5QWxpYXMoYWxpYXMpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0b3BpYyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdVbnJlZ2lzdGVyZWQgVG9waWMgQWxpYXMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhY2tldC50b3BpYyA9IHRvcGljO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbGlhcykge1xuICAgICAgICAgICAgZGVsZXRlIHBhY2tldC5wcm9wZXJ0aWVzLnRvcGljQWxpYXM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2NoZWNrRGlzY29ubmVjdGluZyhjYWxsYmFjaykge1xuICAgICAgICBpZiAodGhpcy5kaXNjb25uZWN0aW5nKSB7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2sgJiYgY2FsbGJhY2sgIT09IHRoaXMubm9vcCkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcignY2xpZW50IGRpc2Nvbm5lY3RpbmcnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdjbGllbnQgZGlzY29ubmVjdGluZycpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5kaXNjb25uZWN0aW5nO1xuICAgIH1cbiAgICBfcmVjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmxvZygnX3JlY29ubmVjdDogZW1pdHRpbmcgcmVjb25uZWN0IHRvIGNsaWVudCcpO1xuICAgICAgICB0aGlzLmVtaXQoJ3JlY29ubmVjdCcpO1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZW5kKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbm5lY3QoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5sb2coJ2NsaWVudCBhbHJlYWR5IGNvbm5lY3RlZC4gZGlzY29ubmVjdGluZyBmaXJzdC4nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9nKCdfcmVjb25uZWN0OiBjYWxsaW5nIGNvbm5lY3QnKTtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9zZXR1cFJlY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2Nvbm5lY3RpbmcgJiZcbiAgICAgICAgICAgICF0aGlzLnJlY29ubmVjdFRpbWVyICYmXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucmVjb25uZWN0UGVyaW9kID4gMCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnJlY29ubmVjdGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nKCdfc2V0dXBSZWNvbm5lY3QgOjogZW1pdCBgb2ZmbGluZWAgc3RhdGUnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ29mZmxpbmUnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZygnX3NldHVwUmVjb25uZWN0IDo6IHNldCBgcmVjb25uZWN0aW5nYCB0byBgdHJ1ZWAnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlY29ubmVjdGluZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxvZygnX3NldHVwUmVjb25uZWN0IDo6IHNldHRpbmcgcmVjb25uZWN0VGltZXIgZm9yICVkIG1zJywgdGhpcy5vcHRpb25zLnJlY29ubmVjdFBlcmlvZCk7XG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nKCdyZWNvbm5lY3RUaW1lciA6OiByZWNvbm5lY3QgdHJpZ2dlcmVkIScpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlY29ubmVjdCgpO1xuICAgICAgICAgICAgfSwgdGhpcy5vcHRpb25zLnJlY29ubmVjdFBlcmlvZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmxvZygnX3NldHVwUmVjb25uZWN0IDo6IGRvaW5nIG5vdGhpbmcuLi4nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY2xlYXJSZWNvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMubG9nKCdfY2xlYXJSZWNvbm5lY3QgOiBjbGVhcmluZyByZWNvbm5lY3QgdGltZXInKTtcbiAgICAgICAgaWYgKHRoaXMucmVjb25uZWN0VGltZXIpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5yZWNvbm5lY3RUaW1lcik7XG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY2xlYW5VcChmb3JjZWQsIGRvbmUsIG9wdHMgPSB7fSkge1xuICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgdGhpcy5sb2coJ19jbGVhblVwIDo6IGRvbmUgY2FsbGJhY2sgcHJvdmlkZWQgZm9yIG9uIHN0cmVhbSBjbG9zZScpO1xuICAgICAgICAgICAgdGhpcy5zdHJlYW0ub24oJ2Nsb3NlJywgZG9uZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sb2coJ19jbGVhblVwIDo6IGZvcmNlZD8gJXMnLCBmb3JjZWQpO1xuICAgICAgICBpZiAoZm9yY2VkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJlY29ubmVjdFBlcmlvZCA9PT0gMCAmJiB0aGlzLm9wdGlvbnMuY2xlYW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9mbHVzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5sb2coJ19jbGVhblVwIDo6ICglcykgOjogZGVzdHJveWluZyBzdHJlYW0nLCB0aGlzLm9wdGlvbnMuY2xpZW50SWQpO1xuICAgICAgICAgICAgdGhpcy5zdHJlYW0uZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcGFja2V0ID0geyBjbWQ6ICdkaXNjb25uZWN0JywgLi4ub3B0cyB9O1xuICAgICAgICAgICAgdGhpcy5sb2coJ19jbGVhblVwIDo6ICglcykgOjogY2FsbCBfc2VuZFBhY2tldCB3aXRoIGRpc2Nvbm5lY3QgcGFja2V0JywgdGhpcy5vcHRpb25zLmNsaWVudElkKTtcbiAgICAgICAgICAgIHRoaXMuX3NlbmRQYWNrZXQocGFja2V0LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2coJ19jbGVhblVwIDo6ICglcykgOjogZGVzdHJveWluZyBzdHJlYW0nLCB0aGlzLm9wdGlvbnMuY2xpZW50SWQpO1xuICAgICAgICAgICAgICAgIHNldEltbWVkaWF0ZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RyZWFtLmVuZCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZygnX2NsZWFuVXAgOjogKCVzKSA6OiBzdHJlYW0gZGVzdHJveWVkJywgdGhpcy5vcHRpb25zLmNsaWVudElkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuZGlzY29ubmVjdGluZyAmJiAhdGhpcy5yZWNvbm5lY3RpbmcpIHtcbiAgICAgICAgICAgIHRoaXMubG9nKCdfY2xlYW5VcCA6OiBjbGllbnQgbm90IGRpc2Nvbm5lY3RpbmcvcmVjb25uZWN0aW5nLiBDbGVhcmluZyBhbmQgcmVzZXR0aW5nIHJlY29ubmVjdC4nKTtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyUmVjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLl9zZXR1cFJlY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2Rlc3Ryb3lLZWVwYWxpdmVNYW5hZ2VyKCk7XG4gICAgICAgIGlmIChkb25lICYmICF0aGlzLmNvbm5lY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5sb2coJ19jbGVhblVwIDo6ICglcykgOjogcmVtb3Zpbmcgc3RyZWFtIGBkb25lYCBjYWxsYmFjayBgY2xvc2VgIGxpc3RlbmVyJywgdGhpcy5vcHRpb25zLmNsaWVudElkKTtcbiAgICAgICAgICAgIHRoaXMuc3RyZWFtLnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIGRvbmUpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9zdG9yZUFuZFNlbmQocGFja2V0LCBjYiwgY2JTdG9yZVB1dCkge1xuICAgICAgICB0aGlzLmxvZygnc3RvcmVBbmRTZW5kIDo6IHN0b3JlIHBhY2tldCB3aXRoIGNtZCAlcyB0byBvdXRnb2luZ1N0b3JlJywgcGFja2V0LmNtZCk7XG4gICAgICAgIGxldCBzdG9yZVBhY2tldCA9IHBhY2tldDtcbiAgICAgICAgbGV0IGVycjtcbiAgICAgICAgaWYgKHN0b3JlUGFja2V0LmNtZCA9PT0gJ3B1Ymxpc2gnKSB7XG4gICAgICAgICAgICBzdG9yZVBhY2tldCA9ICgwLCBkZWZhdWx0XzEuZGVmYXVsdCkocGFja2V0KTtcbiAgICAgICAgICAgIGVyciA9IHRoaXMuX3JlbW92ZVRvcGljQWxpYXNBbmRSZWNvdmVyVG9waWNOYW1lKHN0b3JlUGFja2V0KTtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2IgJiYgY2IoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm91dGdvaW5nU3RvcmUucHV0KHN0b3JlUGFja2V0LCAoZXJyMikgPT4ge1xuICAgICAgICAgICAgaWYgKGVycjIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2IgJiYgY2IoZXJyMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYlN0b3JlUHV0KCk7XG4gICAgICAgICAgICB0aGlzLl93cml0ZVBhY2tldChwYWNrZXQsIGNiKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF9hcHBseVRvcGljQWxpYXMocGFja2V0KSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucHJvdG9jb2xWZXJzaW9uID09PSA1KSB7XG4gICAgICAgICAgICBpZiAocGFja2V0LmNtZCA9PT0gJ3B1Ymxpc2gnKSB7XG4gICAgICAgICAgICAgICAgbGV0IGFsaWFzO1xuICAgICAgICAgICAgICAgIGlmIChwYWNrZXQucHJvcGVydGllcykge1xuICAgICAgICAgICAgICAgICAgICBhbGlhcyA9IHBhY2tldC5wcm9wZXJ0aWVzLnRvcGljQWxpYXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHRvcGljID0gcGFja2V0LnRvcGljLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG9waWNBbGlhc1NlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9waWMubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coJ2FwcGx5VG9waWNBbGlhcyA6OiByZWdpc3RlciB0b3BpYzogJXMgLSBhbGlhczogJWQnLCB0b3BpYywgYWxpYXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy50b3BpY0FsaWFzU2VuZC5wdXQodG9waWMsIGFsaWFzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZygnYXBwbHlUb3BpY0FsaWFzIDo6IGVycm9yIG91dCBvZiByYW5nZS4gdG9waWM6ICVzIC0gYWxpYXM6ICVkJywgdG9waWMsIGFsaWFzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignU2VuZGluZyBUb3BpYyBBbGlhcyBvdXQgb2YgcmFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodG9waWMubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmF1dG9Bc3NpZ25Ub3BpY0FsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxpYXMgPSB0aGlzLnRvcGljQWxpYXNTZW5kLmdldEFsaWFzQnlUb3BpYyh0b3BpYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhY2tldC50b3BpYyA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWNrZXQucHJvcGVydGllcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnBhY2tldC5wcm9wZXJ0aWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9waWNBbGlhczogYWxpYXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKCdhcHBseVRvcGljQWxpYXMgOjogYXV0byBhc3NpZ24odXNlKSB0b3BpYzogJXMgLSBhbGlhczogJWQnLCB0b3BpYywgYWxpYXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxpYXMgPSB0aGlzLnRvcGljQWxpYXNTZW5kLmdldExydUFsaWFzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9waWNBbGlhc1NlbmQucHV0KHRvcGljLCBhbGlhcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhY2tldC5wcm9wZXJ0aWVzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4ucGFja2V0LnByb3BlcnRpZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3BpY0FsaWFzOiBhbGlhcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coJ2FwcGx5VG9waWNBbGlhcyA6OiBhdXRvIGFzc2lnbiB0b3BpYzogJXMgLSBhbGlhczogJWQnLCB0b3BpYywgYWxpYXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMub3B0aW9ucy5hdXRvVXNlVG9waWNBbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWFzID0gdGhpcy50b3BpY0FsaWFzU2VuZC5nZXRBbGlhc0J5VG9waWModG9waWMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWNrZXQudG9waWMgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFja2V0LnByb3BlcnRpZXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5wYWNrZXQucHJvcGVydGllcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcGljQWxpYXM6IGFsaWFzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZygnYXBwbHlUb3BpY0FsaWFzIDo6IGF1dG8gdXNlIHRvcGljOiAlcyAtIGFsaWFzOiAlZCcsIHRvcGljLCBhbGlhcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKCdhcHBseVRvcGljQWxpYXMgOjogZXJyb3Igb3V0IG9mIHJhbmdlLiB0b3BpYzogJXMgLSBhbGlhczogJWQnLCB0b3BpYywgYWxpYXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdTZW5kaW5nIFRvcGljIEFsaWFzIG91dCBvZiByYW5nZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBfbm9vcChlcnIpIHtcbiAgICAgICAgdGhpcy5sb2coJ25vb3AgOjonLCBlcnIpO1xuICAgIH1cbiAgICBfd3JpdGVQYWNrZXQocGFja2V0LCBjYikge1xuICAgICAgICB0aGlzLmxvZygnX3dyaXRlUGFja2V0IDo6IHBhY2tldDogJU8nLCBwYWNrZXQpO1xuICAgICAgICB0aGlzLmxvZygnX3dyaXRlUGFja2V0IDo6IGVtaXR0aW5nIGBwYWNrZXRzZW5kYCcpO1xuICAgICAgICB0aGlzLmVtaXQoJ3BhY2tldHNlbmQnLCBwYWNrZXQpO1xuICAgICAgICB0aGlzLmxvZygnX3dyaXRlUGFja2V0IDo6IHdyaXRpbmcgdG8gc3RyZWFtJyk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG1xdHRfcGFja2V0XzEuZGVmYXVsdC53cml0ZVRvU3RyZWFtKHBhY2tldCwgdGhpcy5zdHJlYW0sIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIHRoaXMubG9nKCdfd3JpdGVQYWNrZXQgOjogd3JpdGVUb1N0cmVhbSByZXN1bHQgJXMnLCByZXN1bHQpO1xuICAgICAgICBpZiAoIXJlc3VsdCAmJiBjYiAmJiBjYiAhPT0gdGhpcy5ub29wKSB7XG4gICAgICAgICAgICB0aGlzLmxvZygnX3dyaXRlUGFja2V0IDo6IGhhbmRsZSBldmVudHMgb24gYGRyYWluYCBvbmNlIHRocm91Z2ggY2FsbGJhY2suJyk7XG4gICAgICAgICAgICB0aGlzLnN0cmVhbS5vbmNlKCdkcmFpbicsIGNiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjYikge1xuICAgICAgICAgICAgdGhpcy5sb2coJ193cml0ZVBhY2tldCA6OiBpbnZva2luZyBjYicpO1xuICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc2VuZFBhY2tldChwYWNrZXQsIGNiLCBjYlN0b3JlUHV0LCBub1N0b3JlKSB7XG4gICAgICAgIHRoaXMubG9nKCdfc2VuZFBhY2tldCA6OiAoJXMpIDo6ICBzdGFydCcsIHRoaXMub3B0aW9ucy5jbGllbnRJZCk7XG4gICAgICAgIGNiU3RvcmVQdXQgPSBjYlN0b3JlUHV0IHx8IHRoaXMubm9vcDtcbiAgICAgICAgY2IgPSBjYiB8fCB0aGlzLm5vb3A7XG4gICAgICAgIGNvbnN0IGVyciA9IHRoaXMuX2FwcGx5VG9waWNBbGlhcyhwYWNrZXQpO1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBjYihlcnIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChwYWNrZXQuY21kID09PSAnYXV0aCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93cml0ZVBhY2tldChwYWNrZXQsIGNiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxvZygnX3NlbmRQYWNrZXQgOjogY2xpZW50IG5vdCBjb25uZWN0ZWQuIFN0b3JpbmcgcGFja2V0IG9mZmxpbmUuJyk7XG4gICAgICAgICAgICB0aGlzLl9zdG9yZVBhY2tldChwYWNrZXQsIGNiLCBjYlN0b3JlUHV0KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9TdG9yZSkge1xuICAgICAgICAgICAgdGhpcy5fd3JpdGVQYWNrZXQocGFja2V0LCBjYik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoIChwYWNrZXQuY21kKSB7XG4gICAgICAgICAgICBjYXNlICdwdWJsaXNoJzpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3B1YnJlbCc6XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RvcmVBbmRTZW5kKHBhY2tldCwgY2IsIGNiU3RvcmVQdXQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVQYWNrZXQocGFja2V0LCBjYik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAocGFja2V0LnFvcykge1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHRoaXMuX3N0b3JlQW5kU2VuZChwYWNrZXQsIGNiLCBjYlN0b3JlUHV0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVQYWNrZXQocGFja2V0LCBjYik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sb2coJ19zZW5kUGFja2V0IDo6ICglcykgOjogIGVuZCcsIHRoaXMub3B0aW9ucy5jbGllbnRJZCk7XG4gICAgfVxuICAgIF9zdG9yZVBhY2tldChwYWNrZXQsIGNiLCBjYlN0b3JlUHV0KSB7XG4gICAgICAgIHRoaXMubG9nKCdfc3RvcmVQYWNrZXQgOjogcGFja2V0OiAlbycsIHBhY2tldCk7XG4gICAgICAgIHRoaXMubG9nKCdfc3RvcmVQYWNrZXQgOjogY2I/ICVzJywgISFjYik7XG4gICAgICAgIGNiU3RvcmVQdXQgPSBjYlN0b3JlUHV0IHx8IHRoaXMubm9vcDtcbiAgICAgICAgbGV0IHN0b3JlUGFja2V0ID0gcGFja2V0O1xuICAgICAgICBpZiAoc3RvcmVQYWNrZXQuY21kID09PSAncHVibGlzaCcpIHtcbiAgICAgICAgICAgIHN0b3JlUGFja2V0ID0gKDAsIGRlZmF1bHRfMS5kZWZhdWx0KShwYWNrZXQpO1xuICAgICAgICAgICAgY29uc3QgZXJyID0gdGhpcy5fcmVtb3ZlVG9waWNBbGlhc0FuZFJlY292ZXJUb3BpY05hbWUoc3RvcmVQYWNrZXQpO1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYiAmJiBjYihlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHFvcyA9IHN0b3JlUGFja2V0LnFvcyB8fCAwO1xuICAgICAgICBpZiAoKHFvcyA9PT0gMCAmJiB0aGlzLnF1ZXVlUW9TWmVybykgfHwgc3RvcmVQYWNrZXQuY21kICE9PSAncHVibGlzaCcpIHtcbiAgICAgICAgICAgIHRoaXMucXVldWUucHVzaCh7IHBhY2tldDogc3RvcmVQYWNrZXQsIGNiIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHFvcyA+IDApIHtcbiAgICAgICAgICAgIGNiID0gdGhpcy5vdXRnb2luZ1tzdG9yZVBhY2tldC5tZXNzYWdlSWRdXG4gICAgICAgICAgICAgICAgPyB0aGlzLm91dGdvaW5nW3N0b3JlUGFja2V0Lm1lc3NhZ2VJZF0uY2JcbiAgICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgICB0aGlzLm91dGdvaW5nU3RvcmUucHV0KHN0b3JlUGFja2V0LCAoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2IgJiYgY2IoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2JTdG9yZVB1dCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY2IpIHtcbiAgICAgICAgICAgIGNiKG5ldyBFcnJvcignTm8gY29ubmVjdGlvbiB0byBicm9rZXInKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3NldHVwS2VlcGFsaXZlTWFuYWdlcigpIHtcbiAgICAgICAgdGhpcy5sb2coJ19zZXR1cEtlZXBhbGl2ZU1hbmFnZXIgOjoga2VlcGFsaXZlICVkIChzZWNvbmRzKScsIHRoaXMub3B0aW9ucy5rZWVwYWxpdmUpO1xuICAgICAgICBpZiAoIXRoaXMua2VlcGFsaXZlTWFuYWdlciAmJiB0aGlzLm9wdGlvbnMua2VlcGFsaXZlKSB7XG4gICAgICAgICAgICB0aGlzLmtlZXBhbGl2ZU1hbmFnZXIgPSBuZXcgS2VlcGFsaXZlTWFuYWdlcl8xLmRlZmF1bHQodGhpcywgdGhpcy5vcHRpb25zLnRpbWVyVmFyaWFudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2Rlc3Ryb3lLZWVwYWxpdmVNYW5hZ2VyKCkge1xuICAgICAgICBpZiAodGhpcy5rZWVwYWxpdmVNYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLmxvZygnX2Rlc3Ryb3lLZWVwYWxpdmVNYW5hZ2VyIDo6IGRlc3Ryb3lpbmcga2VlcGFsaXZlIG1hbmFnZXInKTtcbiAgICAgICAgICAgIHRoaXMua2VlcGFsaXZlTWFuYWdlci5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLmtlZXBhbGl2ZU1hbmFnZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlc2NoZWR1bGVQaW5nKGZvcmNlID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKHRoaXMua2VlcGFsaXZlTWFuYWdlciAmJlxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmtlZXBhbGl2ZSAmJlxuICAgICAgICAgICAgKGZvcmNlIHx8IHRoaXMub3B0aW9ucy5yZXNjaGVkdWxlUGluZ3MpKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNjaGVkdWxlUGluZygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9yZXNjaGVkdWxlUGluZygpIHtcbiAgICAgICAgdGhpcy5sb2coJ19yZXNjaGVkdWxlUGluZyA6OiByZXNjaGVkdWxpbmcgcGluZycpO1xuICAgICAgICB0aGlzLmtlZXBhbGl2ZU1hbmFnZXIucmVzY2hlZHVsZSgpO1xuICAgIH1cbiAgICBzZW5kUGluZygpIHtcbiAgICAgICAgdGhpcy5sb2coJ19zZW5kUGluZyA6OiBzZW5kaW5nIHBpbmdyZXEnKTtcbiAgICAgICAgdGhpcy5fc2VuZFBhY2tldCh7IGNtZDogJ3BpbmdyZXEnIH0pO1xuICAgIH1cbiAgICBvbktlZXBhbGl2ZVRpbWVvdXQoKSB7XG4gICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ0tlZXBhbGl2ZSB0aW1lb3V0JykpO1xuICAgICAgICB0aGlzLmxvZygnb25LZWVwYWxpdmVUaW1lb3V0IDo6IGNhbGxpbmcgX2NsZWFuVXAgd2l0aCBmb3JjZSB0cnVlJyk7XG4gICAgICAgIHRoaXMuX2NsZWFuVXAodHJ1ZSk7XG4gICAgfVxuICAgIF9yZXN1YnNjcmliZSgpIHtcbiAgICAgICAgdGhpcy5sb2coJ19yZXN1YnNjcmliZScpO1xuICAgICAgICBjb25zdCBfcmVzdWJzY3JpYmVUb3BpY3NLZXlzID0gT2JqZWN0LmtleXModGhpcy5fcmVzdWJzY3JpYmVUb3BpY3MpO1xuICAgICAgICBpZiAoIXRoaXMuX2ZpcnN0Q29ubmVjdGlvbiAmJlxuICAgICAgICAgICAgKHRoaXMub3B0aW9ucy5jbGVhbiB8fFxuICAgICAgICAgICAgICAgICh0aGlzLm9wdGlvbnMucHJvdG9jb2xWZXJzaW9uID49IDQgJiZcbiAgICAgICAgICAgICAgICAgICAgIXRoaXMuY29ubmFja1BhY2tldC5zZXNzaW9uUHJlc2VudCkpICYmXG4gICAgICAgICAgICBfcmVzdWJzY3JpYmVUb3BpY3NLZXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmVzdWJzY3JpYmUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnByb3RvY29sVmVyc2lvbiA9PT0gNSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZygnX3Jlc3Vic2NyaWJlOiBwcm90b2NvbFZlcnNpb24gNScpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB0b3BpY0kgPSAwOyB0b3BpY0kgPCBfcmVzdWJzY3JpYmVUb3BpY3NLZXlzLmxlbmd0aDsgdG9waWNJKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3Vic2NyaWJlVG9waWMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3Vic2NyaWJlVG9waWNbX3Jlc3Vic2NyaWJlVG9waWNzS2V5c1t0b3BpY0ldXSA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzdWJzY3JpYmVUb3BpY3NbX3Jlc3Vic2NyaWJlVG9waWNzS2V5c1t0b3BpY0ldXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3Vic2NyaWJlVG9waWMucmVzdWJzY3JpYmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmUocmVzdWJzY3JpYmVUb3BpYywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHJlc3Vic2NyaWJlVG9waWNbX3Jlc3Vic2NyaWJlVG9waWNzS2V5c1t0b3BpY0ldXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucHJvcGVydGllcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXN1YnNjcmliZVRvcGljcy5yZXN1YnNjcmliZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMuX3Jlc3Vic2NyaWJlVG9waWNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXN1YnNjcmliZVRvcGljcyA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2ZpcnN0Q29ubmVjdGlvbiA9IGZhbHNlO1xuICAgIH1cbiAgICBfb25Db25uZWN0KHBhY2tldCkge1xuICAgICAgICBpZiAodGhpcy5kaXNjb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnY29ubmVjdCcsIHBhY2tldCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25uYWNrUGFja2V0ID0gcGFja2V0O1xuICAgICAgICB0aGlzLm1lc3NhZ2VJZFByb3ZpZGVyLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuX3NldHVwS2VlcGFsaXZlTWFuYWdlcigpO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IHRydWU7XG4gICAgICAgIGNvbnN0IHN0YXJ0U3RyZWFtUHJvY2VzcyA9ICgpID0+IHtcbiAgICAgICAgICAgIGxldCBvdXRTdG9yZSA9IHRoaXMub3V0Z29pbmdTdG9yZS5jcmVhdGVTdHJlYW0oKTtcbiAgICAgICAgICAgIGNvbnN0IHJlbW92ZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBvdXRTdG9yZS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgb3V0U3RvcmUgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ZsdXNoU3RvcmVQcm9jZXNzaW5nUXVldWUoKTtcbiAgICAgICAgICAgICAgICBjbGVhclN0b3JlUHJvY2Vzc2luZygpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFyU3RvcmVQcm9jZXNzaW5nID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0b3JlUHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BhY2tldElkc0R1cmluZ1N0b3JlUHJvY2Vzc2luZyA9IHt9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMub25jZSgnY2xvc2UnLCByZW1vdmUpO1xuICAgICAgICAgICAgb3V0U3RvcmUub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGNsZWFyU3RvcmVQcm9jZXNzaW5nKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmx1c2hTdG9yZVByb2Nlc3NpbmdRdWV1ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgcmVtb3ZlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgc3RvcmVEZWxpdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghb3V0U3RvcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBwYWNrZXQyID0gb3V0U3RvcmUucmVhZCgxKTtcbiAgICAgICAgICAgICAgICBsZXQgY2I7XG4gICAgICAgICAgICAgICAgaWYgKCFwYWNrZXQyKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dFN0b3JlLm9uY2UoJ3JlYWRhYmxlJywgc3RvcmVEZWxpdmVyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9zdG9yZVByb2Nlc3NpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wYWNrZXRJZHNEdXJpbmdTdG9yZVByb2Nlc3NpbmdbcGFja2V0Mi5tZXNzYWdlSWRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3JlRGVsaXZlcigpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5kaXNjb25uZWN0aW5nICYmICF0aGlzLnJlY29ubmVjdFRpbWVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNiID0gdGhpcy5vdXRnb2luZ1twYWNrZXQyLm1lc3NhZ2VJZF1cbiAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5vdXRnb2luZ1twYWNrZXQyLm1lc3NhZ2VJZF0uY2JcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRnb2luZ1twYWNrZXQyLm1lc3NhZ2VJZF0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2b2xhdGlsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYihlcnIsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYihlcnIsIHN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlRGVsaXZlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFja2V0SWRzRHVyaW5nU3RvcmVQcm9jZXNzaW5nW3BhY2tldDIubWVzc2FnZUlkXSA9XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tZXNzYWdlSWRQcm92aWRlci5yZWdpc3RlcihwYWNrZXQyLm1lc3NhZ2VJZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbmRQYWNrZXQocGFja2V0MiwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coJ21lc3NhZ2VJZDogJWQgaGFzIGFscmVhZHkgdXNlZC4nLCBwYWNrZXQyLm1lc3NhZ2VJZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob3V0U3RvcmUuZGVzdHJveSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRTdG9yZS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG91dFN0b3JlLm9uKCdlbmQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGFsbFByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpZCBpbiB0aGlzLl9wYWNrZXRJZHNEdXJpbmdTdG9yZVByb2Nlc3NpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9wYWNrZXRJZHNEdXJpbmdTdG9yZVByb2Nlc3NpbmdbaWRdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxQcm9jZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgcmVtb3ZlKTtcbiAgICAgICAgICAgICAgICBpZiAoYWxsUHJvY2Vzc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyU3RvcmVQcm9jZXNzaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ludm9rZUFsbFN0b3JlUHJvY2Vzc2luZ1F1ZXVlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgnY29ubmVjdCcsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGFydFN0cmVhbVByb2Nlc3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN0b3JlRGVsaXZlcigpO1xuICAgICAgICB9O1xuICAgICAgICBzdGFydFN0cmVhbVByb2Nlc3MoKTtcbiAgICB9XG4gICAgX2ludm9rZVN0b3JlUHJvY2Vzc2luZ1F1ZXVlKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3N0b3JlUHJvY2Vzc2luZyAmJiB0aGlzLl9zdG9yZVByb2Nlc3NpbmdRdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBmID0gdGhpcy5fc3RvcmVQcm9jZXNzaW5nUXVldWVbMF07XG4gICAgICAgICAgICBpZiAoZiAmJiBmLmludm9rZSgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RvcmVQcm9jZXNzaW5nUXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIF9pbnZva2VBbGxTdG9yZVByb2Nlc3NpbmdRdWV1ZSgpIHtcbiAgICAgICAgd2hpbGUgKHRoaXMuX2ludm9rZVN0b3JlUHJvY2Vzc2luZ1F1ZXVlKCkpIHtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfZmx1c2hTdG9yZVByb2Nlc3NpbmdRdWV1ZSgpIHtcbiAgICAgICAgZm9yIChjb25zdCBmIG9mIHRoaXMuX3N0b3JlUHJvY2Vzc2luZ1F1ZXVlKSB7XG4gICAgICAgICAgICBpZiAoZi5jYlN0b3JlUHV0KVxuICAgICAgICAgICAgICAgIGYuY2JTdG9yZVB1dChuZXcgRXJyb3IoJ0Nvbm5lY3Rpb24gY2xvc2VkJykpO1xuICAgICAgICAgICAgaWYgKGYuY2FsbGJhY2spXG4gICAgICAgICAgICAgICAgZi5jYWxsYmFjayhuZXcgRXJyb3IoJ0Nvbm5lY3Rpb24gY2xvc2VkJykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3N0b3JlUHJvY2Vzc2luZ1F1ZXVlLnNwbGljZSgwKTtcbiAgICB9XG4gICAgX3JlbW92ZU91dGdvaW5nQW5kU3RvcmVNZXNzYWdlKG1lc3NhZ2VJZCwgY2IpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMub3V0Z29pbmdbbWVzc2FnZUlkXTtcbiAgICAgICAgdGhpcy5vdXRnb2luZ1N0b3JlLmRlbCh7IG1lc3NhZ2VJZCB9LCAoZXJyLCBwYWNrZXQpID0+IHtcbiAgICAgICAgICAgIGNiKGVyciwgcGFja2V0KTtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUlkUHJvdmlkZXIuZGVhbGxvY2F0ZShtZXNzYWdlSWQpO1xuICAgICAgICAgICAgdGhpcy5faW52b2tlU3RvcmVQcm9jZXNzaW5nUXVldWUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZXhwb3J0cy5kZWZhdWx0ID0gTXF0dENsaWVudDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNsaWVudC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/client.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/connect/ali.js":
/*!****************************************************!*\
  !*** ./node_modules/mqtt/build/lib/connect/ali.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst buffer_1 = __webpack_require__(/*! buffer */ \"buffer\");\nconst readable_stream_1 = __webpack_require__(/*! readable-stream */ \"(ssr)/./node_modules/readable-stream/lib/ours/index.js\");\nconst BufferedDuplex_1 = __webpack_require__(/*! ../BufferedDuplex */ \"(ssr)/./node_modules/mqtt/build/lib/BufferedDuplex.js\");\nlet my;\nlet proxy;\nlet stream;\nlet isInitialized = false;\nfunction buildProxy() {\n    const _proxy = new readable_stream_1.Transform();\n    _proxy._write = (chunk, encoding, next) => {\n        my.sendSocketMessage({\n            data: chunk.buffer,\n            success() {\n                next();\n            },\n            fail() {\n                next(new Error());\n            },\n        });\n    };\n    _proxy._flush = (done) => {\n        my.closeSocket({\n            success() {\n                done();\n            },\n        });\n    };\n    return _proxy;\n}\nfunction setDefaultOpts(opts) {\n    if (!opts.hostname) {\n        opts.hostname = 'localhost';\n    }\n    if (!opts.path) {\n        opts.path = '/';\n    }\n    if (!opts.wsOptions) {\n        opts.wsOptions = {};\n    }\n}\nfunction buildUrl(opts, client) {\n    const protocol = opts.protocol === 'alis' ? 'wss' : 'ws';\n    let url = `${protocol}://${opts.hostname}${opts.path}`;\n    if (opts.port && opts.port !== 80 && opts.port !== 443) {\n        url = `${protocol}://${opts.hostname}:${opts.port}${opts.path}`;\n    }\n    if (typeof opts.transformWsUrl === 'function') {\n        url = opts.transformWsUrl(url, opts, client);\n    }\n    return url;\n}\nfunction bindEventHandler() {\n    if (isInitialized)\n        return;\n    isInitialized = true;\n    my.onSocketOpen(() => {\n        stream.socketReady();\n    });\n    my.onSocketMessage((res) => {\n        if (typeof res.data === 'string') {\n            const buffer = buffer_1.Buffer.from(res.data, 'base64');\n            proxy.push(buffer);\n        }\n        else {\n            const reader = new FileReader();\n            reader.addEventListener('load', () => {\n                if (reader.result instanceof ArrayBuffer) {\n                    proxy.push(buffer_1.Buffer.from(reader.result));\n                    return;\n                }\n                proxy.push(buffer_1.Buffer.from(reader.result, 'utf-8'));\n            });\n            reader.readAsArrayBuffer(res.data);\n        }\n    });\n    my.onSocketClose(() => {\n        stream.end();\n        stream.destroy();\n    });\n    my.onSocketError((err) => {\n        stream.destroy(err);\n    });\n}\nconst buildStream = (client, opts) => {\n    opts.hostname = opts.hostname || opts.host;\n    if (!opts.hostname) {\n        throw new Error('Could not determine host. Specify host manually.');\n    }\n    const websocketSubProtocol = opts.protocolId === 'MQIsdp' && opts.protocolVersion === 3\n        ? 'mqttv3.1'\n        : 'mqtt';\n    setDefaultOpts(opts);\n    const url = buildUrl(opts, client);\n    my = opts.my;\n    my.connectSocket({\n        url,\n        protocols: websocketSubProtocol,\n    });\n    proxy = buildProxy();\n    stream = new BufferedDuplex_1.BufferedDuplex(opts, proxy, my);\n    bindEventHandler();\n    return stream;\n};\nexports[\"default\"] = buildStream;\n//# sourceMappingURL=ali.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC9hbGkuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsaUJBQWlCLG1CQUFPLENBQUMsc0JBQVE7QUFDakMsMEJBQTBCLG1CQUFPLENBQUMsK0VBQWlCO0FBQ25ELHlCQUF5QixtQkFBTyxDQUFDLGdGQUFtQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQVMsS0FBSyxjQUFjLEVBQUUsVUFBVTtBQUN6RDtBQUNBLGlCQUFpQixTQUFTLEtBQUssY0FBYyxHQUFHLFVBQVUsRUFBRSxVQUFVO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWU7QUFDZiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC9hbGkuanM/ZjEzNyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IGJ1ZmZlcl8xID0gcmVxdWlyZShcImJ1ZmZlclwiKTtcbmNvbnN0IHJlYWRhYmxlX3N0cmVhbV8xID0gcmVxdWlyZShcInJlYWRhYmxlLXN0cmVhbVwiKTtcbmNvbnN0IEJ1ZmZlcmVkRHVwbGV4XzEgPSByZXF1aXJlKFwiLi4vQnVmZmVyZWREdXBsZXhcIik7XG5sZXQgbXk7XG5sZXQgcHJveHk7XG5sZXQgc3RyZWFtO1xubGV0IGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbmZ1bmN0aW9uIGJ1aWxkUHJveHkoKSB7XG4gICAgY29uc3QgX3Byb3h5ID0gbmV3IHJlYWRhYmxlX3N0cmVhbV8xLlRyYW5zZm9ybSgpO1xuICAgIF9wcm94eS5fd3JpdGUgPSAoY2h1bmssIGVuY29kaW5nLCBuZXh0KSA9PiB7XG4gICAgICAgIG15LnNlbmRTb2NrZXRNZXNzYWdlKHtcbiAgICAgICAgICAgIGRhdGE6IGNodW5rLmJ1ZmZlcixcbiAgICAgICAgICAgIHN1Y2Nlc3MoKSB7XG4gICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZhaWwoKSB7XG4gICAgICAgICAgICAgICAgbmV4dChuZXcgRXJyb3IoKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIF9wcm94eS5fZmx1c2ggPSAoZG9uZSkgPT4ge1xuICAgICAgICBteS5jbG9zZVNvY2tldCh7XG4gICAgICAgICAgICBzdWNjZXNzKCkge1xuICAgICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIF9wcm94eTtcbn1cbmZ1bmN0aW9uIHNldERlZmF1bHRPcHRzKG9wdHMpIHtcbiAgICBpZiAoIW9wdHMuaG9zdG5hbWUpIHtcbiAgICAgICAgb3B0cy5ob3N0bmFtZSA9ICdsb2NhbGhvc3QnO1xuICAgIH1cbiAgICBpZiAoIW9wdHMucGF0aCkge1xuICAgICAgICBvcHRzLnBhdGggPSAnLyc7XG4gICAgfVxuICAgIGlmICghb3B0cy53c09wdGlvbnMpIHtcbiAgICAgICAgb3B0cy53c09wdGlvbnMgPSB7fTtcbiAgICB9XG59XG5mdW5jdGlvbiBidWlsZFVybChvcHRzLCBjbGllbnQpIHtcbiAgICBjb25zdCBwcm90b2NvbCA9IG9wdHMucHJvdG9jb2wgPT09ICdhbGlzJyA/ICd3c3MnIDogJ3dzJztcbiAgICBsZXQgdXJsID0gYCR7cHJvdG9jb2x9Oi8vJHtvcHRzLmhvc3RuYW1lfSR7b3B0cy5wYXRofWA7XG4gICAgaWYgKG9wdHMucG9ydCAmJiBvcHRzLnBvcnQgIT09IDgwICYmIG9wdHMucG9ydCAhPT0gNDQzKSB7XG4gICAgICAgIHVybCA9IGAke3Byb3RvY29sfTovLyR7b3B0cy5ob3N0bmFtZX06JHtvcHRzLnBvcnR9JHtvcHRzLnBhdGh9YDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRzLnRyYW5zZm9ybVdzVXJsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHVybCA9IG9wdHMudHJhbnNmb3JtV3NVcmwodXJsLCBvcHRzLCBjbGllbnQpO1xuICAgIH1cbiAgICByZXR1cm4gdXJsO1xufVxuZnVuY3Rpb24gYmluZEV2ZW50SGFuZGxlcigpIHtcbiAgICBpZiAoaXNJbml0aWFsaXplZClcbiAgICAgICAgcmV0dXJuO1xuICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIG15Lm9uU29ja2V0T3BlbigoKSA9PiB7XG4gICAgICAgIHN0cmVhbS5zb2NrZXRSZWFkeSgpO1xuICAgIH0pO1xuICAgIG15Lm9uU29ja2V0TWVzc2FnZSgocmVzKSA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgcmVzLmRhdGEgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBjb25zdCBidWZmZXIgPSBidWZmZXJfMS5CdWZmZXIuZnJvbShyZXMuZGF0YSwgJ2Jhc2U2NCcpO1xuICAgICAgICAgICAgcHJveHkucHVzaChidWZmZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgIHJlYWRlci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChyZWFkZXIucmVzdWx0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJveHkucHVzaChidWZmZXJfMS5CdWZmZXIuZnJvbShyZWFkZXIucmVzdWx0KSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJveHkucHVzaChidWZmZXJfMS5CdWZmZXIuZnJvbShyZWFkZXIucmVzdWx0LCAndXRmLTgnKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihyZXMuZGF0YSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBteS5vblNvY2tldENsb3NlKCgpID0+IHtcbiAgICAgICAgc3RyZWFtLmVuZCgpO1xuICAgICAgICBzdHJlYW0uZGVzdHJveSgpO1xuICAgIH0pO1xuICAgIG15Lm9uU29ja2V0RXJyb3IoKGVycikgPT4ge1xuICAgICAgICBzdHJlYW0uZGVzdHJveShlcnIpO1xuICAgIH0pO1xufVxuY29uc3QgYnVpbGRTdHJlYW0gPSAoY2xpZW50LCBvcHRzKSA9PiB7XG4gICAgb3B0cy5ob3N0bmFtZSA9IG9wdHMuaG9zdG5hbWUgfHwgb3B0cy5ob3N0O1xuICAgIGlmICghb3B0cy5ob3N0bmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBkZXRlcm1pbmUgaG9zdC4gU3BlY2lmeSBob3N0IG1hbnVhbGx5LicpO1xuICAgIH1cbiAgICBjb25zdCB3ZWJzb2NrZXRTdWJQcm90b2NvbCA9IG9wdHMucHJvdG9jb2xJZCA9PT0gJ01RSXNkcCcgJiYgb3B0cy5wcm90b2NvbFZlcnNpb24gPT09IDNcbiAgICAgICAgPyAnbXF0dHYzLjEnXG4gICAgICAgIDogJ21xdHQnO1xuICAgIHNldERlZmF1bHRPcHRzKG9wdHMpO1xuICAgIGNvbnN0IHVybCA9IGJ1aWxkVXJsKG9wdHMsIGNsaWVudCk7XG4gICAgbXkgPSBvcHRzLm15O1xuICAgIG15LmNvbm5lY3RTb2NrZXQoe1xuICAgICAgICB1cmwsXG4gICAgICAgIHByb3RvY29sczogd2Vic29ja2V0U3ViUHJvdG9jb2wsXG4gICAgfSk7XG4gICAgcHJveHkgPSBidWlsZFByb3h5KCk7XG4gICAgc3RyZWFtID0gbmV3IEJ1ZmZlcmVkRHVwbGV4XzEuQnVmZmVyZWREdXBsZXgob3B0cywgcHJveHksIG15KTtcbiAgICBiaW5kRXZlbnRIYW5kbGVyKCk7XG4gICAgcmV0dXJuIHN0cmVhbTtcbn07XG5leHBvcnRzLmRlZmF1bHQgPSBidWlsZFN0cmVhbTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFsaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/connect/ali.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/connect/index.js":
/*!******************************************************!*\
  !*** ./node_modules/mqtt/build/lib/connect/index.js ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.connectAsync = connectAsync;\nconst debug_1 = __importDefault(__webpack_require__(/*! debug */ \"(ssr)/./node_modules/debug/src/index.js\"));\nconst url_1 = __importDefault(__webpack_require__(/*! url */ \"url\"));\nconst client_1 = __importDefault(__webpack_require__(/*! ../client */ \"(ssr)/./node_modules/mqtt/build/lib/client.js\"));\nconst is_browser_1 = __importDefault(__webpack_require__(/*! ../is-browser */ \"(ssr)/./node_modules/mqtt/build/lib/is-browser.js\"));\nif (typeof process?.nextTick !== 'function') {\n    process.nextTick = setImmediate;\n}\nconst debug = (0, debug_1.default)('mqttjs');\nlet protocols = null;\nfunction parseAuthOptions(opts) {\n    let matches;\n    if (opts.auth) {\n        matches = opts.auth.match(/^(.+):(.+)$/);\n        if (matches) {\n            const [, username, password] = matches;\n            opts.username = username;\n            opts.password = password;\n        }\n        else {\n            opts.username = opts.auth;\n        }\n    }\n}\nfunction connect(brokerUrl, opts) {\n    debug('connecting to an MQTT broker...');\n    if (typeof brokerUrl === 'object' && !opts) {\n        opts = brokerUrl;\n        brokerUrl = '';\n    }\n    opts = opts || {};\n    if (brokerUrl && typeof brokerUrl === 'string') {\n        const parsedUrl = url_1.default.parse(brokerUrl, true);\n        const parsedOptions = {};\n        if (parsedUrl.port != null) {\n            parsedOptions.port = Number(parsedUrl.port);\n        }\n        parsedOptions.host = parsedUrl.hostname;\n        parsedOptions.query = parsedUrl.query;\n        parsedOptions.auth = parsedUrl.auth;\n        parsedOptions.protocol = parsedUrl.protocol;\n        parsedOptions.path = parsedUrl.path;\n        opts = { ...parsedOptions, ...opts };\n        if (!opts.protocol) {\n            throw new Error('Missing protocol');\n        }\n        opts.protocol = opts.protocol.replace(/:$/, '');\n    }\n    opts.unixSocket = opts.unixSocket || opts.protocol?.includes('+unix');\n    if (opts.unixSocket) {\n        opts.protocol = opts.protocol.replace('+unix', '');\n    }\n    else if (!opts.protocol?.startsWith('ws') &&\n        !opts.protocol?.startsWith('wx')) {\n        delete opts.path;\n    }\n    parseAuthOptions(opts);\n    if (opts.query && typeof opts.query.clientId === 'string') {\n        opts.clientId = opts.query.clientId;\n    }\n    if (is_browser_1.default || opts.unixSocket) {\n        opts.socksProxy = undefined;\n    }\n    else if (opts.socksProxy === undefined &&\n        typeof process !== 'undefined') {\n        opts.socksProxy = process.env['MQTTJS_SOCKS_PROXY'];\n    }\n    if (opts.cert && opts.key) {\n        if (opts.protocol) {\n            if (['mqtts', 'wss', 'wxs', 'alis'].indexOf(opts.protocol) === -1) {\n                switch (opts.protocol) {\n                    case 'mqtt':\n                        opts.protocol = 'mqtts';\n                        break;\n                    case 'ws':\n                        opts.protocol = 'wss';\n                        break;\n                    case 'wx':\n                        opts.protocol = 'wxs';\n                        break;\n                    case 'ali':\n                        opts.protocol = 'alis';\n                        break;\n                    default:\n                        throw new Error(`Unknown protocol for secure connection: \"${opts.protocol}\"!`);\n                }\n            }\n        }\n        else {\n            throw new Error('Missing secure protocol key');\n        }\n    }\n    if (!protocols) {\n        protocols = {};\n        if (!is_browser_1.default && !opts.forceNativeWebSocket) {\n            protocols.ws = (__webpack_require__(/*! ./ws */ \"(ssr)/./node_modules/mqtt/build/lib/connect/ws.js\").streamBuilder);\n            protocols.wss = (__webpack_require__(/*! ./ws */ \"(ssr)/./node_modules/mqtt/build/lib/connect/ws.js\").streamBuilder);\n            protocols.mqtt = (__webpack_require__(/*! ./tcp */ \"(ssr)/./node_modules/mqtt/build/lib/connect/tcp.js\")[\"default\"]);\n            protocols.tcp = (__webpack_require__(/*! ./tcp */ \"(ssr)/./node_modules/mqtt/build/lib/connect/tcp.js\")[\"default\"]);\n            protocols.ssl = (__webpack_require__(/*! ./tls */ \"(ssr)/./node_modules/mqtt/build/lib/connect/tls.js\")[\"default\"]);\n            protocols.tls = protocols.ssl;\n            protocols.mqtts = (__webpack_require__(/*! ./tls */ \"(ssr)/./node_modules/mqtt/build/lib/connect/tls.js\")[\"default\"]);\n        }\n        else {\n            protocols.ws = (__webpack_require__(/*! ./ws */ \"(ssr)/./node_modules/mqtt/build/lib/connect/ws.js\").browserStreamBuilder);\n            protocols.wss = (__webpack_require__(/*! ./ws */ \"(ssr)/./node_modules/mqtt/build/lib/connect/ws.js\").browserStreamBuilder);\n            protocols.wx = (__webpack_require__(/*! ./wx */ \"(ssr)/./node_modules/mqtt/build/lib/connect/wx.js\")[\"default\"]);\n            protocols.wxs = (__webpack_require__(/*! ./wx */ \"(ssr)/./node_modules/mqtt/build/lib/connect/wx.js\")[\"default\"]);\n            protocols.ali = (__webpack_require__(/*! ./ali */ \"(ssr)/./node_modules/mqtt/build/lib/connect/ali.js\")[\"default\"]);\n            protocols.alis = (__webpack_require__(/*! ./ali */ \"(ssr)/./node_modules/mqtt/build/lib/connect/ali.js\")[\"default\"]);\n        }\n    }\n    if (!protocols[opts.protocol]) {\n        const isSecure = ['mqtts', 'wss'].indexOf(opts.protocol) !== -1;\n        opts.protocol = [\n            'mqtt',\n            'mqtts',\n            'ws',\n            'wss',\n            'wx',\n            'wxs',\n            'ali',\n            'alis',\n        ].filter((key, index) => {\n            if (isSecure && index % 2 === 0) {\n                return false;\n            }\n            return typeof protocols[key] === 'function';\n        })[0];\n    }\n    if (opts.clean === false && !opts.clientId) {\n        throw new Error('Missing clientId for unclean clients');\n    }\n    if (opts.protocol) {\n        opts.defaultProtocol = opts.protocol;\n    }\n    function wrapper(client) {\n        if (opts.servers) {\n            if (!client._reconnectCount ||\n                client._reconnectCount === opts.servers.length) {\n                client._reconnectCount = 0;\n            }\n            opts.host = opts.servers[client._reconnectCount].host;\n            opts.port = opts.servers[client._reconnectCount].port;\n            opts.protocol = !opts.servers[client._reconnectCount].protocol\n                ? opts.defaultProtocol\n                : opts.servers[client._reconnectCount].protocol;\n            opts.hostname = opts.host;\n            client._reconnectCount++;\n        }\n        debug('calling streambuilder for', opts.protocol);\n        return protocols[opts.protocol](client, opts);\n    }\n    const client = new client_1.default(wrapper, opts);\n    client.on('error', () => {\n    });\n    return client;\n}\nfunction connectAsync(brokerUrl, opts, allowRetries = true) {\n    return new Promise((resolve, reject) => {\n        const client = connect(brokerUrl, opts);\n        const promiseResolutionListeners = {\n            connect: (connack) => {\n                removePromiseResolutionListeners();\n                resolve(client);\n            },\n            end: () => {\n                removePromiseResolutionListeners();\n                resolve(client);\n            },\n            error: (err) => {\n                removePromiseResolutionListeners();\n                client.end();\n                reject(err);\n            },\n        };\n        if (allowRetries === false) {\n            promiseResolutionListeners.close = () => {\n                promiseResolutionListeners.error(new Error(\"Couldn't connect to server\"));\n            };\n        }\n        function removePromiseResolutionListeners() {\n            Object.keys(promiseResolutionListeners).forEach((eventName) => {\n                client.off(eventName, promiseResolutionListeners[eventName]);\n            });\n        }\n        Object.keys(promiseResolutionListeners).forEach((eventName) => {\n            client.on(eventName, promiseResolutionListeners[eventName]);\n        });\n    });\n}\nexports[\"default\"] = connect;\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELG9CQUFvQjtBQUNwQixnQ0FBZ0MsbUJBQU8sQ0FBQyxzREFBTztBQUMvQyw4QkFBOEIsbUJBQU8sQ0FBQyxnQkFBSztBQUMzQyxpQ0FBaUMsbUJBQU8sQ0FBQyxnRUFBVztBQUNwRCxxQ0FBcUMsbUJBQU8sQ0FBQyx3RUFBZTtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0ZBQW9GLGNBQWM7QUFDbEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsb0dBQTZCO0FBQ3hELDRCQUE0QixvR0FBNkI7QUFDekQsNkJBQTZCLG1HQUF3QjtBQUNyRCw0QkFBNEIsbUdBQXdCO0FBQ3BELDRCQUE0QixtR0FBd0I7QUFDcEQ7QUFDQSw4QkFBOEIsbUdBQXdCO0FBQ3REO0FBQ0E7QUFDQSwyQkFBMkIsMkdBQW9DO0FBQy9ELDRCQUE0QiwyR0FBb0M7QUFDaEUsMkJBQTJCLGlHQUF1QjtBQUNsRCw0QkFBNEIsaUdBQXVCO0FBQ25ELDRCQUE0QixtR0FBd0I7QUFDcEQsNkJBQTZCLG1HQUF3QjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0Esa0JBQWU7QUFDZiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC9pbmRleC5qcz9hYjIwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5jb25uZWN0QXN5bmMgPSBjb25uZWN0QXN5bmM7XG5jb25zdCBkZWJ1Z18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJkZWJ1Z1wiKSk7XG5jb25zdCB1cmxfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwidXJsXCIpKTtcbmNvbnN0IGNsaWVudF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9jbGllbnRcIikpO1xuY29uc3QgaXNfYnJvd3Nlcl8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9pcy1icm93c2VyXCIpKTtcbmlmICh0eXBlb2YgcHJvY2Vzcz8ubmV4dFRpY2sgIT09ICdmdW5jdGlvbicpIHtcbiAgICBwcm9jZXNzLm5leHRUaWNrID0gc2V0SW1tZWRpYXRlO1xufVxuY29uc3QgZGVidWcgPSAoMCwgZGVidWdfMS5kZWZhdWx0KSgnbXF0dGpzJyk7XG5sZXQgcHJvdG9jb2xzID0gbnVsbDtcbmZ1bmN0aW9uIHBhcnNlQXV0aE9wdGlvbnMob3B0cykge1xuICAgIGxldCBtYXRjaGVzO1xuICAgIGlmIChvcHRzLmF1dGgpIHtcbiAgICAgICAgbWF0Y2hlcyA9IG9wdHMuYXV0aC5tYXRjaCgvXiguKyk6KC4rKSQvKTtcbiAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IFssIHVzZXJuYW1lLCBwYXNzd29yZF0gPSBtYXRjaGVzO1xuICAgICAgICAgICAgb3B0cy51c2VybmFtZSA9IHVzZXJuYW1lO1xuICAgICAgICAgICAgb3B0cy5wYXNzd29yZCA9IHBhc3N3b3JkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb3B0cy51c2VybmFtZSA9IG9wdHMuYXV0aDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGNvbm5lY3QoYnJva2VyVXJsLCBvcHRzKSB7XG4gICAgZGVidWcoJ2Nvbm5lY3RpbmcgdG8gYW4gTVFUVCBicm9rZXIuLi4nKTtcbiAgICBpZiAodHlwZW9mIGJyb2tlclVybCA9PT0gJ29iamVjdCcgJiYgIW9wdHMpIHtcbiAgICAgICAgb3B0cyA9IGJyb2tlclVybDtcbiAgICAgICAgYnJva2VyVXJsID0gJyc7XG4gICAgfVxuICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgIGlmIChicm9rZXJVcmwgJiYgdHlwZW9mIGJyb2tlclVybCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgY29uc3QgcGFyc2VkVXJsID0gdXJsXzEuZGVmYXVsdC5wYXJzZShicm9rZXJVcmwsIHRydWUpO1xuICAgICAgICBjb25zdCBwYXJzZWRPcHRpb25zID0ge307XG4gICAgICAgIGlmIChwYXJzZWRVcmwucG9ydCAhPSBudWxsKSB7XG4gICAgICAgICAgICBwYXJzZWRPcHRpb25zLnBvcnQgPSBOdW1iZXIocGFyc2VkVXJsLnBvcnQpO1xuICAgICAgICB9XG4gICAgICAgIHBhcnNlZE9wdGlvbnMuaG9zdCA9IHBhcnNlZFVybC5ob3N0bmFtZTtcbiAgICAgICAgcGFyc2VkT3B0aW9ucy5xdWVyeSA9IHBhcnNlZFVybC5xdWVyeTtcbiAgICAgICAgcGFyc2VkT3B0aW9ucy5hdXRoID0gcGFyc2VkVXJsLmF1dGg7XG4gICAgICAgIHBhcnNlZE9wdGlvbnMucHJvdG9jb2wgPSBwYXJzZWRVcmwucHJvdG9jb2w7XG4gICAgICAgIHBhcnNlZE9wdGlvbnMucGF0aCA9IHBhcnNlZFVybC5wYXRoO1xuICAgICAgICBvcHRzID0geyAuLi5wYXJzZWRPcHRpb25zLCAuLi5vcHRzIH07XG4gICAgICAgIGlmICghb3B0cy5wcm90b2NvbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHByb3RvY29sJyk7XG4gICAgICAgIH1cbiAgICAgICAgb3B0cy5wcm90b2NvbCA9IG9wdHMucHJvdG9jb2wucmVwbGFjZSgvOiQvLCAnJyk7XG4gICAgfVxuICAgIG9wdHMudW5peFNvY2tldCA9IG9wdHMudW5peFNvY2tldCB8fCBvcHRzLnByb3RvY29sPy5pbmNsdWRlcygnK3VuaXgnKTtcbiAgICBpZiAob3B0cy51bml4U29ja2V0KSB7XG4gICAgICAgIG9wdHMucHJvdG9jb2wgPSBvcHRzLnByb3RvY29sLnJlcGxhY2UoJyt1bml4JywgJycpO1xuICAgIH1cbiAgICBlbHNlIGlmICghb3B0cy5wcm90b2NvbD8uc3RhcnRzV2l0aCgnd3MnKSAmJlxuICAgICAgICAhb3B0cy5wcm90b2NvbD8uc3RhcnRzV2l0aCgnd3gnKSkge1xuICAgICAgICBkZWxldGUgb3B0cy5wYXRoO1xuICAgIH1cbiAgICBwYXJzZUF1dGhPcHRpb25zKG9wdHMpO1xuICAgIGlmIChvcHRzLnF1ZXJ5ICYmIHR5cGVvZiBvcHRzLnF1ZXJ5LmNsaWVudElkID09PSAnc3RyaW5nJykge1xuICAgICAgICBvcHRzLmNsaWVudElkID0gb3B0cy5xdWVyeS5jbGllbnRJZDtcbiAgICB9XG4gICAgaWYgKGlzX2Jyb3dzZXJfMS5kZWZhdWx0IHx8IG9wdHMudW5peFNvY2tldCkge1xuICAgICAgICBvcHRzLnNvY2tzUHJveHkgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKG9wdHMuc29ja3NQcm94eSA9PT0gdW5kZWZpbmVkICYmXG4gICAgICAgIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBvcHRzLnNvY2tzUHJveHkgPSBwcm9jZXNzLmVudlsnTVFUVEpTX1NPQ0tTX1BST1hZJ107XG4gICAgfVxuICAgIGlmIChvcHRzLmNlcnQgJiYgb3B0cy5rZXkpIHtcbiAgICAgICAgaWYgKG9wdHMucHJvdG9jb2wpIHtcbiAgICAgICAgICAgIGlmIChbJ21xdHRzJywgJ3dzcycsICd3eHMnLCAnYWxpcyddLmluZGV4T2Yob3B0cy5wcm90b2NvbCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcHRzLnByb3RvY29sKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21xdHQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0cy5wcm90b2NvbCA9ICdtcXR0cyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnd3MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0cy5wcm90b2NvbCA9ICd3c3MnO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3d4JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdHMucHJvdG9jb2wgPSAnd3hzJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdhbGknOlxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0cy5wcm90b2NvbCA9ICdhbGlzJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHByb3RvY29sIGZvciBzZWN1cmUgY29ubmVjdGlvbjogXCIke29wdHMucHJvdG9jb2x9XCIhYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHNlY3VyZSBwcm90b2NvbCBrZXknKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXByb3RvY29scykge1xuICAgICAgICBwcm90b2NvbHMgPSB7fTtcbiAgICAgICAgaWYgKCFpc19icm93c2VyXzEuZGVmYXVsdCAmJiAhb3B0cy5mb3JjZU5hdGl2ZVdlYlNvY2tldCkge1xuICAgICAgICAgICAgcHJvdG9jb2xzLndzID0gcmVxdWlyZSgnLi93cycpLnN0cmVhbUJ1aWxkZXI7XG4gICAgICAgICAgICBwcm90b2NvbHMud3NzID0gcmVxdWlyZSgnLi93cycpLnN0cmVhbUJ1aWxkZXI7XG4gICAgICAgICAgICBwcm90b2NvbHMubXF0dCA9IHJlcXVpcmUoJy4vdGNwJykuZGVmYXVsdDtcbiAgICAgICAgICAgIHByb3RvY29scy50Y3AgPSByZXF1aXJlKCcuL3RjcCcpLmRlZmF1bHQ7XG4gICAgICAgICAgICBwcm90b2NvbHMuc3NsID0gcmVxdWlyZSgnLi90bHMnKS5kZWZhdWx0O1xuICAgICAgICAgICAgcHJvdG9jb2xzLnRscyA9IHByb3RvY29scy5zc2w7XG4gICAgICAgICAgICBwcm90b2NvbHMubXF0dHMgPSByZXF1aXJlKCcuL3RscycpLmRlZmF1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwcm90b2NvbHMud3MgPSByZXF1aXJlKCcuL3dzJykuYnJvd3NlclN0cmVhbUJ1aWxkZXI7XG4gICAgICAgICAgICBwcm90b2NvbHMud3NzID0gcmVxdWlyZSgnLi93cycpLmJyb3dzZXJTdHJlYW1CdWlsZGVyO1xuICAgICAgICAgICAgcHJvdG9jb2xzLnd4ID0gcmVxdWlyZSgnLi93eCcpLmRlZmF1bHQ7XG4gICAgICAgICAgICBwcm90b2NvbHMud3hzID0gcmVxdWlyZSgnLi93eCcpLmRlZmF1bHQ7XG4gICAgICAgICAgICBwcm90b2NvbHMuYWxpID0gcmVxdWlyZSgnLi9hbGknKS5kZWZhdWx0O1xuICAgICAgICAgICAgcHJvdG9jb2xzLmFsaXMgPSByZXF1aXJlKCcuL2FsaScpLmRlZmF1bHQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFwcm90b2NvbHNbb3B0cy5wcm90b2NvbF0pIHtcbiAgICAgICAgY29uc3QgaXNTZWN1cmUgPSBbJ21xdHRzJywgJ3dzcyddLmluZGV4T2Yob3B0cy5wcm90b2NvbCkgIT09IC0xO1xuICAgICAgICBvcHRzLnByb3RvY29sID0gW1xuICAgICAgICAgICAgJ21xdHQnLFxuICAgICAgICAgICAgJ21xdHRzJyxcbiAgICAgICAgICAgICd3cycsXG4gICAgICAgICAgICAnd3NzJyxcbiAgICAgICAgICAgICd3eCcsXG4gICAgICAgICAgICAnd3hzJyxcbiAgICAgICAgICAgICdhbGknLFxuICAgICAgICAgICAgJ2FsaXMnLFxuICAgICAgICBdLmZpbHRlcigoa2V5LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgaWYgKGlzU2VjdXJlICYmIGluZGV4ICUgMiA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgcHJvdG9jb2xzW2tleV0gPT09ICdmdW5jdGlvbic7XG4gICAgICAgIH0pWzBdO1xuICAgIH1cbiAgICBpZiAob3B0cy5jbGVhbiA9PT0gZmFsc2UgJiYgIW9wdHMuY2xpZW50SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNsaWVudElkIGZvciB1bmNsZWFuIGNsaWVudHMnKTtcbiAgICB9XG4gICAgaWYgKG9wdHMucHJvdG9jb2wpIHtcbiAgICAgICAgb3B0cy5kZWZhdWx0UHJvdG9jb2wgPSBvcHRzLnByb3RvY29sO1xuICAgIH1cbiAgICBmdW5jdGlvbiB3cmFwcGVyKGNsaWVudCkge1xuICAgICAgICBpZiAob3B0cy5zZXJ2ZXJzKSB7XG4gICAgICAgICAgICBpZiAoIWNsaWVudC5fcmVjb25uZWN0Q291bnQgfHxcbiAgICAgICAgICAgICAgICBjbGllbnQuX3JlY29ubmVjdENvdW50ID09PSBvcHRzLnNlcnZlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2xpZW50Ll9yZWNvbm5lY3RDb3VudCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcHRzLmhvc3QgPSBvcHRzLnNlcnZlcnNbY2xpZW50Ll9yZWNvbm5lY3RDb3VudF0uaG9zdDtcbiAgICAgICAgICAgIG9wdHMucG9ydCA9IG9wdHMuc2VydmVyc1tjbGllbnQuX3JlY29ubmVjdENvdW50XS5wb3J0O1xuICAgICAgICAgICAgb3B0cy5wcm90b2NvbCA9ICFvcHRzLnNlcnZlcnNbY2xpZW50Ll9yZWNvbm5lY3RDb3VudF0ucHJvdG9jb2xcbiAgICAgICAgICAgICAgICA/IG9wdHMuZGVmYXVsdFByb3RvY29sXG4gICAgICAgICAgICAgICAgOiBvcHRzLnNlcnZlcnNbY2xpZW50Ll9yZWNvbm5lY3RDb3VudF0ucHJvdG9jb2w7XG4gICAgICAgICAgICBvcHRzLmhvc3RuYW1lID0gb3B0cy5ob3N0O1xuICAgICAgICAgICAgY2xpZW50Ll9yZWNvbm5lY3RDb3VudCsrO1xuICAgICAgICB9XG4gICAgICAgIGRlYnVnKCdjYWxsaW5nIHN0cmVhbWJ1aWxkZXIgZm9yJywgb3B0cy5wcm90b2NvbCk7XG4gICAgICAgIHJldHVybiBwcm90b2NvbHNbb3B0cy5wcm90b2NvbF0oY2xpZW50LCBvcHRzKTtcbiAgICB9XG4gICAgY29uc3QgY2xpZW50ID0gbmV3IGNsaWVudF8xLmRlZmF1bHQod3JhcHBlciwgb3B0cyk7XG4gICAgY2xpZW50Lm9uKCdlcnJvcicsICgpID0+IHtcbiAgICB9KTtcbiAgICByZXR1cm4gY2xpZW50O1xufVxuZnVuY3Rpb24gY29ubmVjdEFzeW5jKGJyb2tlclVybCwgb3B0cywgYWxsb3dSZXRyaWVzID0gdHJ1ZSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IGNsaWVudCA9IGNvbm5lY3QoYnJva2VyVXJsLCBvcHRzKTtcbiAgICAgICAgY29uc3QgcHJvbWlzZVJlc29sdXRpb25MaXN0ZW5lcnMgPSB7XG4gICAgICAgICAgICBjb25uZWN0OiAoY29ubmFjaykgPT4ge1xuICAgICAgICAgICAgICAgIHJlbW92ZVByb21pc2VSZXNvbHV0aW9uTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShjbGllbnQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVuZDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlbW92ZVByb21pc2VSZXNvbHV0aW9uTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShjbGllbnQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiAoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZVJlc29sdXRpb25MaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgICAgICBjbGllbnQuZW5kKCk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICBpZiAoYWxsb3dSZXRyaWVzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcHJvbWlzZVJlc29sdXRpb25MaXN0ZW5lcnMuY2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZVJlc29sdXRpb25MaXN0ZW5lcnMuZXJyb3IobmV3IEVycm9yKFwiQ291bGRuJ3QgY29ubmVjdCB0byBzZXJ2ZXJcIikpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZW1vdmVQcm9taXNlUmVzb2x1dGlvbkxpc3RlbmVycygpIHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHByb21pc2VSZXNvbHV0aW9uTGlzdGVuZXJzKS5mb3JFYWNoKChldmVudE5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICBjbGllbnQub2ZmKGV2ZW50TmFtZSwgcHJvbWlzZVJlc29sdXRpb25MaXN0ZW5lcnNbZXZlbnROYW1lXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3Qua2V5cyhwcm9taXNlUmVzb2x1dGlvbkxpc3RlbmVycykuZm9yRWFjaCgoZXZlbnROYW1lKSA9PiB7XG4gICAgICAgICAgICBjbGllbnQub24oZXZlbnROYW1lLCBwcm9taXNlUmVzb2x1dGlvbkxpc3RlbmVyc1tldmVudE5hbWVdKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmRlZmF1bHQgPSBjb25uZWN0O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/connect/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/connect/socks.js":
/*!******************************************************!*\
  !*** ./node_modules/mqtt/build/lib/connect/socks.js ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports[\"default\"] = openSocks;\nconst debug_1 = __importDefault(__webpack_require__(/*! debug */ \"(ssr)/./node_modules/debug/src/index.js\"));\nconst stream_1 = __webpack_require__(/*! stream */ \"stream\");\nconst socks_1 = __webpack_require__(/*! socks */ \"(ssr)/./node_modules/socks/build/index.js\");\nconst dns = __importStar(__webpack_require__(/*! dns */ \"dns\"));\nconst util_1 = __webpack_require__(/*! util */ \"util\");\nconst assert_1 = __importDefault(__webpack_require__(/*! assert */ \"assert\"));\nconst debug = (0, debug_1.default)('mqttjs:socks');\nclass ProxyStream extends stream_1.Duplex {\n    _flowing = false;\n    _socket;\n    constructor() {\n        super({ autoDestroy: false });\n        this.cork();\n    }\n    _start(socket) {\n        debug('proxy stream started');\n        (0, assert_1.default)(!this._socket);\n        if (this.destroyed) {\n            socket.destroy(this.errored);\n            return;\n        }\n        this._socket = socket;\n        if (!this._flowing)\n            socket.pause();\n        socket.on('data', this._onData);\n        socket.on('end', this._onEnd);\n        socket.on('error', this._onError);\n        socket.on('close', this._onClose);\n        socket.emit('connect');\n        this.uncork();\n    }\n    _write(chunk, encoding, callback) {\n        (0, assert_1.default)(this._socket);\n        this._socket.write(chunk, callback);\n    }\n    _read(size) {\n        this._flowing = true;\n        this._socket?.resume?.();\n    }\n    _destroy(error, callback) {\n        this._socket?.destroy?.(error);\n        callback(error);\n    }\n    _onData = (chunk) => {\n        (0, assert_1.default)(this._socket);\n        this._flowing = this.push(chunk);\n        if (!this._flowing)\n            this._socket.pause();\n    };\n    _onEnd = () => {\n        debug('proxy stream received EOF');\n        this.push(null);\n    };\n    _onClose = () => {\n        debug('proxy stream closed');\n        this.destroy();\n    };\n    _onError = (err) => {\n        debug('proxy stream died with error %s', err);\n        this.destroy(err);\n    };\n}\nfunction fatal(e) {\n    try {\n        if (e.code === undefined)\n            e.code = 'SOCKS';\n        return e;\n    }\n    catch {\n        return e;\n    }\n}\nfunction typeFromProtocol(proto) {\n    switch (proto) {\n        case 'socks5h:':\n            return [5, true];\n        case 'socks4a:':\n            return [4, true];\n        case 'socks5:':\n            return [5, false];\n        case 'socks4:':\n            return [4, false];\n        default:\n            return [undefined, false];\n    }\n}\nfunction parseSocksUrl(url) {\n    const parsedUrl = new URL(url);\n    if (parsedUrl.pathname || parsedUrl.hash || parsedUrl.search) {\n        throw fatal(new Error('bad SOCKS URL'));\n    }\n    const [type, resolveThroughProxy] = typeFromProtocol(parsedUrl.protocol);\n    if (!type) {\n        throw fatal(new Error('bad SOCKS URL: invalid protocol'));\n    }\n    const port = parseInt(parsedUrl.port, 10);\n    if (Number.isNaN(port)) {\n        throw fatal(new Error('bad SOCKS URL: invalid port'));\n    }\n    const proxy = {\n        host: parsedUrl.hostname,\n        port,\n        type,\n    };\n    return [proxy, resolveThroughProxy];\n}\nasync function connectSocks(destinationHost, destinationPort, socksUrl, stream, options = {}) {\n    const lookup = options.lookup ?? (0, util_1.promisify)(dns.lookup);\n    const [proxy, resolveThroughProxy] = parseSocksUrl(socksUrl);\n    if (!resolveThroughProxy) {\n        debug('resolving %s locally', destinationHost);\n        destinationHost = (await lookup(destinationHost, {\n            family: proxy.type === 4 ? 4 : 0,\n        })).address;\n    }\n    debug('establishing SOCKS%d connection to %s:%d via %s:%d', proxy.type, destinationHost, destinationPort, proxy.host, proxy.port);\n    const socksClient = new socks_1.SocksClient({\n        command: 'connect',\n        destination: {\n            host: destinationHost,\n            port: destinationPort,\n        },\n        proxy: { ...proxy },\n        timeout: options.timeout,\n    });\n    socksClient.connect();\n    socksClient.on('established', ({ socket }) => stream._start(socket));\n    socksClient.on('error', (e) => {\n        debug('SOCKS failed: %s', e);\n        stream.destroy(fatal(e));\n    });\n}\nfunction openSocks(destinationHost, destinationPort, socksUrl, options) {\n    debug('SOCKS connection to %s:%d via %s', destinationHost, destinationPort, socksUrl);\n    const stream = new ProxyStream();\n    connectSocks(destinationHost, destinationPort, socksUrl, stream, options).catch((e) => {\n        debug('SOCKS failed: %s', e);\n        stream.destroy(e);\n    });\n    return stream;\n}\n//# sourceMappingURL=socks.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC9zb2Nrcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxvQ0FBb0M7QUFDbkQ7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMENBQTBDLDRCQUE0QjtBQUN0RSxDQUFDO0FBQ0Q7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELGNBQWM7QUFDekU7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGtCQUFlO0FBQ2YsZ0NBQWdDLG1CQUFPLENBQUMsc0RBQU87QUFDL0MsaUJBQWlCLG1CQUFPLENBQUMsc0JBQVE7QUFDakMsZ0JBQWdCLG1CQUFPLENBQUMsd0RBQU87QUFDL0IseUJBQXlCLG1CQUFPLENBQUMsZ0JBQUs7QUFDdEMsZUFBZSxtQkFBTyxDQUFDLGtCQUFNO0FBQzdCLGlDQUFpQyxtQkFBTyxDQUFDLHNCQUFRO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isb0JBQW9CO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEZBQTRGO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxpQkFBaUIsVUFBVTtBQUMzQjtBQUNBLEtBQUs7QUFDTDtBQUNBLHFDQUFxQyxRQUFRO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL2Nvbm5lY3Qvc29ja3MuanM/YzJhYSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3duS2V5cyA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgICAgb3duS2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICB2YXIgYXIgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gbykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBrKSkgYXJbYXIubGVuZ3RoXSA9IGs7XG4gICAgICAgICAgICByZXR1cm4gYXI7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvd25LZXlzKG8pO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgPSBvd25LZXlzKG1vZCksIGkgPSAwOyBpIDwgay5sZW5ndGg7IGkrKykgaWYgKGtbaV0gIT09IFwiZGVmYXVsdFwiKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGtbaV0pO1xuICAgICAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG59KSgpO1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gb3BlblNvY2tzO1xuY29uc3QgZGVidWdfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiZGVidWdcIikpO1xuY29uc3Qgc3RyZWFtXzEgPSByZXF1aXJlKFwic3RyZWFtXCIpO1xuY29uc3Qgc29ja3NfMSA9IHJlcXVpcmUoXCJzb2Nrc1wiKTtcbmNvbnN0IGRucyA9IF9faW1wb3J0U3RhcihyZXF1aXJlKFwiZG5zXCIpKTtcbmNvbnN0IHV0aWxfMSA9IHJlcXVpcmUoXCJ1dGlsXCIpO1xuY29uc3QgYXNzZXJ0XzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcImFzc2VydFwiKSk7XG5jb25zdCBkZWJ1ZyA9ICgwLCBkZWJ1Z18xLmRlZmF1bHQpKCdtcXR0anM6c29ja3MnKTtcbmNsYXNzIFByb3h5U3RyZWFtIGV4dGVuZHMgc3RyZWFtXzEuRHVwbGV4IHtcbiAgICBfZmxvd2luZyA9IGZhbHNlO1xuICAgIF9zb2NrZXQ7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKHsgYXV0b0Rlc3Ryb3k6IGZhbHNlIH0pO1xuICAgICAgICB0aGlzLmNvcmsoKTtcbiAgICB9XG4gICAgX3N0YXJ0KHNvY2tldCkge1xuICAgICAgICBkZWJ1ZygncHJveHkgc3RyZWFtIHN0YXJ0ZWQnKTtcbiAgICAgICAgKDAsIGFzc2VydF8xLmRlZmF1bHQpKCF0aGlzLl9zb2NrZXQpO1xuICAgICAgICBpZiAodGhpcy5kZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHNvY2tldC5kZXN0cm95KHRoaXMuZXJyb3JlZCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc29ja2V0ID0gc29ja2V0O1xuICAgICAgICBpZiAoIXRoaXMuX2Zsb3dpbmcpXG4gICAgICAgICAgICBzb2NrZXQucGF1c2UoKTtcbiAgICAgICAgc29ja2V0Lm9uKCdkYXRhJywgdGhpcy5fb25EYXRhKTtcbiAgICAgICAgc29ja2V0Lm9uKCdlbmQnLCB0aGlzLl9vbkVuZCk7XG4gICAgICAgIHNvY2tldC5vbignZXJyb3InLCB0aGlzLl9vbkVycm9yKTtcbiAgICAgICAgc29ja2V0Lm9uKCdjbG9zZScsIHRoaXMuX29uQ2xvc2UpO1xuICAgICAgICBzb2NrZXQuZW1pdCgnY29ubmVjdCcpO1xuICAgICAgICB0aGlzLnVuY29yaygpO1xuICAgIH1cbiAgICBfd3JpdGUoY2h1bmssIGVuY29kaW5nLCBjYWxsYmFjaykge1xuICAgICAgICAoMCwgYXNzZXJ0XzEuZGVmYXVsdCkodGhpcy5fc29ja2V0KTtcbiAgICAgICAgdGhpcy5fc29ja2V0LndyaXRlKGNodW5rLCBjYWxsYmFjayk7XG4gICAgfVxuICAgIF9yZWFkKHNpemUpIHtcbiAgICAgICAgdGhpcy5fZmxvd2luZyA9IHRydWU7XG4gICAgICAgIHRoaXMuX3NvY2tldD8ucmVzdW1lPy4oKTtcbiAgICB9XG4gICAgX2Rlc3Ryb3koZXJyb3IsIGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX3NvY2tldD8uZGVzdHJveT8uKGVycm9yKTtcbiAgICAgICAgY2FsbGJhY2soZXJyb3IpO1xuICAgIH1cbiAgICBfb25EYXRhID0gKGNodW5rKSA9PiB7XG4gICAgICAgICgwLCBhc3NlcnRfMS5kZWZhdWx0KSh0aGlzLl9zb2NrZXQpO1xuICAgICAgICB0aGlzLl9mbG93aW5nID0gdGhpcy5wdXNoKGNodW5rKTtcbiAgICAgICAgaWYgKCF0aGlzLl9mbG93aW5nKVxuICAgICAgICAgICAgdGhpcy5fc29ja2V0LnBhdXNlKCk7XG4gICAgfTtcbiAgICBfb25FbmQgPSAoKSA9PiB7XG4gICAgICAgIGRlYnVnKCdwcm94eSBzdHJlYW0gcmVjZWl2ZWQgRU9GJyk7XG4gICAgICAgIHRoaXMucHVzaChudWxsKTtcbiAgICB9O1xuICAgIF9vbkNsb3NlID0gKCkgPT4ge1xuICAgICAgICBkZWJ1ZygncHJveHkgc3RyZWFtIGNsb3NlZCcpO1xuICAgICAgICB0aGlzLmRlc3Ryb3koKTtcbiAgICB9O1xuICAgIF9vbkVycm9yID0gKGVycikgPT4ge1xuICAgICAgICBkZWJ1ZygncHJveHkgc3RyZWFtIGRpZWQgd2l0aCBlcnJvciAlcycsIGVycik7XG4gICAgICAgIHRoaXMuZGVzdHJveShlcnIpO1xuICAgIH07XG59XG5mdW5jdGlvbiBmYXRhbChlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKGUuY29kZSA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgZS5jb2RlID0gJ1NPQ0tTJztcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIGNhdGNoIHtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxufVxuZnVuY3Rpb24gdHlwZUZyb21Qcm90b2NvbChwcm90bykge1xuICAgIHN3aXRjaCAocHJvdG8pIHtcbiAgICAgICAgY2FzZSAnc29ja3M1aDonOlxuICAgICAgICAgICAgcmV0dXJuIFs1LCB0cnVlXTtcbiAgICAgICAgY2FzZSAnc29ja3M0YTonOlxuICAgICAgICAgICAgcmV0dXJuIFs0LCB0cnVlXTtcbiAgICAgICAgY2FzZSAnc29ja3M1Oic6XG4gICAgICAgICAgICByZXR1cm4gWzUsIGZhbHNlXTtcbiAgICAgICAgY2FzZSAnc29ja3M0Oic6XG4gICAgICAgICAgICByZXR1cm4gWzQsIGZhbHNlXTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBbdW5kZWZpbmVkLCBmYWxzZV07XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VTb2Nrc1VybCh1cmwpIHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgaWYgKHBhcnNlZFVybC5wYXRobmFtZSB8fCBwYXJzZWRVcmwuaGFzaCB8fCBwYXJzZWRVcmwuc2VhcmNoKSB7XG4gICAgICAgIHRocm93IGZhdGFsKG5ldyBFcnJvcignYmFkIFNPQ0tTIFVSTCcpKTtcbiAgICB9XG4gICAgY29uc3QgW3R5cGUsIHJlc29sdmVUaHJvdWdoUHJveHldID0gdHlwZUZyb21Qcm90b2NvbChwYXJzZWRVcmwucHJvdG9jb2wpO1xuICAgIGlmICghdHlwZSkge1xuICAgICAgICB0aHJvdyBmYXRhbChuZXcgRXJyb3IoJ2JhZCBTT0NLUyBVUkw6IGludmFsaWQgcHJvdG9jb2wnKSk7XG4gICAgfVxuICAgIGNvbnN0IHBvcnQgPSBwYXJzZUludChwYXJzZWRVcmwucG9ydCwgMTApO1xuICAgIGlmIChOdW1iZXIuaXNOYU4ocG9ydCkpIHtcbiAgICAgICAgdGhyb3cgZmF0YWwobmV3IEVycm9yKCdiYWQgU09DS1MgVVJMOiBpbnZhbGlkIHBvcnQnKSk7XG4gICAgfVxuICAgIGNvbnN0IHByb3h5ID0ge1xuICAgICAgICBob3N0OiBwYXJzZWRVcmwuaG9zdG5hbWUsXG4gICAgICAgIHBvcnQsXG4gICAgICAgIHR5cGUsXG4gICAgfTtcbiAgICByZXR1cm4gW3Byb3h5LCByZXNvbHZlVGhyb3VnaFByb3h5XTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RTb2NrcyhkZXN0aW5hdGlvbkhvc3QsIGRlc3RpbmF0aW9uUG9ydCwgc29ja3NVcmwsIHN0cmVhbSwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgbG9va3VwID0gb3B0aW9ucy5sb29rdXAgPz8gKDAsIHV0aWxfMS5wcm9taXNpZnkpKGRucy5sb29rdXApO1xuICAgIGNvbnN0IFtwcm94eSwgcmVzb2x2ZVRocm91Z2hQcm94eV0gPSBwYXJzZVNvY2tzVXJsKHNvY2tzVXJsKTtcbiAgICBpZiAoIXJlc29sdmVUaHJvdWdoUHJveHkpIHtcbiAgICAgICAgZGVidWcoJ3Jlc29sdmluZyAlcyBsb2NhbGx5JywgZGVzdGluYXRpb25Ib3N0KTtcbiAgICAgICAgZGVzdGluYXRpb25Ib3N0ID0gKGF3YWl0IGxvb2t1cChkZXN0aW5hdGlvbkhvc3QsIHtcbiAgICAgICAgICAgIGZhbWlseTogcHJveHkudHlwZSA9PT0gNCA/IDQgOiAwLFxuICAgICAgICB9KSkuYWRkcmVzcztcbiAgICB9XG4gICAgZGVidWcoJ2VzdGFibGlzaGluZyBTT0NLUyVkIGNvbm5lY3Rpb24gdG8gJXM6JWQgdmlhICVzOiVkJywgcHJveHkudHlwZSwgZGVzdGluYXRpb25Ib3N0LCBkZXN0aW5hdGlvblBvcnQsIHByb3h5Lmhvc3QsIHByb3h5LnBvcnQpO1xuICAgIGNvbnN0IHNvY2tzQ2xpZW50ID0gbmV3IHNvY2tzXzEuU29ja3NDbGllbnQoe1xuICAgICAgICBjb21tYW5kOiAnY29ubmVjdCcsXG4gICAgICAgIGRlc3RpbmF0aW9uOiB7XG4gICAgICAgICAgICBob3N0OiBkZXN0aW5hdGlvbkhvc3QsXG4gICAgICAgICAgICBwb3J0OiBkZXN0aW5hdGlvblBvcnQsXG4gICAgICAgIH0sXG4gICAgICAgIHByb3h5OiB7IC4uLnByb3h5IH0sXG4gICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dCxcbiAgICB9KTtcbiAgICBzb2Nrc0NsaWVudC5jb25uZWN0KCk7XG4gICAgc29ja3NDbGllbnQub24oJ2VzdGFibGlzaGVkJywgKHsgc29ja2V0IH0pID0+IHN0cmVhbS5fc3RhcnQoc29ja2V0KSk7XG4gICAgc29ja3NDbGllbnQub24oJ2Vycm9yJywgKGUpID0+IHtcbiAgICAgICAgZGVidWcoJ1NPQ0tTIGZhaWxlZDogJXMnLCBlKTtcbiAgICAgICAgc3RyZWFtLmRlc3Ryb3koZmF0YWwoZSkpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gb3BlblNvY2tzKGRlc3RpbmF0aW9uSG9zdCwgZGVzdGluYXRpb25Qb3J0LCBzb2Nrc1VybCwgb3B0aW9ucykge1xuICAgIGRlYnVnKCdTT0NLUyBjb25uZWN0aW9uIHRvICVzOiVkIHZpYSAlcycsIGRlc3RpbmF0aW9uSG9zdCwgZGVzdGluYXRpb25Qb3J0LCBzb2Nrc1VybCk7XG4gICAgY29uc3Qgc3RyZWFtID0gbmV3IFByb3h5U3RyZWFtKCk7XG4gICAgY29ubmVjdFNvY2tzKGRlc3RpbmF0aW9uSG9zdCwgZGVzdGluYXRpb25Qb3J0LCBzb2Nrc1VybCwgc3RyZWFtLCBvcHRpb25zKS5jYXRjaCgoZSkgPT4ge1xuICAgICAgICBkZWJ1ZygnU09DS1MgZmFpbGVkOiAlcycsIGUpO1xuICAgICAgICBzdHJlYW0uZGVzdHJveShlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gc3RyZWFtO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c29ja3MuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/connect/socks.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/connect/tcp.js":
/*!****************************************************!*\
  !*** ./node_modules/mqtt/build/lib/connect/tcp.js ***!
  \****************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst net_1 = __importDefault(__webpack_require__(/*! net */ \"net\"));\nconst debug_1 = __importDefault(__webpack_require__(/*! debug */ \"(ssr)/./node_modules/debug/src/index.js\"));\nconst socks_1 = __importDefault(__webpack_require__(/*! ./socks */ \"(ssr)/./node_modules/mqtt/build/lib/connect/socks.js\"));\nconst debug = (0, debug_1.default)('mqttjs:tcp');\nconst buildStream = (client, opts) => {\n    opts.port = opts.port || 1883;\n    opts.hostname = opts.hostname || opts.host || 'localhost';\n    if (opts.socksProxy) {\n        return (0, socks_1.default)(opts.hostname, opts.port, opts.socksProxy, {\n            timeout: opts.socksTimeout,\n        });\n    }\n    const { port, path } = opts;\n    const host = opts.hostname;\n    debug('port %d and host %s', port, host);\n    return net_1.default.createConnection({ port, host, path });\n};\nexports[\"default\"] = buildStream;\n//# sourceMappingURL=tcp.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC90Y3AuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYjtBQUNBLDZDQUE2QztBQUM3QztBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCw4QkFBOEIsbUJBQU8sQ0FBQyxnQkFBSztBQUMzQyxnQ0FBZ0MsbUJBQU8sQ0FBQyxzREFBTztBQUMvQyxnQ0FBZ0MsbUJBQU8sQ0FBQyxxRUFBUztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFlBQVksYUFBYTtBQUN6QjtBQUNBO0FBQ0EsNENBQTRDLGtCQUFrQjtBQUM5RDtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL2Nvbm5lY3QvdGNwLmpzPzViZGQiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCBuZXRfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwibmV0XCIpKTtcbmNvbnN0IGRlYnVnXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcImRlYnVnXCIpKTtcbmNvbnN0IHNvY2tzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vc29ja3NcIikpO1xuY29uc3QgZGVidWcgPSAoMCwgZGVidWdfMS5kZWZhdWx0KSgnbXF0dGpzOnRjcCcpO1xuY29uc3QgYnVpbGRTdHJlYW0gPSAoY2xpZW50LCBvcHRzKSA9PiB7XG4gICAgb3B0cy5wb3J0ID0gb3B0cy5wb3J0IHx8IDE4ODM7XG4gICAgb3B0cy5ob3N0bmFtZSA9IG9wdHMuaG9zdG5hbWUgfHwgb3B0cy5ob3N0IHx8ICdsb2NhbGhvc3QnO1xuICAgIGlmIChvcHRzLnNvY2tzUHJveHkpIHtcbiAgICAgICAgcmV0dXJuICgwLCBzb2Nrc18xLmRlZmF1bHQpKG9wdHMuaG9zdG5hbWUsIG9wdHMucG9ydCwgb3B0cy5zb2Nrc1Byb3h5LCB7XG4gICAgICAgICAgICB0aW1lb3V0OiBvcHRzLnNvY2tzVGltZW91dCxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgcG9ydCwgcGF0aCB9ID0gb3B0cztcbiAgICBjb25zdCBob3N0ID0gb3B0cy5ob3N0bmFtZTtcbiAgICBkZWJ1ZygncG9ydCAlZCBhbmQgaG9zdCAlcycsIHBvcnQsIGhvc3QpO1xuICAgIHJldHVybiBuZXRfMS5kZWZhdWx0LmNyZWF0ZUNvbm5lY3Rpb24oeyBwb3J0LCBob3N0LCBwYXRoIH0pO1xufTtcbmV4cG9ydHMuZGVmYXVsdCA9IGJ1aWxkU3RyZWFtO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGNwLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/connect/tcp.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/connect/tls.js":
/*!****************************************************!*\
  !*** ./node_modules/mqtt/build/lib/connect/tls.js ***!
  \****************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst tls_1 = __webpack_require__(/*! tls */ \"tls\");\nconst net_1 = __importDefault(__webpack_require__(/*! net */ \"net\"));\nconst debug_1 = __importDefault(__webpack_require__(/*! debug */ \"(ssr)/./node_modules/debug/src/index.js\"));\nconst socks_1 = __importDefault(__webpack_require__(/*! ./socks */ \"(ssr)/./node_modules/mqtt/build/lib/connect/socks.js\"));\nconst debug = (0, debug_1.default)('mqttjs:tls');\nfunction connect(opts) {\n    const { host, port, socksProxy, ...rest } = opts;\n    if (socksProxy !== undefined) {\n        const socket = (0, socks_1.default)(host, port, socksProxy, {\n            timeout: opts.socksTimeout,\n        });\n        return (0, tls_1.connect)({\n            ...rest,\n            socket,\n        });\n    }\n    return (0, tls_1.connect)(opts);\n}\nconst buildStream = (client, opts) => {\n    opts.port = opts.port || 8883;\n    opts.host = opts.hostname || opts.host || 'localhost';\n    if (net_1.default.isIP(opts.host) === 0) {\n        opts.servername = opts.host;\n    }\n    opts.rejectUnauthorized = opts.rejectUnauthorized !== false;\n    delete opts.path;\n    debug('port %d host %s rejectUnauthorized %b', opts.port, opts.host, opts.rejectUnauthorized);\n    const connection = connect(opts);\n    connection.on('secureConnect', () => {\n        if (opts.rejectUnauthorized && !connection.authorized) {\n            connection.emit('error', new Error('TLS not authorized'));\n        }\n        else {\n            connection.removeListener('error', handleTLSerrors);\n        }\n    });\n    function handleTLSerrors(err) {\n        if (opts.rejectUnauthorized) {\n            client.emit('error', err);\n        }\n        connection.end();\n    }\n    connection.on('error', handleTLSerrors);\n    return connection;\n};\nexports[\"default\"] = buildStream;\n//# sourceMappingURL=tls.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC90bHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYjtBQUNBLDZDQUE2QztBQUM3QztBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxjQUFjLG1CQUFPLENBQUMsZ0JBQUs7QUFDM0IsOEJBQThCLG1CQUFPLENBQUMsZ0JBQUs7QUFDM0MsZ0NBQWdDLG1CQUFPLENBQUMsc0RBQU87QUFDL0MsZ0NBQWdDLG1CQUFPLENBQUMscUVBQVM7QUFDakQ7QUFDQTtBQUNBLFlBQVksa0NBQWtDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBZTtBQUNmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29sZC1zdG9yYWdlLXN5c3RlbS8uL25vZGVfbW9kdWxlcy9tcXR0L2J1aWxkL2xpYi9jb25uZWN0L3Rscy5qcz9iOGIzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgdGxzXzEgPSByZXF1aXJlKFwidGxzXCIpO1xuY29uc3QgbmV0XzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIm5ldFwiKSk7XG5jb25zdCBkZWJ1Z18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJkZWJ1Z1wiKSk7XG5jb25zdCBzb2Nrc18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL3NvY2tzXCIpKTtcbmNvbnN0IGRlYnVnID0gKDAsIGRlYnVnXzEuZGVmYXVsdCkoJ21xdHRqczp0bHMnKTtcbmZ1bmN0aW9uIGNvbm5lY3Qob3B0cykge1xuICAgIGNvbnN0IHsgaG9zdCwgcG9ydCwgc29ja3NQcm94eSwgLi4ucmVzdCB9ID0gb3B0cztcbiAgICBpZiAoc29ja3NQcm94eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IHNvY2tldCA9ICgwLCBzb2Nrc18xLmRlZmF1bHQpKGhvc3QsIHBvcnQsIHNvY2tzUHJveHksIHtcbiAgICAgICAgICAgIHRpbWVvdXQ6IG9wdHMuc29ja3NUaW1lb3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICgwLCB0bHNfMS5jb25uZWN0KSh7XG4gICAgICAgICAgICAuLi5yZXN0LFxuICAgICAgICAgICAgc29ja2V0LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuICgwLCB0bHNfMS5jb25uZWN0KShvcHRzKTtcbn1cbmNvbnN0IGJ1aWxkU3RyZWFtID0gKGNsaWVudCwgb3B0cykgPT4ge1xuICAgIG9wdHMucG9ydCA9IG9wdHMucG9ydCB8fCA4ODgzO1xuICAgIG9wdHMuaG9zdCA9IG9wdHMuaG9zdG5hbWUgfHwgb3B0cy5ob3N0IHx8ICdsb2NhbGhvc3QnO1xuICAgIGlmIChuZXRfMS5kZWZhdWx0LmlzSVAob3B0cy5ob3N0KSA9PT0gMCkge1xuICAgICAgICBvcHRzLnNlcnZlcm5hbWUgPSBvcHRzLmhvc3Q7XG4gICAgfVxuICAgIG9wdHMucmVqZWN0VW5hdXRob3JpemVkID0gb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQgIT09IGZhbHNlO1xuICAgIGRlbGV0ZSBvcHRzLnBhdGg7XG4gICAgZGVidWcoJ3BvcnQgJWQgaG9zdCAlcyByZWplY3RVbmF1dGhvcml6ZWQgJWInLCBvcHRzLnBvcnQsIG9wdHMuaG9zdCwgb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQpO1xuICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBjb25uZWN0KG9wdHMpO1xuICAgIGNvbm5lY3Rpb24ub24oJ3NlY3VyZUNvbm5lY3QnLCAoKSA9PiB7XG4gICAgICAgIGlmIChvcHRzLnJlamVjdFVuYXV0aG9yaXplZCAmJiAhY29ubmVjdGlvbi5hdXRob3JpemVkKSB7XG4gICAgICAgICAgICBjb25uZWN0aW9uLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdUTFMgbm90IGF1dGhvcml6ZWQnKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25uZWN0aW9uLnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIGhhbmRsZVRMU2Vycm9ycyk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBmdW5jdGlvbiBoYW5kbGVUTFNlcnJvcnMoZXJyKSB7XG4gICAgICAgIGlmIChvcHRzLnJlamVjdFVuYXV0aG9yaXplZCkge1xuICAgICAgICAgICAgY2xpZW50LmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICAgICAgfVxuICAgICAgICBjb25uZWN0aW9uLmVuZCgpO1xuICAgIH1cbiAgICBjb25uZWN0aW9uLm9uKCdlcnJvcicsIGhhbmRsZVRMU2Vycm9ycyk7XG4gICAgcmV0dXJuIGNvbm5lY3Rpb247XG59O1xuZXhwb3J0cy5kZWZhdWx0ID0gYnVpbGRTdHJlYW07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10bHMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/connect/tls.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/connect/ws.js":
/*!***************************************************!*\
  !*** ./node_modules/mqtt/build/lib/connect/ws.js ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.streamBuilder = exports.browserStreamBuilder = void 0;\nconst buffer_1 = __webpack_require__(/*! buffer */ \"buffer\");\nconst ws_1 = __importDefault(__webpack_require__(/*! ws */ \"(ssr)/./node_modules/ws/index.js\"));\nconst debug_1 = __importDefault(__webpack_require__(/*! debug */ \"(ssr)/./node_modules/debug/src/index.js\"));\nconst readable_stream_1 = __webpack_require__(/*! readable-stream */ \"(ssr)/./node_modules/readable-stream/lib/ours/index.js\");\nconst is_browser_1 = __importDefault(__webpack_require__(/*! ../is-browser */ \"(ssr)/./node_modules/mqtt/build/lib/is-browser.js\"));\nconst BufferedDuplex_1 = __webpack_require__(/*! ../BufferedDuplex */ \"(ssr)/./node_modules/mqtt/build/lib/BufferedDuplex.js\");\nconst debug = (0, debug_1.default)('mqttjs:ws');\nconst WSS_OPTIONS = [\n    'rejectUnauthorized',\n    'ca',\n    'cert',\n    'key',\n    'pfx',\n    'passphrase',\n];\nfunction buildUrl(opts, client) {\n    let url = `${opts.protocol}://${opts.hostname}:${opts.port}${opts.path}`;\n    if (typeof opts.transformWsUrl === 'function') {\n        url = opts.transformWsUrl(url, opts, client);\n    }\n    return url;\n}\nfunction setDefaultOpts(opts) {\n    const options = opts;\n    if (!opts.port) {\n        if (opts.protocol === 'wss') {\n            options.port = 443;\n        }\n        else {\n            options.port = 80;\n        }\n    }\n    if (!opts.path) {\n        options.path = '/';\n    }\n    if (!opts.wsOptions) {\n        options.wsOptions = {};\n    }\n    if (!is_browser_1.default && !opts.forceNativeWebSocket && opts.protocol === 'wss') {\n        WSS_OPTIONS.forEach((prop) => {\n            if (Object.prototype.hasOwnProperty.call(opts, prop) &&\n                !Object.prototype.hasOwnProperty.call(opts.wsOptions, prop)) {\n                options.wsOptions[prop] = opts[prop];\n            }\n        });\n    }\n    return options;\n}\nfunction setDefaultBrowserOpts(opts) {\n    const options = setDefaultOpts(opts);\n    if (!options.hostname) {\n        options.hostname = options.host;\n    }\n    if (!options.hostname) {\n        if (typeof document === 'undefined') {\n            throw new Error('Could not determine host. Specify host manually.');\n        }\n        const parsed = new URL(document.URL);\n        options.hostname = parsed.hostname;\n        if (!options.port) {\n            options.port = Number(parsed.port);\n        }\n    }\n    if (options.objectMode === undefined) {\n        options.objectMode = !(options.binary === true || options.binary === undefined);\n    }\n    return options;\n}\nfunction createWebSocket(client, url, opts) {\n    debug('createWebSocket');\n    debug(`protocol: ${opts.protocolId} ${opts.protocolVersion}`);\n    const websocketSubProtocol = opts.protocolId === 'MQIsdp' && opts.protocolVersion === 3\n        ? 'mqttv3.1'\n        : 'mqtt';\n    debug(`creating new Websocket for url: ${url} and protocol: ${websocketSubProtocol}`);\n    let socket;\n    if (opts.createWebsocket) {\n        socket = opts.createWebsocket(url, [websocketSubProtocol], opts);\n    }\n    else {\n        socket = new ws_1.default(url, [websocketSubProtocol], opts.wsOptions);\n    }\n    return socket;\n}\nfunction createBrowserWebSocket(client, opts) {\n    const websocketSubProtocol = opts.protocolId === 'MQIsdp' && opts.protocolVersion === 3\n        ? 'mqttv3.1'\n        : 'mqtt';\n    const url = buildUrl(opts, client);\n    let socket;\n    if (opts.createWebsocket) {\n        socket = opts.createWebsocket(url, [websocketSubProtocol], opts);\n    }\n    else {\n        socket = new WebSocket(url, [websocketSubProtocol]);\n    }\n    socket.binaryType = 'arraybuffer';\n    return socket;\n}\nconst streamBuilder = (client, opts) => {\n    debug('streamBuilder');\n    const options = setDefaultOpts(opts);\n    options.hostname = options.hostname || options.host || 'localhost';\n    const url = buildUrl(options, client);\n    const socket = createWebSocket(client, url, options);\n    const webSocketStream = ws_1.default.createWebSocketStream(socket, options.wsOptions);\n    webSocketStream['url'] = url;\n    socket.on('close', () => {\n        webSocketStream.destroy();\n    });\n    return webSocketStream;\n};\nexports.streamBuilder = streamBuilder;\nconst browserStreamBuilder = (client, opts) => {\n    debug('browserStreamBuilder');\n    let stream;\n    const options = setDefaultBrowserOpts(opts);\n    const bufferSize = options.browserBufferSize || 1024 * 512;\n    const bufferTimeout = opts.browserBufferTimeout || 1000;\n    const coerceToBuffer = !opts.objectMode;\n    const socket = createBrowserWebSocket(client, opts);\n    const proxy = buildProxy(opts, socketWriteBrowser, socketEndBrowser);\n    if (!opts.objectMode) {\n        proxy._writev = BufferedDuplex_1.writev.bind(proxy);\n    }\n    proxy.on('close', () => {\n        socket.close();\n    });\n    const eventListenerSupport = typeof socket.addEventListener !== 'undefined';\n    if (socket.readyState === socket.OPEN) {\n        stream = proxy;\n        stream.socket = socket;\n    }\n    else {\n        stream = new BufferedDuplex_1.BufferedDuplex(opts, proxy, socket);\n        if (eventListenerSupport) {\n            socket.addEventListener('open', onOpen);\n        }\n        else {\n            socket.onopen = onOpen;\n        }\n    }\n    if (eventListenerSupport) {\n        socket.addEventListener('close', onClose);\n        socket.addEventListener('error', onError);\n        socket.addEventListener('message', onMessage);\n    }\n    else {\n        socket.onclose = onClose;\n        socket.onerror = onError;\n        socket.onmessage = onMessage;\n    }\n    function buildProxy(pOptions, socketWrite, socketEnd) {\n        const _proxy = new readable_stream_1.Transform({\n            objectMode: pOptions.objectMode,\n        });\n        _proxy._write = socketWrite;\n        _proxy._flush = socketEnd;\n        return _proxy;\n    }\n    function onOpen() {\n        debug('WebSocket onOpen');\n        if (stream instanceof BufferedDuplex_1.BufferedDuplex) {\n            stream.socketReady();\n        }\n    }\n    function onClose(event) {\n        debug('WebSocket onClose', event);\n        stream.end();\n        stream.destroy();\n    }\n    function onError(err) {\n        debug('WebSocket onError', err);\n        const error = new Error('WebSocket error');\n        error['event'] = err;\n        stream.destroy(error);\n    }\n    async function onMessage(event) {\n        if (!proxy || !proxy.readable || !proxy.writable) {\n            return;\n        }\n        let { data } = event;\n        if (data instanceof ArrayBuffer)\n            data = buffer_1.Buffer.from(data);\n        else if (data instanceof Blob)\n            data = buffer_1.Buffer.from(await new Response(data).arrayBuffer());\n        else\n            data = buffer_1.Buffer.from(data, 'utf8');\n        proxy.push(data);\n    }\n    function socketWriteBrowser(chunk, enc, next) {\n        if (socket.bufferedAmount > bufferSize) {\n            setTimeout(socketWriteBrowser, bufferTimeout, chunk, enc, next);\n            return;\n        }\n        if (coerceToBuffer && typeof chunk === 'string') {\n            chunk = buffer_1.Buffer.from(chunk, 'utf8');\n        }\n        try {\n            socket.send(chunk);\n        }\n        catch (err) {\n            return next(err);\n        }\n        next();\n    }\n    function socketEndBrowser(done) {\n        socket.close();\n        done();\n    }\n    return stream;\n};\nexports.browserStreamBuilder = browserStreamBuilder;\n//# sourceMappingURL=ws.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC93cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHFCQUFxQixHQUFHLDRCQUE0QjtBQUNwRCxpQkFBaUIsbUJBQU8sQ0FBQyxzQkFBUTtBQUNqQyw2QkFBNkIsbUJBQU8sQ0FBQyw0Q0FBSTtBQUN6QyxnQ0FBZ0MsbUJBQU8sQ0FBQyxzREFBTztBQUMvQywwQkFBMEIsbUJBQU8sQ0FBQywrRUFBaUI7QUFDbkQscUNBQXFDLG1CQUFPLENBQUMsd0VBQWU7QUFDNUQseUJBQXlCLG1CQUFPLENBQUMsZ0ZBQW1CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGNBQWMsS0FBSyxjQUFjLEdBQUcsVUFBVSxFQUFFLFVBQVU7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGlCQUFpQixFQUFFLHFCQUFxQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsS0FBSyxnQkFBZ0IscUJBQXFCO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29sZC1zdG9yYWdlLXN5c3RlbS8uL25vZGVfbW9kdWxlcy9tcXR0L2J1aWxkL2xpYi9jb25uZWN0L3dzLmpzPzc2NzgiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLnN0cmVhbUJ1aWxkZXIgPSBleHBvcnRzLmJyb3dzZXJTdHJlYW1CdWlsZGVyID0gdm9pZCAwO1xuY29uc3QgYnVmZmVyXzEgPSByZXF1aXJlKFwiYnVmZmVyXCIpO1xuY29uc3Qgd3NfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwid3NcIikpO1xuY29uc3QgZGVidWdfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiZGVidWdcIikpO1xuY29uc3QgcmVhZGFibGVfc3RyZWFtXzEgPSByZXF1aXJlKFwicmVhZGFibGUtc3RyZWFtXCIpO1xuY29uc3QgaXNfYnJvd3Nlcl8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9pcy1icm93c2VyXCIpKTtcbmNvbnN0IEJ1ZmZlcmVkRHVwbGV4XzEgPSByZXF1aXJlKFwiLi4vQnVmZmVyZWREdXBsZXhcIik7XG5jb25zdCBkZWJ1ZyA9ICgwLCBkZWJ1Z18xLmRlZmF1bHQpKCdtcXR0anM6d3MnKTtcbmNvbnN0IFdTU19PUFRJT05TID0gW1xuICAgICdyZWplY3RVbmF1dGhvcml6ZWQnLFxuICAgICdjYScsXG4gICAgJ2NlcnQnLFxuICAgICdrZXknLFxuICAgICdwZngnLFxuICAgICdwYXNzcGhyYXNlJyxcbl07XG5mdW5jdGlvbiBidWlsZFVybChvcHRzLCBjbGllbnQpIHtcbiAgICBsZXQgdXJsID0gYCR7b3B0cy5wcm90b2NvbH06Ly8ke29wdHMuaG9zdG5hbWV9OiR7b3B0cy5wb3J0fSR7b3B0cy5wYXRofWA7XG4gICAgaWYgKHR5cGVvZiBvcHRzLnRyYW5zZm9ybVdzVXJsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHVybCA9IG9wdHMudHJhbnNmb3JtV3NVcmwodXJsLCBvcHRzLCBjbGllbnQpO1xuICAgIH1cbiAgICByZXR1cm4gdXJsO1xufVxuZnVuY3Rpb24gc2V0RGVmYXVsdE9wdHMob3B0cykge1xuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRzO1xuICAgIGlmICghb3B0cy5wb3J0KSB7XG4gICAgICAgIGlmIChvcHRzLnByb3RvY29sID09PSAnd3NzJykge1xuICAgICAgICAgICAgb3B0aW9ucy5wb3J0ID0gNDQzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucy5wb3J0ID0gODA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFvcHRzLnBhdGgpIHtcbiAgICAgICAgb3B0aW9ucy5wYXRoID0gJy8nO1xuICAgIH1cbiAgICBpZiAoIW9wdHMud3NPcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMud3NPcHRpb25zID0ge307XG4gICAgfVxuICAgIGlmICghaXNfYnJvd3Nlcl8xLmRlZmF1bHQgJiYgIW9wdHMuZm9yY2VOYXRpdmVXZWJTb2NrZXQgJiYgb3B0cy5wcm90b2NvbCA9PT0gJ3dzcycpIHtcbiAgICAgICAgV1NTX09QVElPTlMuZm9yRWFjaCgocHJvcCkgPT4ge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvcHRzLCBwcm9wKSAmJlxuICAgICAgICAgICAgICAgICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3B0cy53c09wdGlvbnMsIHByb3ApKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy53c09wdGlvbnNbcHJvcF0gPSBvcHRzW3Byb3BdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnM7XG59XG5mdW5jdGlvbiBzZXREZWZhdWx0QnJvd3Nlck9wdHMob3B0cykge1xuICAgIGNvbnN0IG9wdGlvbnMgPSBzZXREZWZhdWx0T3B0cyhvcHRzKTtcbiAgICBpZiAoIW9wdGlvbnMuaG9zdG5hbWUpIHtcbiAgICAgICAgb3B0aW9ucy5ob3N0bmFtZSA9IG9wdGlvbnMuaG9zdDtcbiAgICB9XG4gICAgaWYgKCFvcHRpb25zLmhvc3RuYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBkZXRlcm1pbmUgaG9zdC4gU3BlY2lmeSBob3N0IG1hbnVhbGx5LicpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IG5ldyBVUkwoZG9jdW1lbnQuVVJMKTtcbiAgICAgICAgb3B0aW9ucy5ob3N0bmFtZSA9IHBhcnNlZC5ob3N0bmFtZTtcbiAgICAgICAgaWYgKCFvcHRpb25zLnBvcnQpIHtcbiAgICAgICAgICAgIG9wdGlvbnMucG9ydCA9IE51bWJlcihwYXJzZWQucG9ydCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9wdGlvbnMub2JqZWN0TW9kZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG9wdGlvbnMub2JqZWN0TW9kZSA9ICEob3B0aW9ucy5iaW5hcnkgPT09IHRydWUgfHwgb3B0aW9ucy5iaW5hcnkgPT09IHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25zO1xufVxuZnVuY3Rpb24gY3JlYXRlV2ViU29ja2V0KGNsaWVudCwgdXJsLCBvcHRzKSB7XG4gICAgZGVidWcoJ2NyZWF0ZVdlYlNvY2tldCcpO1xuICAgIGRlYnVnKGBwcm90b2NvbDogJHtvcHRzLnByb3RvY29sSWR9ICR7b3B0cy5wcm90b2NvbFZlcnNpb259YCk7XG4gICAgY29uc3Qgd2Vic29ja2V0U3ViUHJvdG9jb2wgPSBvcHRzLnByb3RvY29sSWQgPT09ICdNUUlzZHAnICYmIG9wdHMucHJvdG9jb2xWZXJzaW9uID09PSAzXG4gICAgICAgID8gJ21xdHR2My4xJ1xuICAgICAgICA6ICdtcXR0JztcbiAgICBkZWJ1ZyhgY3JlYXRpbmcgbmV3IFdlYnNvY2tldCBmb3IgdXJsOiAke3VybH0gYW5kIHByb3RvY29sOiAke3dlYnNvY2tldFN1YlByb3RvY29sfWApO1xuICAgIGxldCBzb2NrZXQ7XG4gICAgaWYgKG9wdHMuY3JlYXRlV2Vic29ja2V0KSB7XG4gICAgICAgIHNvY2tldCA9IG9wdHMuY3JlYXRlV2Vic29ja2V0KHVybCwgW3dlYnNvY2tldFN1YlByb3RvY29sXSwgb3B0cyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzb2NrZXQgPSBuZXcgd3NfMS5kZWZhdWx0KHVybCwgW3dlYnNvY2tldFN1YlByb3RvY29sXSwgb3B0cy53c09wdGlvbnMpO1xuICAgIH1cbiAgICByZXR1cm4gc29ja2V0O1xufVxuZnVuY3Rpb24gY3JlYXRlQnJvd3NlcldlYlNvY2tldChjbGllbnQsIG9wdHMpIHtcbiAgICBjb25zdCB3ZWJzb2NrZXRTdWJQcm90b2NvbCA9IG9wdHMucHJvdG9jb2xJZCA9PT0gJ01RSXNkcCcgJiYgb3B0cy5wcm90b2NvbFZlcnNpb24gPT09IDNcbiAgICAgICAgPyAnbXF0dHYzLjEnXG4gICAgICAgIDogJ21xdHQnO1xuICAgIGNvbnN0IHVybCA9IGJ1aWxkVXJsKG9wdHMsIGNsaWVudCk7XG4gICAgbGV0IHNvY2tldDtcbiAgICBpZiAob3B0cy5jcmVhdGVXZWJzb2NrZXQpIHtcbiAgICAgICAgc29ja2V0ID0gb3B0cy5jcmVhdGVXZWJzb2NrZXQodXJsLCBbd2Vic29ja2V0U3ViUHJvdG9jb2xdLCBvcHRzKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsLCBbd2Vic29ja2V0U3ViUHJvdG9jb2xdKTtcbiAgICB9XG4gICAgc29ja2V0LmJpbmFyeVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgIHJldHVybiBzb2NrZXQ7XG59XG5jb25zdCBzdHJlYW1CdWlsZGVyID0gKGNsaWVudCwgb3B0cykgPT4ge1xuICAgIGRlYnVnKCdzdHJlYW1CdWlsZGVyJyk7XG4gICAgY29uc3Qgb3B0aW9ucyA9IHNldERlZmF1bHRPcHRzKG9wdHMpO1xuICAgIG9wdGlvbnMuaG9zdG5hbWUgPSBvcHRpb25zLmhvc3RuYW1lIHx8IG9wdGlvbnMuaG9zdCB8fCAnbG9jYWxob3N0JztcbiAgICBjb25zdCB1cmwgPSBidWlsZFVybChvcHRpb25zLCBjbGllbnQpO1xuICAgIGNvbnN0IHNvY2tldCA9IGNyZWF0ZVdlYlNvY2tldChjbGllbnQsIHVybCwgb3B0aW9ucyk7XG4gICAgY29uc3Qgd2ViU29ja2V0U3RyZWFtID0gd3NfMS5kZWZhdWx0LmNyZWF0ZVdlYlNvY2tldFN0cmVhbShzb2NrZXQsIG9wdGlvbnMud3NPcHRpb25zKTtcbiAgICB3ZWJTb2NrZXRTdHJlYW1bJ3VybCddID0gdXJsO1xuICAgIHNvY2tldC5vbignY2xvc2UnLCAoKSA9PiB7XG4gICAgICAgIHdlYlNvY2tldFN0cmVhbS5kZXN0cm95KCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHdlYlNvY2tldFN0cmVhbTtcbn07XG5leHBvcnRzLnN0cmVhbUJ1aWxkZXIgPSBzdHJlYW1CdWlsZGVyO1xuY29uc3QgYnJvd3NlclN0cmVhbUJ1aWxkZXIgPSAoY2xpZW50LCBvcHRzKSA9PiB7XG4gICAgZGVidWcoJ2Jyb3dzZXJTdHJlYW1CdWlsZGVyJyk7XG4gICAgbGV0IHN0cmVhbTtcbiAgICBjb25zdCBvcHRpb25zID0gc2V0RGVmYXVsdEJyb3dzZXJPcHRzKG9wdHMpO1xuICAgIGNvbnN0IGJ1ZmZlclNpemUgPSBvcHRpb25zLmJyb3dzZXJCdWZmZXJTaXplIHx8IDEwMjQgKiA1MTI7XG4gICAgY29uc3QgYnVmZmVyVGltZW91dCA9IG9wdHMuYnJvd3NlckJ1ZmZlclRpbWVvdXQgfHwgMTAwMDtcbiAgICBjb25zdCBjb2VyY2VUb0J1ZmZlciA9ICFvcHRzLm9iamVjdE1vZGU7XG4gICAgY29uc3Qgc29ja2V0ID0gY3JlYXRlQnJvd3NlcldlYlNvY2tldChjbGllbnQsIG9wdHMpO1xuICAgIGNvbnN0IHByb3h5ID0gYnVpbGRQcm94eShvcHRzLCBzb2NrZXRXcml0ZUJyb3dzZXIsIHNvY2tldEVuZEJyb3dzZXIpO1xuICAgIGlmICghb3B0cy5vYmplY3RNb2RlKSB7XG4gICAgICAgIHByb3h5Ll93cml0ZXYgPSBCdWZmZXJlZER1cGxleF8xLndyaXRldi5iaW5kKHByb3h5KTtcbiAgICB9XG4gICAgcHJveHkub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICBzb2NrZXQuY2xvc2UoKTtcbiAgICB9KTtcbiAgICBjb25zdCBldmVudExpc3RlbmVyU3VwcG9ydCA9IHR5cGVvZiBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lciAhPT0gJ3VuZGVmaW5lZCc7XG4gICAgaWYgKHNvY2tldC5yZWFkeVN0YXRlID09PSBzb2NrZXQuT1BFTikge1xuICAgICAgICBzdHJlYW0gPSBwcm94eTtcbiAgICAgICAgc3RyZWFtLnNvY2tldCA9IHNvY2tldDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHN0cmVhbSA9IG5ldyBCdWZmZXJlZER1cGxleF8xLkJ1ZmZlcmVkRHVwbGV4KG9wdHMsIHByb3h5LCBzb2NrZXQpO1xuICAgICAgICBpZiAoZXZlbnRMaXN0ZW5lclN1cHBvcnQpIHtcbiAgICAgICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdvcGVuJywgb25PcGVuKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNvY2tldC5vbm9wZW4gPSBvbk9wZW47XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50TGlzdGVuZXJTdXBwb3J0KSB7XG4gICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIG9uQ2xvc2UpO1xuICAgICAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBvbkVycm9yKTtcbiAgICAgICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBvbk1lc3NhZ2UpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc29ja2V0Lm9uY2xvc2UgPSBvbkNsb3NlO1xuICAgICAgICBzb2NrZXQub25lcnJvciA9IG9uRXJyb3I7XG4gICAgICAgIHNvY2tldC5vbm1lc3NhZ2UgPSBvbk1lc3NhZ2U7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkUHJveHkocE9wdGlvbnMsIHNvY2tldFdyaXRlLCBzb2NrZXRFbmQpIHtcbiAgICAgICAgY29uc3QgX3Byb3h5ID0gbmV3IHJlYWRhYmxlX3N0cmVhbV8xLlRyYW5zZm9ybSh7XG4gICAgICAgICAgICBvYmplY3RNb2RlOiBwT3B0aW9ucy5vYmplY3RNb2RlLFxuICAgICAgICB9KTtcbiAgICAgICAgX3Byb3h5Ll93cml0ZSA9IHNvY2tldFdyaXRlO1xuICAgICAgICBfcHJveHkuX2ZsdXNoID0gc29ja2V0RW5kO1xuICAgICAgICByZXR1cm4gX3Byb3h5O1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbk9wZW4oKSB7XG4gICAgICAgIGRlYnVnKCdXZWJTb2NrZXQgb25PcGVuJyk7XG4gICAgICAgIGlmIChzdHJlYW0gaW5zdGFuY2VvZiBCdWZmZXJlZER1cGxleF8xLkJ1ZmZlcmVkRHVwbGV4KSB7XG4gICAgICAgICAgICBzdHJlYW0uc29ja2V0UmVhZHkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvbkNsb3NlKGV2ZW50KSB7XG4gICAgICAgIGRlYnVnKCdXZWJTb2NrZXQgb25DbG9zZScsIGV2ZW50KTtcbiAgICAgICAgc3RyZWFtLmVuZCgpO1xuICAgICAgICBzdHJlYW0uZGVzdHJveSgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbkVycm9yKGVycikge1xuICAgICAgICBkZWJ1ZygnV2ViU29ja2V0IG9uRXJyb3InLCBlcnIpO1xuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignV2ViU29ja2V0IGVycm9yJyk7XG4gICAgICAgIGVycm9yWydldmVudCddID0gZXJyO1xuICAgICAgICBzdHJlYW0uZGVzdHJveShlcnJvcik7XG4gICAgfVxuICAgIGFzeW5jIGZ1bmN0aW9uIG9uTWVzc2FnZShldmVudCkge1xuICAgICAgICBpZiAoIXByb3h5IHx8ICFwcm94eS5yZWFkYWJsZSB8fCAhcHJveHkud3JpdGFibGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgeyBkYXRhIH0gPSBldmVudDtcbiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcilcbiAgICAgICAgICAgIGRhdGEgPSBidWZmZXJfMS5CdWZmZXIuZnJvbShkYXRhKTtcbiAgICAgICAgZWxzZSBpZiAoZGF0YSBpbnN0YW5jZW9mIEJsb2IpXG4gICAgICAgICAgICBkYXRhID0gYnVmZmVyXzEuQnVmZmVyLmZyb20oYXdhaXQgbmV3IFJlc3BvbnNlKGRhdGEpLmFycmF5QnVmZmVyKCkpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBkYXRhID0gYnVmZmVyXzEuQnVmZmVyLmZyb20oZGF0YSwgJ3V0ZjgnKTtcbiAgICAgICAgcHJveHkucHVzaChkYXRhKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc29ja2V0V3JpdGVCcm93c2VyKGNodW5rLCBlbmMsIG5leHQpIHtcbiAgICAgICAgaWYgKHNvY2tldC5idWZmZXJlZEFtb3VudCA+IGJ1ZmZlclNpemUpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoc29ja2V0V3JpdGVCcm93c2VyLCBidWZmZXJUaW1lb3V0LCBjaHVuaywgZW5jLCBuZXh0KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29lcmNlVG9CdWZmZXIgJiYgdHlwZW9mIGNodW5rID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY2h1bmsgPSBidWZmZXJfMS5CdWZmZXIuZnJvbShjaHVuaywgJ3V0ZjgnKTtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc29ja2V0LnNlbmQoY2h1bmspO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXh0KGVycik7XG4gICAgICAgIH1cbiAgICAgICAgbmV4dCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzb2NrZXRFbmRCcm93c2VyKGRvbmUpIHtcbiAgICAgICAgc29ja2V0LmNsb3NlKCk7XG4gICAgICAgIGRvbmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cmVhbTtcbn07XG5leHBvcnRzLmJyb3dzZXJTdHJlYW1CdWlsZGVyID0gYnJvd3NlclN0cmVhbUJ1aWxkZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13cy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/connect/ws.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/connect/wx.js":
/*!***************************************************!*\
  !*** ./node_modules/mqtt/build/lib/connect/wx.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst buffer_1 = __webpack_require__(/*! buffer */ \"buffer\");\nconst readable_stream_1 = __webpack_require__(/*! readable-stream */ \"(ssr)/./node_modules/readable-stream/lib/ours/index.js\");\nconst BufferedDuplex_1 = __webpack_require__(/*! ../BufferedDuplex */ \"(ssr)/./node_modules/mqtt/build/lib/BufferedDuplex.js\");\nlet socketTask;\nlet proxy;\nlet stream;\nfunction buildProxy() {\n    const _proxy = new readable_stream_1.Transform();\n    _proxy._write = (chunk, encoding, next) => {\n        socketTask.send({\n            data: chunk.buffer,\n            success() {\n                next();\n            },\n            fail(errMsg) {\n                next(new Error(errMsg));\n            },\n        });\n    };\n    _proxy._flush = (done) => {\n        socketTask.close({\n            success() {\n                done();\n            },\n        });\n    };\n    return _proxy;\n}\nfunction setDefaultOpts(opts) {\n    if (!opts.hostname) {\n        opts.hostname = 'localhost';\n    }\n    if (!opts.path) {\n        opts.path = '/';\n    }\n    if (!opts.wsOptions) {\n        opts.wsOptions = {};\n    }\n}\nfunction buildUrl(opts, client) {\n    const protocol = opts.protocol === 'wxs' ? 'wss' : 'ws';\n    let url = `${protocol}://${opts.hostname}${opts.path}`;\n    if (opts.port && opts.port !== 80 && opts.port !== 443) {\n        url = `${protocol}://${opts.hostname}:${opts.port}${opts.path}`;\n    }\n    if (typeof opts.transformWsUrl === 'function') {\n        url = opts.transformWsUrl(url, opts, client);\n    }\n    return url;\n}\nfunction bindEventHandler() {\n    socketTask.onOpen(() => {\n        stream.socketReady();\n    });\n    socketTask.onMessage((res) => {\n        let { data } = res;\n        if (data instanceof ArrayBuffer)\n            data = buffer_1.Buffer.from(data);\n        else\n            data = buffer_1.Buffer.from(data, 'utf8');\n        proxy.push(data);\n    });\n    socketTask.onClose(() => {\n        stream.emit('close');\n        stream.end();\n        stream.destroy();\n    });\n    socketTask.onError((error) => {\n        const err = new Error(error.errMsg);\n        stream.destroy(err);\n    });\n}\nconst buildStream = (client, opts) => {\n    opts.hostname = opts.hostname || opts.host;\n    if (!opts.hostname) {\n        throw new Error('Could not determine host. Specify host manually.');\n    }\n    const websocketSubProtocol = opts.protocolId === 'MQIsdp' && opts.protocolVersion === 3\n        ? 'mqttv3.1'\n        : 'mqtt';\n    setDefaultOpts(opts);\n    const url = buildUrl(opts, client);\n    socketTask = wx.connectSocket({\n        url,\n        protocols: [websocketSubProtocol],\n    });\n    proxy = buildProxy();\n    stream = new BufferedDuplex_1.BufferedDuplex(opts, proxy, socketTask);\n    stream._destroy = (err, cb) => {\n        socketTask.close({\n            success() {\n                if (cb)\n                    cb(err);\n            },\n        });\n    };\n    const destroyRef = stream.destroy;\n    stream.destroy = (err, cb) => {\n        stream.destroy = destroyRef;\n        setTimeout(() => {\n            socketTask.close({\n                fail() {\n                    stream._destroy(err, cb);\n                },\n            });\n        }, 0);\n        return stream;\n    };\n    bindEventHandler();\n    return stream;\n};\nexports[\"default\"] = buildStream;\n//# sourceMappingURL=wx.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvY29ubmVjdC93eC5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxpQkFBaUIsbUJBQU8sQ0FBQyxzQkFBUTtBQUNqQywwQkFBMEIsbUJBQU8sQ0FBQywrRUFBaUI7QUFDbkQseUJBQXlCLG1CQUFPLENBQUMsZ0ZBQW1CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQVMsS0FBSyxjQUFjLEVBQUUsVUFBVTtBQUN6RDtBQUNBLGlCQUFpQixTQUFTLEtBQUssY0FBYyxHQUFHLFVBQVUsRUFBRSxVQUFVO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGNBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL2Nvbm5lY3Qvd3guanM/Yzk5OCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IGJ1ZmZlcl8xID0gcmVxdWlyZShcImJ1ZmZlclwiKTtcbmNvbnN0IHJlYWRhYmxlX3N0cmVhbV8xID0gcmVxdWlyZShcInJlYWRhYmxlLXN0cmVhbVwiKTtcbmNvbnN0IEJ1ZmZlcmVkRHVwbGV4XzEgPSByZXF1aXJlKFwiLi4vQnVmZmVyZWREdXBsZXhcIik7XG5sZXQgc29ja2V0VGFzaztcbmxldCBwcm94eTtcbmxldCBzdHJlYW07XG5mdW5jdGlvbiBidWlsZFByb3h5KCkge1xuICAgIGNvbnN0IF9wcm94eSA9IG5ldyByZWFkYWJsZV9zdHJlYW1fMS5UcmFuc2Zvcm0oKTtcbiAgICBfcHJveHkuX3dyaXRlID0gKGNodW5rLCBlbmNvZGluZywgbmV4dCkgPT4ge1xuICAgICAgICBzb2NrZXRUYXNrLnNlbmQoe1xuICAgICAgICAgICAgZGF0YTogY2h1bmsuYnVmZmVyLFxuICAgICAgICAgICAgc3VjY2VzcygpIHtcbiAgICAgICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmFpbChlcnJNc2cpIHtcbiAgICAgICAgICAgICAgICBuZXh0KG5ldyBFcnJvcihlcnJNc2cpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgX3Byb3h5Ll9mbHVzaCA9IChkb25lKSA9PiB7XG4gICAgICAgIHNvY2tldFRhc2suY2xvc2Uoe1xuICAgICAgICAgICAgc3VjY2VzcygpIHtcbiAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBfcHJveHk7XG59XG5mdW5jdGlvbiBzZXREZWZhdWx0T3B0cyhvcHRzKSB7XG4gICAgaWYgKCFvcHRzLmhvc3RuYW1lKSB7XG4gICAgICAgIG9wdHMuaG9zdG5hbWUgPSAnbG9jYWxob3N0JztcbiAgICB9XG4gICAgaWYgKCFvcHRzLnBhdGgpIHtcbiAgICAgICAgb3B0cy5wYXRoID0gJy8nO1xuICAgIH1cbiAgICBpZiAoIW9wdHMud3NPcHRpb25zKSB7XG4gICAgICAgIG9wdHMud3NPcHRpb25zID0ge307XG4gICAgfVxufVxuZnVuY3Rpb24gYnVpbGRVcmwob3B0cywgY2xpZW50KSB7XG4gICAgY29uc3QgcHJvdG9jb2wgPSBvcHRzLnByb3RvY29sID09PSAnd3hzJyA/ICd3c3MnIDogJ3dzJztcbiAgICBsZXQgdXJsID0gYCR7cHJvdG9jb2x9Oi8vJHtvcHRzLmhvc3RuYW1lfSR7b3B0cy5wYXRofWA7XG4gICAgaWYgKG9wdHMucG9ydCAmJiBvcHRzLnBvcnQgIT09IDgwICYmIG9wdHMucG9ydCAhPT0gNDQzKSB7XG4gICAgICAgIHVybCA9IGAke3Byb3RvY29sfTovLyR7b3B0cy5ob3N0bmFtZX06JHtvcHRzLnBvcnR9JHtvcHRzLnBhdGh9YDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRzLnRyYW5zZm9ybVdzVXJsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHVybCA9IG9wdHMudHJhbnNmb3JtV3NVcmwodXJsLCBvcHRzLCBjbGllbnQpO1xuICAgIH1cbiAgICByZXR1cm4gdXJsO1xufVxuZnVuY3Rpb24gYmluZEV2ZW50SGFuZGxlcigpIHtcbiAgICBzb2NrZXRUYXNrLm9uT3BlbigoKSA9PiB7XG4gICAgICAgIHN0cmVhbS5zb2NrZXRSZWFkeSgpO1xuICAgIH0pO1xuICAgIHNvY2tldFRhc2sub25NZXNzYWdlKChyZXMpID0+IHtcbiAgICAgICAgbGV0IHsgZGF0YSB9ID0gcmVzO1xuICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKVxuICAgICAgICAgICAgZGF0YSA9IGJ1ZmZlcl8xLkJ1ZmZlci5mcm9tKGRhdGEpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBkYXRhID0gYnVmZmVyXzEuQnVmZmVyLmZyb20oZGF0YSwgJ3V0ZjgnKTtcbiAgICAgICAgcHJveHkucHVzaChkYXRhKTtcbiAgICB9KTtcbiAgICBzb2NrZXRUYXNrLm9uQ2xvc2UoKCkgPT4ge1xuICAgICAgICBzdHJlYW0uZW1pdCgnY2xvc2UnKTtcbiAgICAgICAgc3RyZWFtLmVuZCgpO1xuICAgICAgICBzdHJlYW0uZGVzdHJveSgpO1xuICAgIH0pO1xuICAgIHNvY2tldFRhc2sub25FcnJvcigoZXJyb3IpID0+IHtcbiAgICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKGVycm9yLmVyck1zZyk7XG4gICAgICAgIHN0cmVhbS5kZXN0cm95KGVycik7XG4gICAgfSk7XG59XG5jb25zdCBidWlsZFN0cmVhbSA9IChjbGllbnQsIG9wdHMpID0+IHtcbiAgICBvcHRzLmhvc3RuYW1lID0gb3B0cy5ob3N0bmFtZSB8fCBvcHRzLmhvc3Q7XG4gICAgaWYgKCFvcHRzLmhvc3RuYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGRldGVybWluZSBob3N0LiBTcGVjaWZ5IGhvc3QgbWFudWFsbHkuJyk7XG4gICAgfVxuICAgIGNvbnN0IHdlYnNvY2tldFN1YlByb3RvY29sID0gb3B0cy5wcm90b2NvbElkID09PSAnTVFJc2RwJyAmJiBvcHRzLnByb3RvY29sVmVyc2lvbiA9PT0gM1xuICAgICAgICA/ICdtcXR0djMuMSdcbiAgICAgICAgOiAnbXF0dCc7XG4gICAgc2V0RGVmYXVsdE9wdHMob3B0cyk7XG4gICAgY29uc3QgdXJsID0gYnVpbGRVcmwob3B0cywgY2xpZW50KTtcbiAgICBzb2NrZXRUYXNrID0gd3guY29ubmVjdFNvY2tldCh7XG4gICAgICAgIHVybCxcbiAgICAgICAgcHJvdG9jb2xzOiBbd2Vic29ja2V0U3ViUHJvdG9jb2xdLFxuICAgIH0pO1xuICAgIHByb3h5ID0gYnVpbGRQcm94eSgpO1xuICAgIHN0cmVhbSA9IG5ldyBCdWZmZXJlZER1cGxleF8xLkJ1ZmZlcmVkRHVwbGV4KG9wdHMsIHByb3h5LCBzb2NrZXRUYXNrKTtcbiAgICBzdHJlYW0uX2Rlc3Ryb3kgPSAoZXJyLCBjYikgPT4ge1xuICAgICAgICBzb2NrZXRUYXNrLmNsb3NlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3MoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNiKVxuICAgICAgICAgICAgICAgICAgICBjYihlcnIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBkZXN0cm95UmVmID0gc3RyZWFtLmRlc3Ryb3k7XG4gICAgc3RyZWFtLmRlc3Ryb3kgPSAoZXJyLCBjYikgPT4ge1xuICAgICAgICBzdHJlYW0uZGVzdHJveSA9IGRlc3Ryb3lSZWY7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgc29ja2V0VGFzay5jbG9zZSh7XG4gICAgICAgICAgICAgICAgZmFpbCgpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtLl9kZXN0cm95KGVyciwgY2IpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgfTtcbiAgICBiaW5kRXZlbnRIYW5kbGVyKCk7XG4gICAgcmV0dXJuIHN0cmVhbTtcbn07XG5leHBvcnRzLmRlZmF1bHQgPSBidWlsZFN0cmVhbTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXd4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/connect/wx.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/default-message-id-provider.js":
/*!********************************************************************!*\
  !*** ./node_modules/mqtt/build/lib/default-message-id-provider.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nclass DefaultMessageIdProvider {\n    nextId;\n    constructor() {\n        this.nextId = Math.max(1, Math.floor(Math.random() * 65535));\n    }\n    allocate() {\n        const id = this.nextId++;\n        if (this.nextId === 65536) {\n            this.nextId = 1;\n        }\n        return id;\n    }\n    getLastAllocated() {\n        return this.nextId === 1 ? 65535 : this.nextId - 1;\n    }\n    register(messageId) {\n        return true;\n    }\n    deallocate(messageId) { }\n    clear() { }\n}\nexports[\"default\"] = DefaultMessageIdProvider;\n//# sourceMappingURL=default-message-id-provider.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvZGVmYXVsdC1tZXNzYWdlLWlkLXByb3ZpZGVyLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL2RlZmF1bHQtbWVzc2FnZS1pZC1wcm92aWRlci5qcz9kYmEzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY2xhc3MgRGVmYXVsdE1lc3NhZ2VJZFByb3ZpZGVyIHtcbiAgICBuZXh0SWQ7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMubmV4dElkID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNjU1MzUpKTtcbiAgICB9XG4gICAgYWxsb2NhdGUoKSB7XG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5uZXh0SWQrKztcbiAgICAgICAgaWYgKHRoaXMubmV4dElkID09PSA2NTUzNikge1xuICAgICAgICAgICAgdGhpcy5uZXh0SWQgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpZDtcbiAgICB9XG4gICAgZ2V0TGFzdEFsbG9jYXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmV4dElkID09PSAxID8gNjU1MzUgOiB0aGlzLm5leHRJZCAtIDE7XG4gICAgfVxuICAgIHJlZ2lzdGVyKG1lc3NhZ2VJZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZGVhbGxvY2F0ZShtZXNzYWdlSWQpIHsgfVxuICAgIGNsZWFyKCkgeyB9XG59XG5leHBvcnRzLmRlZmF1bHQgPSBEZWZhdWx0TWVzc2FnZUlkUHJvdmlkZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWZhdWx0LW1lc3NhZ2UtaWQtcHJvdmlkZXIuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/default-message-id-provider.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/get-timer.js":
/*!**************************************************!*\
  !*** ./node_modules/mqtt/build/lib/get-timer.js ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst worker_timers_1 = __webpack_require__(/*! worker-timers */ \"(ssr)/./node_modules/worker-timers/build/es2019/module.js\");\nconst is_browser_1 = __importStar(__webpack_require__(/*! ./is-browser */ \"(ssr)/./node_modules/mqtt/build/lib/is-browser.js\"));\nconst workerTimer = {\n    set: worker_timers_1.setInterval,\n    clear: worker_timers_1.clearInterval,\n};\nconst nativeTimer = {\n    set: (func, time) => setInterval(func, time),\n    clear: (timerId) => clearInterval(timerId),\n};\nconst getTimer = (variant) => {\n    switch (variant) {\n        case 'native': {\n            return nativeTimer;\n        }\n        case 'worker': {\n            return workerTimer;\n        }\n        case 'auto':\n        default: {\n            return is_browser_1.default && !is_browser_1.isWebWorker && !is_browser_1.isReactNativeBrowser\n                ? workerTimer\n                : nativeTimer;\n        }\n    }\n};\nexports[\"default\"] = getTimer;\n//# sourceMappingURL=get-timer.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvZ2V0LXRpbWVyLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG9DQUFvQztBQUNuRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwwQ0FBMEMsNEJBQTRCO0FBQ3RFLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsY0FBYztBQUN6RTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHdCQUF3QixtQkFBTyxDQUFDLGdGQUFlO0FBQy9DLGtDQUFrQyxtQkFBTyxDQUFDLHVFQUFjO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL2dldC10aW1lci5qcz8xNjA3Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIG9bazJdID0gbVtrXTtcbn0pKTtcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCkgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcbn0pIDogZnVuY3Rpb24obywgdikge1xuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbn0pO1xudmFyIF9faW1wb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBvd25LZXlzID0gZnVuY3Rpb24obykge1xuICAgICAgICBvd25LZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgIHZhciBhciA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgayBpbiBvKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIGspKSBhclthci5sZW5ndGhdID0gaztcbiAgICAgICAgICAgIHJldHVybiBhcjtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG93bktleXMobyk7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1vZCkge1xuICAgICAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayA9IG93bktleXMobW9kKSwgaSA9IDA7IGkgPCBrLmxlbmd0aDsgaSsrKSBpZiAoa1tpXSAhPT0gXCJkZWZhdWx0XCIpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwga1tpXSk7XG4gICAgICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCB3b3JrZXJfdGltZXJzXzEgPSByZXF1aXJlKFwid29ya2VyLXRpbWVyc1wiKTtcbmNvbnN0IGlzX2Jyb3dzZXJfMSA9IF9faW1wb3J0U3RhcihyZXF1aXJlKFwiLi9pcy1icm93c2VyXCIpKTtcbmNvbnN0IHdvcmtlclRpbWVyID0ge1xuICAgIHNldDogd29ya2VyX3RpbWVyc18xLnNldEludGVydmFsLFxuICAgIGNsZWFyOiB3b3JrZXJfdGltZXJzXzEuY2xlYXJJbnRlcnZhbCxcbn07XG5jb25zdCBuYXRpdmVUaW1lciA9IHtcbiAgICBzZXQ6IChmdW5jLCB0aW1lKSA9PiBzZXRJbnRlcnZhbChmdW5jLCB0aW1lKSxcbiAgICBjbGVhcjogKHRpbWVySWQpID0+IGNsZWFySW50ZXJ2YWwodGltZXJJZCksXG59O1xuY29uc3QgZ2V0VGltZXIgPSAodmFyaWFudCkgPT4ge1xuICAgIHN3aXRjaCAodmFyaWFudCkge1xuICAgICAgICBjYXNlICduYXRpdmUnOiB7XG4gICAgICAgICAgICByZXR1cm4gbmF0aXZlVGltZXI7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnd29ya2VyJzoge1xuICAgICAgICAgICAgcmV0dXJuIHdvcmtlclRpbWVyO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ2F1dG8nOlxuICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICByZXR1cm4gaXNfYnJvd3Nlcl8xLmRlZmF1bHQgJiYgIWlzX2Jyb3dzZXJfMS5pc1dlYldvcmtlciAmJiAhaXNfYnJvd3Nlcl8xLmlzUmVhY3ROYXRpdmVCcm93c2VyXG4gICAgICAgICAgICAgICAgPyB3b3JrZXJUaW1lclxuICAgICAgICAgICAgICAgIDogbmF0aXZlVGltZXI7XG4gICAgICAgIH1cbiAgICB9XG59O1xuZXhwb3J0cy5kZWZhdWx0ID0gZ2V0VGltZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZXQtdGltZXIuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/get-timer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/handlers/ack.js":
/*!*****************************************************!*\
  !*** ./node_modules/mqtt/build/lib/handlers/ack.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.ReasonCodes = void 0;\nconst shared_1 = __webpack_require__(/*! ../shared */ \"(ssr)/./node_modules/mqtt/build/lib/shared.js\");\nexports.ReasonCodes = {\n    0: '',\n    1: 'Unacceptable protocol version',\n    2: 'Identifier rejected',\n    3: 'Server unavailable',\n    4: 'Bad username or password',\n    5: 'Not authorized',\n    16: 'No matching subscribers',\n    17: 'No subscription existed',\n    128: 'Unspecified error',\n    129: 'Malformed Packet',\n    130: 'Protocol Error',\n    131: 'Implementation specific error',\n    132: 'Unsupported Protocol Version',\n    133: 'Client Identifier not valid',\n    134: 'Bad User Name or Password',\n    135: 'Not authorized',\n    136: 'Server unavailable',\n    137: 'Server busy',\n    138: 'Banned',\n    139: 'Server shutting down',\n    140: 'Bad authentication method',\n    141: 'Keep Alive timeout',\n    142: 'Session taken over',\n    143: 'Topic Filter invalid',\n    144: 'Topic Name invalid',\n    145: 'Packet identifier in use',\n    146: 'Packet Identifier not found',\n    147: 'Receive Maximum exceeded',\n    148: 'Topic Alias invalid',\n    149: 'Packet too large',\n    150: 'Message rate too high',\n    151: 'Quota exceeded',\n    152: 'Administrative action',\n    153: 'Payload format invalid',\n    154: 'Retain not supported',\n    155: 'QoS not supported',\n    156: 'Use another server',\n    157: 'Server moved',\n    158: 'Shared Subscriptions not supported',\n    159: 'Connection rate exceeded',\n    160: 'Maximum connect time',\n    161: 'Subscription Identifiers not supported',\n    162: 'Wildcard Subscriptions not supported',\n};\nconst handleAck = (client, packet) => {\n    const { messageId } = packet;\n    const type = packet.cmd;\n    let response = null;\n    const cb = client.outgoing[messageId] ? client.outgoing[messageId].cb : null;\n    let err = null;\n    if (!cb) {\n        client.log('_handleAck :: Server sent an ack in error. Ignoring.');\n        return;\n    }\n    client.log('_handleAck :: packet type', type);\n    switch (type) {\n        case 'pubcomp':\n        case 'puback': {\n            const pubackRC = packet.reasonCode;\n            if (pubackRC && pubackRC > 0 && pubackRC !== 16) {\n                err = new shared_1.ErrorWithReasonCode(`Publish error: ${exports.ReasonCodes[pubackRC]}`, pubackRC);\n                client['_removeOutgoingAndStoreMessage'](messageId, () => {\n                    cb(err, packet);\n                });\n            }\n            else {\n                client['_removeOutgoingAndStoreMessage'](messageId, cb);\n            }\n            break;\n        }\n        case 'pubrec': {\n            response = {\n                cmd: 'pubrel',\n                qos: 2,\n                messageId,\n            };\n            const pubrecRC = packet.reasonCode;\n            if (pubrecRC && pubrecRC > 0 && pubrecRC !== 16) {\n                err = new shared_1.ErrorWithReasonCode(`Publish error: ${exports.ReasonCodes[pubrecRC]}`, pubrecRC);\n                client['_removeOutgoingAndStoreMessage'](messageId, () => {\n                    cb(err, packet);\n                });\n            }\n            else {\n                client['_sendPacket'](response);\n            }\n            break;\n        }\n        case 'suback': {\n            delete client.outgoing[messageId];\n            client.messageIdProvider.deallocate(messageId);\n            const granted = packet.granted;\n            for (let grantedI = 0; grantedI < granted.length; grantedI++) {\n                const subackRC = granted[grantedI];\n                if ((subackRC & 0x80) !== 0) {\n                    err = new Error(`Subscribe error: ${exports.ReasonCodes[subackRC]}`);\n                    err.code = subackRC;\n                    const topics = client.messageIdToTopic[messageId];\n                    if (topics) {\n                        topics.forEach((topic) => {\n                            delete client['_resubscribeTopics'][topic];\n                        });\n                    }\n                }\n            }\n            delete client.messageIdToTopic[messageId];\n            client['_invokeStoreProcessingQueue']();\n            cb(err, packet);\n            break;\n        }\n        case 'unsuback': {\n            delete client.outgoing[messageId];\n            client.messageIdProvider.deallocate(messageId);\n            client['_invokeStoreProcessingQueue']();\n            cb(null, packet);\n            break;\n        }\n        default:\n            client.emit('error', new Error('unrecognized packet type'));\n    }\n    if (client.disconnecting && Object.keys(client.outgoing).length === 0) {\n        client.emit('outgoingEmpty');\n    }\n};\nexports[\"default\"] = handleAck;\n//# sourceMappingURL=ack.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaGFuZGxlcnMvYWNrLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELG1CQUFtQjtBQUNuQixpQkFBaUIsbUJBQU8sQ0FBQyxnRUFBVztBQUNwQyxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxZQUFZO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5RUFBeUUsOEJBQThCO0FBQ3ZHO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSw4QkFBOEI7QUFDdkc7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywyQkFBMkI7QUFDOUQ7QUFDQTtBQUNBLHdEQUF3RCw4QkFBOEI7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL2hhbmRsZXJzL2Fjay5qcz83NTVjIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5SZWFzb25Db2RlcyA9IHZvaWQgMDtcbmNvbnN0IHNoYXJlZF8xID0gcmVxdWlyZShcIi4uL3NoYXJlZFwiKTtcbmV4cG9ydHMuUmVhc29uQ29kZXMgPSB7XG4gICAgMDogJycsXG4gICAgMTogJ1VuYWNjZXB0YWJsZSBwcm90b2NvbCB2ZXJzaW9uJyxcbiAgICAyOiAnSWRlbnRpZmllciByZWplY3RlZCcsXG4gICAgMzogJ1NlcnZlciB1bmF2YWlsYWJsZScsXG4gICAgNDogJ0JhZCB1c2VybmFtZSBvciBwYXNzd29yZCcsXG4gICAgNTogJ05vdCBhdXRob3JpemVkJyxcbiAgICAxNjogJ05vIG1hdGNoaW5nIHN1YnNjcmliZXJzJyxcbiAgICAxNzogJ05vIHN1YnNjcmlwdGlvbiBleGlzdGVkJyxcbiAgICAxMjg6ICdVbnNwZWNpZmllZCBlcnJvcicsXG4gICAgMTI5OiAnTWFsZm9ybWVkIFBhY2tldCcsXG4gICAgMTMwOiAnUHJvdG9jb2wgRXJyb3InLFxuICAgIDEzMTogJ0ltcGxlbWVudGF0aW9uIHNwZWNpZmljIGVycm9yJyxcbiAgICAxMzI6ICdVbnN1cHBvcnRlZCBQcm90b2NvbCBWZXJzaW9uJyxcbiAgICAxMzM6ICdDbGllbnQgSWRlbnRpZmllciBub3QgdmFsaWQnLFxuICAgIDEzNDogJ0JhZCBVc2VyIE5hbWUgb3IgUGFzc3dvcmQnLFxuICAgIDEzNTogJ05vdCBhdXRob3JpemVkJyxcbiAgICAxMzY6ICdTZXJ2ZXIgdW5hdmFpbGFibGUnLFxuICAgIDEzNzogJ1NlcnZlciBidXN5JyxcbiAgICAxMzg6ICdCYW5uZWQnLFxuICAgIDEzOTogJ1NlcnZlciBzaHV0dGluZyBkb3duJyxcbiAgICAxNDA6ICdCYWQgYXV0aGVudGljYXRpb24gbWV0aG9kJyxcbiAgICAxNDE6ICdLZWVwIEFsaXZlIHRpbWVvdXQnLFxuICAgIDE0MjogJ1Nlc3Npb24gdGFrZW4gb3ZlcicsXG4gICAgMTQzOiAnVG9waWMgRmlsdGVyIGludmFsaWQnLFxuICAgIDE0NDogJ1RvcGljIE5hbWUgaW52YWxpZCcsXG4gICAgMTQ1OiAnUGFja2V0IGlkZW50aWZpZXIgaW4gdXNlJyxcbiAgICAxNDY6ICdQYWNrZXQgSWRlbnRpZmllciBub3QgZm91bmQnLFxuICAgIDE0NzogJ1JlY2VpdmUgTWF4aW11bSBleGNlZWRlZCcsXG4gICAgMTQ4OiAnVG9waWMgQWxpYXMgaW52YWxpZCcsXG4gICAgMTQ5OiAnUGFja2V0IHRvbyBsYXJnZScsXG4gICAgMTUwOiAnTWVzc2FnZSByYXRlIHRvbyBoaWdoJyxcbiAgICAxNTE6ICdRdW90YSBleGNlZWRlZCcsXG4gICAgMTUyOiAnQWRtaW5pc3RyYXRpdmUgYWN0aW9uJyxcbiAgICAxNTM6ICdQYXlsb2FkIGZvcm1hdCBpbnZhbGlkJyxcbiAgICAxNTQ6ICdSZXRhaW4gbm90IHN1cHBvcnRlZCcsXG4gICAgMTU1OiAnUW9TIG5vdCBzdXBwb3J0ZWQnLFxuICAgIDE1NjogJ1VzZSBhbm90aGVyIHNlcnZlcicsXG4gICAgMTU3OiAnU2VydmVyIG1vdmVkJyxcbiAgICAxNTg6ICdTaGFyZWQgU3Vic2NyaXB0aW9ucyBub3Qgc3VwcG9ydGVkJyxcbiAgICAxNTk6ICdDb25uZWN0aW9uIHJhdGUgZXhjZWVkZWQnLFxuICAgIDE2MDogJ01heGltdW0gY29ubmVjdCB0aW1lJyxcbiAgICAxNjE6ICdTdWJzY3JpcHRpb24gSWRlbnRpZmllcnMgbm90IHN1cHBvcnRlZCcsXG4gICAgMTYyOiAnV2lsZGNhcmQgU3Vic2NyaXB0aW9ucyBub3Qgc3VwcG9ydGVkJyxcbn07XG5jb25zdCBoYW5kbGVBY2sgPSAoY2xpZW50LCBwYWNrZXQpID0+IHtcbiAgICBjb25zdCB7IG1lc3NhZ2VJZCB9ID0gcGFja2V0O1xuICAgIGNvbnN0IHR5cGUgPSBwYWNrZXQuY21kO1xuICAgIGxldCByZXNwb25zZSA9IG51bGw7XG4gICAgY29uc3QgY2IgPSBjbGllbnQub3V0Z29pbmdbbWVzc2FnZUlkXSA/IGNsaWVudC5vdXRnb2luZ1ttZXNzYWdlSWRdLmNiIDogbnVsbDtcbiAgICBsZXQgZXJyID0gbnVsbDtcbiAgICBpZiAoIWNiKSB7XG4gICAgICAgIGNsaWVudC5sb2coJ19oYW5kbGVBY2sgOjogU2VydmVyIHNlbnQgYW4gYWNrIGluIGVycm9yLiBJZ25vcmluZy4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjbGllbnQubG9nKCdfaGFuZGxlQWNrIDo6IHBhY2tldCB0eXBlJywgdHlwZSk7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ3B1YmNvbXAnOlxuICAgICAgICBjYXNlICdwdWJhY2snOiB7XG4gICAgICAgICAgICBjb25zdCBwdWJhY2tSQyA9IHBhY2tldC5yZWFzb25Db2RlO1xuICAgICAgICAgICAgaWYgKHB1YmFja1JDICYmIHB1YmFja1JDID4gMCAmJiBwdWJhY2tSQyAhPT0gMTYpIHtcbiAgICAgICAgICAgICAgICBlcnIgPSBuZXcgc2hhcmVkXzEuRXJyb3JXaXRoUmVhc29uQ29kZShgUHVibGlzaCBlcnJvcjogJHtleHBvcnRzLlJlYXNvbkNvZGVzW3B1YmFja1JDXX1gLCBwdWJhY2tSQyk7XG4gICAgICAgICAgICAgICAgY2xpZW50WydfcmVtb3ZlT3V0Z29pbmdBbmRTdG9yZU1lc3NhZ2UnXShtZXNzYWdlSWQsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY2IoZXJyLCBwYWNrZXQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2xpZW50WydfcmVtb3ZlT3V0Z29pbmdBbmRTdG9yZU1lc3NhZ2UnXShtZXNzYWdlSWQsIGNiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ3B1YnJlYyc6IHtcbiAgICAgICAgICAgIHJlc3BvbnNlID0ge1xuICAgICAgICAgICAgICAgIGNtZDogJ3B1YnJlbCcsXG4gICAgICAgICAgICAgICAgcW9zOiAyLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VJZCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBwdWJyZWNSQyA9IHBhY2tldC5yZWFzb25Db2RlO1xuICAgICAgICAgICAgaWYgKHB1YnJlY1JDICYmIHB1YnJlY1JDID4gMCAmJiBwdWJyZWNSQyAhPT0gMTYpIHtcbiAgICAgICAgICAgICAgICBlcnIgPSBuZXcgc2hhcmVkXzEuRXJyb3JXaXRoUmVhc29uQ29kZShgUHVibGlzaCBlcnJvcjogJHtleHBvcnRzLlJlYXNvbkNvZGVzW3B1YnJlY1JDXX1gLCBwdWJyZWNSQyk7XG4gICAgICAgICAgICAgICAgY2xpZW50WydfcmVtb3ZlT3V0Z29pbmdBbmRTdG9yZU1lc3NhZ2UnXShtZXNzYWdlSWQsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY2IoZXJyLCBwYWNrZXQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2xpZW50Wydfc2VuZFBhY2tldCddKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ3N1YmFjayc6IHtcbiAgICAgICAgICAgIGRlbGV0ZSBjbGllbnQub3V0Z29pbmdbbWVzc2FnZUlkXTtcbiAgICAgICAgICAgIGNsaWVudC5tZXNzYWdlSWRQcm92aWRlci5kZWFsbG9jYXRlKG1lc3NhZ2VJZCk7XG4gICAgICAgICAgICBjb25zdCBncmFudGVkID0gcGFja2V0LmdyYW50ZWQ7XG4gICAgICAgICAgICBmb3IgKGxldCBncmFudGVkSSA9IDA7IGdyYW50ZWRJIDwgZ3JhbnRlZC5sZW5ndGg7IGdyYW50ZWRJKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdWJhY2tSQyA9IGdyYW50ZWRbZ3JhbnRlZEldO1xuICAgICAgICAgICAgICAgIGlmICgoc3ViYWNrUkMgJiAweDgwKSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBlcnIgPSBuZXcgRXJyb3IoYFN1YnNjcmliZSBlcnJvcjogJHtleHBvcnRzLlJlYXNvbkNvZGVzW3N1YmFja1JDXX1gKTtcbiAgICAgICAgICAgICAgICAgICAgZXJyLmNvZGUgPSBzdWJhY2tSQztcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9waWNzID0gY2xpZW50Lm1lc3NhZ2VJZFRvVG9waWNbbWVzc2FnZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvcGljcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9waWNzLmZvckVhY2goKHRvcGljKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNsaWVudFsnX3Jlc3Vic2NyaWJlVG9waWNzJ11bdG9waWNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWxldGUgY2xpZW50Lm1lc3NhZ2VJZFRvVG9waWNbbWVzc2FnZUlkXTtcbiAgICAgICAgICAgIGNsaWVudFsnX2ludm9rZVN0b3JlUHJvY2Vzc2luZ1F1ZXVlJ10oKTtcbiAgICAgICAgICAgIGNiKGVyciwgcGFja2V0KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ3Vuc3ViYWNrJzoge1xuICAgICAgICAgICAgZGVsZXRlIGNsaWVudC5vdXRnb2luZ1ttZXNzYWdlSWRdO1xuICAgICAgICAgICAgY2xpZW50Lm1lc3NhZ2VJZFByb3ZpZGVyLmRlYWxsb2NhdGUobWVzc2FnZUlkKTtcbiAgICAgICAgICAgIGNsaWVudFsnX2ludm9rZVN0b3JlUHJvY2Vzc2luZ1F1ZXVlJ10oKTtcbiAgICAgICAgICAgIGNiKG51bGwsIHBhY2tldCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2xpZW50LmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCd1bnJlY29nbml6ZWQgcGFja2V0IHR5cGUnKSk7XG4gICAgfVxuICAgIGlmIChjbGllbnQuZGlzY29ubmVjdGluZyAmJiBPYmplY3Qua2V5cyhjbGllbnQub3V0Z29pbmcpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjbGllbnQuZW1pdCgnb3V0Z29pbmdFbXB0eScpO1xuICAgIH1cbn07XG5leHBvcnRzLmRlZmF1bHQgPSBoYW5kbGVBY2s7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY2suanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/handlers/ack.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/handlers/auth.js":
/*!******************************************************!*\
  !*** ./node_modules/mqtt/build/lib/handlers/auth.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst shared_1 = __webpack_require__(/*! ../shared */ \"(ssr)/./node_modules/mqtt/build/lib/shared.js\");\nconst ack_1 = __webpack_require__(/*! ./ack */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/ack.js\");\nconst handleAuth = (client, packet) => {\n    const { options } = client;\n    const version = options.protocolVersion;\n    const rc = version === 5 ? packet.reasonCode : packet.returnCode;\n    if (version !== 5) {\n        const err = new shared_1.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${version}`, rc);\n        client.emit('error', err);\n        return;\n    }\n    client.handleAuth(packet, (err, packet2) => {\n        if (err) {\n            client.emit('error', err);\n            return;\n        }\n        if (rc === 24) {\n            client.reconnecting = false;\n            client['_sendPacket'](packet2);\n        }\n        else {\n            const error = new shared_1.ErrorWithReasonCode(`Connection refused: ${ack_1.ReasonCodes[rc]}`, rc);\n            client.emit('error', error);\n        }\n    });\n};\nexports[\"default\"] = handleAuth;\n//# sourceMappingURL=auth.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaGFuZGxlcnMvYXV0aC5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxpQkFBaUIsbUJBQU8sQ0FBQyxnRUFBVztBQUNwQyxjQUFjLG1CQUFPLENBQUMsa0VBQU87QUFDN0I7QUFDQSxZQUFZLFVBQVU7QUFDdEI7QUFDQTtBQUNBO0FBQ0EsZ0lBQWdJLFFBQVE7QUFDeEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRkFBa0Ysc0JBQXNCO0FBQ3hHO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxrQkFBZTtBQUNmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29sZC1zdG9yYWdlLXN5c3RlbS8uL25vZGVfbW9kdWxlcy9tcXR0L2J1aWxkL2xpYi9oYW5kbGVycy9hdXRoLmpzP2IyMDAiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCBzaGFyZWRfMSA9IHJlcXVpcmUoXCIuLi9zaGFyZWRcIik7XG5jb25zdCBhY2tfMSA9IHJlcXVpcmUoXCIuL2Fja1wiKTtcbmNvbnN0IGhhbmRsZUF1dGggPSAoY2xpZW50LCBwYWNrZXQpID0+IHtcbiAgICBjb25zdCB7IG9wdGlvbnMgfSA9IGNsaWVudDtcbiAgICBjb25zdCB2ZXJzaW9uID0gb3B0aW9ucy5wcm90b2NvbFZlcnNpb247XG4gICAgY29uc3QgcmMgPSB2ZXJzaW9uID09PSA1ID8gcGFja2V0LnJlYXNvbkNvZGUgOiBwYWNrZXQucmV0dXJuQ29kZTtcbiAgICBpZiAodmVyc2lvbiAhPT0gNSkge1xuICAgICAgICBjb25zdCBlcnIgPSBuZXcgc2hhcmVkXzEuRXJyb3JXaXRoUmVhc29uQ29kZShgUHJvdG9jb2wgZXJyb3I6IEF1dGggcGFja2V0cyBhcmUgb25seSBzdXBwb3J0ZWQgaW4gTVFUVCA1LiBZb3VyIHZlcnNpb246JHt2ZXJzaW9ufWAsIHJjKTtcbiAgICAgICAgY2xpZW50LmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjbGllbnQuaGFuZGxlQXV0aChwYWNrZXQsIChlcnIsIHBhY2tldDIpID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY2xpZW50LmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmMgPT09IDI0KSB7XG4gICAgICAgICAgICBjbGllbnQucmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICBjbGllbnRbJ19zZW5kUGFja2V0J10ocGFja2V0Mik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBzaGFyZWRfMS5FcnJvcldpdGhSZWFzb25Db2RlKGBDb25uZWN0aW9uIHJlZnVzZWQ6ICR7YWNrXzEuUmVhc29uQ29kZXNbcmNdfWAsIHJjKTtcbiAgICAgICAgICAgIGNsaWVudC5lbWl0KCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbmV4cG9ydHMuZGVmYXVsdCA9IGhhbmRsZUF1dGg7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hdXRoLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/handlers/auth.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/handlers/connack.js":
/*!*********************************************************!*\
  !*** ./node_modules/mqtt/build/lib/handlers/connack.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst ack_1 = __webpack_require__(/*! ./ack */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/ack.js\");\nconst topic_alias_send_1 = __importDefault(__webpack_require__(/*! ../topic-alias-send */ \"(ssr)/./node_modules/mqtt/build/lib/topic-alias-send.js\"));\nconst shared_1 = __webpack_require__(/*! ../shared */ \"(ssr)/./node_modules/mqtt/build/lib/shared.js\");\nconst handleConnack = (client, packet) => {\n    client.log('_handleConnack');\n    const { options } = client;\n    const version = options.protocolVersion;\n    const rc = version === 5 ? packet.reasonCode : packet.returnCode;\n    clearTimeout(client['connackTimer']);\n    delete client['topicAliasSend'];\n    if (packet.properties) {\n        if (packet.properties.topicAliasMaximum) {\n            if (packet.properties.topicAliasMaximum > 0xffff) {\n                client.emit('error', new Error('topicAliasMaximum from broker is out of range'));\n                return;\n            }\n            if (packet.properties.topicAliasMaximum > 0) {\n                client['topicAliasSend'] = new topic_alias_send_1.default(packet.properties.topicAliasMaximum);\n            }\n        }\n        if (packet.properties.serverKeepAlive && options.keepalive) {\n            options.keepalive = packet.properties.serverKeepAlive;\n        }\n        if (packet.properties.maximumPacketSize) {\n            if (!options.properties) {\n                options.properties = {};\n            }\n            options.properties.maximumPacketSize =\n                packet.properties.maximumPacketSize;\n        }\n    }\n    if (rc === 0) {\n        client.reconnecting = false;\n        client['_onConnect'](packet);\n    }\n    else if (rc > 0) {\n        const err = new shared_1.ErrorWithReasonCode(`Connection refused: ${ack_1.ReasonCodes[rc]}`, rc);\n        client.emit('error', err);\n        if (client.options.reconnectOnConnackError) {\n            client['_cleanUp'](true);\n        }\n    }\n};\nexports[\"default\"] = handleConnack;\n//# sourceMappingURL=connack.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaGFuZGxlcnMvY29ubmFjay5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGNBQWMsbUJBQU8sQ0FBQyxrRUFBTztBQUM3QiwyQ0FBMkMsbUJBQU8sQ0FBQyxvRkFBcUI7QUFDeEUsaUJBQWlCLG1CQUFPLENBQUMsZ0VBQVc7QUFDcEM7QUFDQTtBQUNBLFlBQVksVUFBVTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0RUFBNEUsc0JBQXNCO0FBQ2xHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL2hhbmRsZXJzL2Nvbm5hY2suanM/NzNhMiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IGFja18xID0gcmVxdWlyZShcIi4vYWNrXCIpO1xuY29uc3QgdG9waWNfYWxpYXNfc2VuZF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi90b3BpYy1hbGlhcy1zZW5kXCIpKTtcbmNvbnN0IHNoYXJlZF8xID0gcmVxdWlyZShcIi4uL3NoYXJlZFwiKTtcbmNvbnN0IGhhbmRsZUNvbm5hY2sgPSAoY2xpZW50LCBwYWNrZXQpID0+IHtcbiAgICBjbGllbnQubG9nKCdfaGFuZGxlQ29ubmFjaycpO1xuICAgIGNvbnN0IHsgb3B0aW9ucyB9ID0gY2xpZW50O1xuICAgIGNvbnN0IHZlcnNpb24gPSBvcHRpb25zLnByb3RvY29sVmVyc2lvbjtcbiAgICBjb25zdCByYyA9IHZlcnNpb24gPT09IDUgPyBwYWNrZXQucmVhc29uQ29kZSA6IHBhY2tldC5yZXR1cm5Db2RlO1xuICAgIGNsZWFyVGltZW91dChjbGllbnRbJ2Nvbm5hY2tUaW1lciddKTtcbiAgICBkZWxldGUgY2xpZW50Wyd0b3BpY0FsaWFzU2VuZCddO1xuICAgIGlmIChwYWNrZXQucHJvcGVydGllcykge1xuICAgICAgICBpZiAocGFja2V0LnByb3BlcnRpZXMudG9waWNBbGlhc01heGltdW0pIHtcbiAgICAgICAgICAgIGlmIChwYWNrZXQucHJvcGVydGllcy50b3BpY0FsaWFzTWF4aW11bSA+IDB4ZmZmZikge1xuICAgICAgICAgICAgICAgIGNsaWVudC5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcigndG9waWNBbGlhc01heGltdW0gZnJvbSBicm9rZXIgaXMgb3V0IG9mIHJhbmdlJykpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYWNrZXQucHJvcGVydGllcy50b3BpY0FsaWFzTWF4aW11bSA+IDApIHtcbiAgICAgICAgICAgICAgICBjbGllbnRbJ3RvcGljQWxpYXNTZW5kJ10gPSBuZXcgdG9waWNfYWxpYXNfc2VuZF8xLmRlZmF1bHQocGFja2V0LnByb3BlcnRpZXMudG9waWNBbGlhc01heGltdW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwYWNrZXQucHJvcGVydGllcy5zZXJ2ZXJLZWVwQWxpdmUgJiYgb3B0aW9ucy5rZWVwYWxpdmUpIHtcbiAgICAgICAgICAgIG9wdGlvbnMua2VlcGFsaXZlID0gcGFja2V0LnByb3BlcnRpZXMuc2VydmVyS2VlcEFsaXZlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYWNrZXQucHJvcGVydGllcy5tYXhpbXVtUGFja2V0U2l6ZSkge1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zLnByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnByb3BlcnRpZXMgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wdGlvbnMucHJvcGVydGllcy5tYXhpbXVtUGFja2V0U2l6ZSA9XG4gICAgICAgICAgICAgICAgcGFja2V0LnByb3BlcnRpZXMubWF4aW11bVBhY2tldFNpemU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHJjID09PSAwKSB7XG4gICAgICAgIGNsaWVudC5yZWNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgY2xpZW50Wydfb25Db25uZWN0J10ocGFja2V0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAocmMgPiAwKSB7XG4gICAgICAgIGNvbnN0IGVyciA9IG5ldyBzaGFyZWRfMS5FcnJvcldpdGhSZWFzb25Db2RlKGBDb25uZWN0aW9uIHJlZnVzZWQ6ICR7YWNrXzEuUmVhc29uQ29kZXNbcmNdfWAsIHJjKTtcbiAgICAgICAgY2xpZW50LmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICAgICAgaWYgKGNsaWVudC5vcHRpb25zLnJlY29ubmVjdE9uQ29ubmFja0Vycm9yKSB7XG4gICAgICAgICAgICBjbGllbnRbJ19jbGVhblVwJ10odHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuZXhwb3J0cy5kZWZhdWx0ID0gaGFuZGxlQ29ubmFjaztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbm5hY2suanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/handlers/connack.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/handlers/index.js":
/*!*******************************************************!*\
  !*** ./node_modules/mqtt/build/lib/handlers/index.js ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst publish_1 = __importDefault(__webpack_require__(/*! ./publish */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/publish.js\"));\nconst auth_1 = __importDefault(__webpack_require__(/*! ./auth */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/auth.js\"));\nconst connack_1 = __importDefault(__webpack_require__(/*! ./connack */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/connack.js\"));\nconst ack_1 = __importDefault(__webpack_require__(/*! ./ack */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/ack.js\"));\nconst pubrel_1 = __importDefault(__webpack_require__(/*! ./pubrel */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/pubrel.js\"));\nconst handle = (client, packet, done) => {\n    const { options } = client;\n    if (options.protocolVersion === 5 &&\n        options.properties &&\n        options.properties.maximumPacketSize &&\n        options.properties.maximumPacketSize < packet.length) {\n        client.emit('error', new Error(`exceeding packets size ${packet.cmd}`));\n        client.end({\n            reasonCode: 149,\n            properties: { reasonString: 'Maximum packet size was exceeded' },\n        });\n        return client;\n    }\n    client.log('_handlePacket :: emitting packetreceive');\n    client.emit('packetreceive', packet);\n    switch (packet.cmd) {\n        case 'publish':\n            (0, publish_1.default)(client, packet, done);\n            break;\n        case 'puback':\n        case 'pubrec':\n        case 'pubcomp':\n        case 'suback':\n        case 'unsuback':\n            client.reschedulePing();\n            (0, ack_1.default)(client, packet);\n            done();\n            break;\n        case 'pubrel':\n            client.reschedulePing();\n            (0, pubrel_1.default)(client, packet, done);\n            break;\n        case 'connack':\n            (0, connack_1.default)(client, packet);\n            done();\n            break;\n        case 'auth':\n            client.reschedulePing();\n            (0, auth_1.default)(client, packet);\n            done();\n            break;\n        case 'pingresp':\n            client.log('_handlePacket :: received pingresp');\n            client.reschedulePing(true);\n            done();\n            break;\n        case 'disconnect':\n            client.emit('disconnect', packet);\n            done();\n            break;\n        default:\n            client.log('_handlePacket :: unknown command');\n            done();\n            break;\n    }\n};\nexports[\"default\"] = handle;\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaGFuZGxlcnMvaW5kZXguanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYjtBQUNBLDZDQUE2QztBQUM3QztBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxrQ0FBa0MsbUJBQU8sQ0FBQywwRUFBVztBQUNyRCwrQkFBK0IsbUJBQU8sQ0FBQyxvRUFBUTtBQUMvQyxrQ0FBa0MsbUJBQU8sQ0FBQywwRUFBVztBQUNyRCw4QkFBOEIsbUJBQU8sQ0FBQyxrRUFBTztBQUM3QyxpQ0FBaUMsbUJBQU8sQ0FBQyx3RUFBVTtBQUNuRDtBQUNBLFlBQVksVUFBVTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxXQUFXO0FBQzVFO0FBQ0E7QUFDQSwwQkFBMEIsa0RBQWtEO0FBQzVFLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBZTtBQUNmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29sZC1zdG9yYWdlLXN5c3RlbS8uL25vZGVfbW9kdWxlcy9tcXR0L2J1aWxkL2xpYi9oYW5kbGVycy9pbmRleC5qcz80ZDA0Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgcHVibGlzaF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL3B1Ymxpc2hcIikpO1xuY29uc3QgYXV0aF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL2F1dGhcIikpO1xuY29uc3QgY29ubmFja18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL2Nvbm5hY2tcIikpO1xuY29uc3QgYWNrXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vYWNrXCIpKTtcbmNvbnN0IHB1YnJlbF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL3B1YnJlbFwiKSk7XG5jb25zdCBoYW5kbGUgPSAoY2xpZW50LCBwYWNrZXQsIGRvbmUpID0+IHtcbiAgICBjb25zdCB7IG9wdGlvbnMgfSA9IGNsaWVudDtcbiAgICBpZiAob3B0aW9ucy5wcm90b2NvbFZlcnNpb24gPT09IDUgJiZcbiAgICAgICAgb3B0aW9ucy5wcm9wZXJ0aWVzICYmXG4gICAgICAgIG9wdGlvbnMucHJvcGVydGllcy5tYXhpbXVtUGFja2V0U2l6ZSAmJlxuICAgICAgICBvcHRpb25zLnByb3BlcnRpZXMubWF4aW11bVBhY2tldFNpemUgPCBwYWNrZXQubGVuZ3RoKSB7XG4gICAgICAgIGNsaWVudC5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcihgZXhjZWVkaW5nIHBhY2tldHMgc2l6ZSAke3BhY2tldC5jbWR9YCkpO1xuICAgICAgICBjbGllbnQuZW5kKHtcbiAgICAgICAgICAgIHJlYXNvbkNvZGU6IDE0OSxcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IHsgcmVhc29uU3RyaW5nOiAnTWF4aW11bSBwYWNrZXQgc2l6ZSB3YXMgZXhjZWVkZWQnIH0sXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2xpZW50O1xuICAgIH1cbiAgICBjbGllbnQubG9nKCdfaGFuZGxlUGFja2V0IDo6IGVtaXR0aW5nIHBhY2tldHJlY2VpdmUnKTtcbiAgICBjbGllbnQuZW1pdCgncGFja2V0cmVjZWl2ZScsIHBhY2tldCk7XG4gICAgc3dpdGNoIChwYWNrZXQuY21kKSB7XG4gICAgICAgIGNhc2UgJ3B1Ymxpc2gnOlxuICAgICAgICAgICAgKDAsIHB1Ymxpc2hfMS5kZWZhdWx0KShjbGllbnQsIHBhY2tldCwgZG9uZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncHViYWNrJzpcbiAgICAgICAgY2FzZSAncHVicmVjJzpcbiAgICAgICAgY2FzZSAncHViY29tcCc6XG4gICAgICAgIGNhc2UgJ3N1YmFjayc6XG4gICAgICAgIGNhc2UgJ3Vuc3ViYWNrJzpcbiAgICAgICAgICAgIGNsaWVudC5yZXNjaGVkdWxlUGluZygpO1xuICAgICAgICAgICAgKDAsIGFja18xLmRlZmF1bHQpKGNsaWVudCwgcGFja2V0KTtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdwdWJyZWwnOlxuICAgICAgICAgICAgY2xpZW50LnJlc2NoZWR1bGVQaW5nKCk7XG4gICAgICAgICAgICAoMCwgcHVicmVsXzEuZGVmYXVsdCkoY2xpZW50LCBwYWNrZXQsIGRvbmUpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2Nvbm5hY2snOlxuICAgICAgICAgICAgKDAsIGNvbm5hY2tfMS5kZWZhdWx0KShjbGllbnQsIHBhY2tldCk7XG4gICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnYXV0aCc6XG4gICAgICAgICAgICBjbGllbnQucmVzY2hlZHVsZVBpbmcoKTtcbiAgICAgICAgICAgICgwLCBhdXRoXzEuZGVmYXVsdCkoY2xpZW50LCBwYWNrZXQpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3BpbmdyZXNwJzpcbiAgICAgICAgICAgIGNsaWVudC5sb2coJ19oYW5kbGVQYWNrZXQgOjogcmVjZWl2ZWQgcGluZ3Jlc3AnKTtcbiAgICAgICAgICAgIGNsaWVudC5yZXNjaGVkdWxlUGluZyh0cnVlKTtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkaXNjb25uZWN0JzpcbiAgICAgICAgICAgIGNsaWVudC5lbWl0KCdkaXNjb25uZWN0JywgcGFja2V0KTtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2xpZW50LmxvZygnX2hhbmRsZVBhY2tldCA6OiB1bmtub3duIGNvbW1hbmQnKTtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn07XG5leHBvcnRzLmRlZmF1bHQgPSBoYW5kbGU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/handlers/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/handlers/publish.js":
/*!*********************************************************!*\
  !*** ./node_modules/mqtt/build/lib/handlers/publish.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst validReasonCodes = [0, 16, 128, 131, 135, 144, 145, 151, 153];\nconst handlePublish = (client, packet, done) => {\n    client.log('handlePublish: packet %o', packet);\n    done = typeof done !== 'undefined' ? done : client.noop;\n    let topic = packet.topic.toString();\n    const message = packet.payload;\n    const { qos } = packet;\n    const { messageId } = packet;\n    const { options } = client;\n    if (client.options.protocolVersion === 5) {\n        let alias;\n        if (packet.properties) {\n            alias = packet.properties.topicAlias;\n        }\n        if (typeof alias !== 'undefined') {\n            if (topic.length === 0) {\n                if (alias > 0 && alias <= 0xffff) {\n                    const gotTopic = client['topicAliasRecv'].getTopicByAlias(alias);\n                    if (gotTopic) {\n                        topic = gotTopic;\n                        client.log('handlePublish :: topic complemented by alias. topic: %s - alias: %d', topic, alias);\n                    }\n                    else {\n                        client.log('handlePublish :: unregistered topic alias. alias: %d', alias);\n                        client.emit('error', new Error('Received unregistered Topic Alias'));\n                        return;\n                    }\n                }\n                else {\n                    client.log('handlePublish :: topic alias out of range. alias: %d', alias);\n                    client.emit('error', new Error('Received Topic Alias is out of range'));\n                    return;\n                }\n            }\n            else if (client['topicAliasRecv'].put(topic, alias)) {\n                client.log('handlePublish :: registered topic: %s - alias: %d', topic, alias);\n            }\n            else {\n                client.log('handlePublish :: topic alias out of range. alias: %d', alias);\n                client.emit('error', new Error('Received Topic Alias is out of range'));\n                return;\n            }\n        }\n    }\n    client.log('handlePublish: qos %d', qos);\n    switch (qos) {\n        case 2: {\n            options.customHandleAcks(topic, message, packet, (error, code) => {\n                if (typeof error === 'number') {\n                    code = error;\n                    error = null;\n                }\n                if (error) {\n                    return client.emit('error', error);\n                }\n                if (validReasonCodes.indexOf(code) === -1) {\n                    return client.emit('error', new Error('Wrong reason code for pubrec'));\n                }\n                if (code) {\n                    client['_sendPacket']({ cmd: 'pubrec', messageId, reasonCode: code }, done);\n                }\n                else {\n                    client.incomingStore.put(packet, () => {\n                        client['_sendPacket']({ cmd: 'pubrec', messageId }, done);\n                    });\n                }\n            });\n            break;\n        }\n        case 1: {\n            options.customHandleAcks(topic, message, packet, (error, code) => {\n                if (typeof error === 'number') {\n                    code = error;\n                    error = null;\n                }\n                if (error) {\n                    return client.emit('error', error);\n                }\n                if (validReasonCodes.indexOf(code) === -1) {\n                    return client.emit('error', new Error('Wrong reason code for puback'));\n                }\n                if (!code) {\n                    client.emit('message', topic, message, packet);\n                }\n                client.handleMessage(packet, (err) => {\n                    if (err) {\n                        return done && done(err);\n                    }\n                    client['_sendPacket']({ cmd: 'puback', messageId, reasonCode: code }, done);\n                });\n            });\n            break;\n        }\n        case 0:\n            client.emit('message', topic, message, packet);\n            client.handleMessage(packet, done);\n            break;\n        default:\n            client.log('handlePublish: unknown QoS. Doing nothing.');\n            break;\n    }\n};\nexports[\"default\"] = handlePublish;\n//# sourceMappingURL=publish.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaGFuZGxlcnMvcHVibGlzaC5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLE1BQU07QUFDbEIsWUFBWSxZQUFZO0FBQ3hCLFlBQVksVUFBVTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLDRDQUE0QztBQUN4RjtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsMEJBQTBCO0FBQzFFLHFCQUFxQjtBQUNyQjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsNENBQTRDO0FBQ3hGLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL2hhbmRsZXJzL3B1Ymxpc2guanM/MmFiZSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IHZhbGlkUmVhc29uQ29kZXMgPSBbMCwgMTYsIDEyOCwgMTMxLCAxMzUsIDE0NCwgMTQ1LCAxNTEsIDE1M107XG5jb25zdCBoYW5kbGVQdWJsaXNoID0gKGNsaWVudCwgcGFja2V0LCBkb25lKSA9PiB7XG4gICAgY2xpZW50LmxvZygnaGFuZGxlUHVibGlzaDogcGFja2V0ICVvJywgcGFja2V0KTtcbiAgICBkb25lID0gdHlwZW9mIGRvbmUgIT09ICd1bmRlZmluZWQnID8gZG9uZSA6IGNsaWVudC5ub29wO1xuICAgIGxldCB0b3BpYyA9IHBhY2tldC50b3BpYy50b1N0cmluZygpO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBwYWNrZXQucGF5bG9hZDtcbiAgICBjb25zdCB7IHFvcyB9ID0gcGFja2V0O1xuICAgIGNvbnN0IHsgbWVzc2FnZUlkIH0gPSBwYWNrZXQ7XG4gICAgY29uc3QgeyBvcHRpb25zIH0gPSBjbGllbnQ7XG4gICAgaWYgKGNsaWVudC5vcHRpb25zLnByb3RvY29sVmVyc2lvbiA9PT0gNSkge1xuICAgICAgICBsZXQgYWxpYXM7XG4gICAgICAgIGlmIChwYWNrZXQucHJvcGVydGllcykge1xuICAgICAgICAgICAgYWxpYXMgPSBwYWNrZXQucHJvcGVydGllcy50b3BpY0FsaWFzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgYWxpYXMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpZiAodG9waWMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFsaWFzID4gMCAmJiBhbGlhcyA8PSAweGZmZmYpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ290VG9waWMgPSBjbGllbnRbJ3RvcGljQWxpYXNSZWN2J10uZ2V0VG9waWNCeUFsaWFzKGFsaWFzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdvdFRvcGljKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3BpYyA9IGdvdFRvcGljO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50LmxvZygnaGFuZGxlUHVibGlzaCA6OiB0b3BpYyBjb21wbGVtZW50ZWQgYnkgYWxpYXMuIHRvcGljOiAlcyAtIGFsaWFzOiAlZCcsIHRvcGljLCBhbGlhcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQubG9nKCdoYW5kbGVQdWJsaXNoIDo6IHVucmVnaXN0ZXJlZCB0b3BpYyBhbGlhcy4gYWxpYXM6ICVkJywgYWxpYXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50LmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdSZWNlaXZlZCB1bnJlZ2lzdGVyZWQgVG9waWMgQWxpYXMnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5sb2coJ2hhbmRsZVB1Ymxpc2ggOjogdG9waWMgYWxpYXMgb3V0IG9mIHJhbmdlLiBhbGlhczogJWQnLCBhbGlhcyk7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignUmVjZWl2ZWQgVG9waWMgQWxpYXMgaXMgb3V0IG9mIHJhbmdlJykpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY2xpZW50Wyd0b3BpY0FsaWFzUmVjdiddLnB1dCh0b3BpYywgYWxpYXMpKSB7XG4gICAgICAgICAgICAgICAgY2xpZW50LmxvZygnaGFuZGxlUHVibGlzaCA6OiByZWdpc3RlcmVkIHRvcGljOiAlcyAtIGFsaWFzOiAlZCcsIHRvcGljLCBhbGlhcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbGllbnQubG9nKCdoYW5kbGVQdWJsaXNoIDo6IHRvcGljIGFsaWFzIG91dCBvZiByYW5nZS4gYWxpYXM6ICVkJywgYWxpYXMpO1xuICAgICAgICAgICAgICAgIGNsaWVudC5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignUmVjZWl2ZWQgVG9waWMgQWxpYXMgaXMgb3V0IG9mIHJhbmdlJykpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbGllbnQubG9nKCdoYW5kbGVQdWJsaXNoOiBxb3MgJWQnLCBxb3MpO1xuICAgIHN3aXRjaCAocW9zKSB7XG4gICAgICAgIGNhc2UgMjoge1xuICAgICAgICAgICAgb3B0aW9ucy5jdXN0b21IYW5kbGVBY2tzKHRvcGljLCBtZXNzYWdlLCBwYWNrZXQsIChlcnJvciwgY29kZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyb3IgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvZGUgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsaWVudC5lbWl0KCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZhbGlkUmVhc29uQ29kZXMuaW5kZXhPZihjb2RlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsaWVudC5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignV3JvbmcgcmVhc29uIGNvZGUgZm9yIHB1YnJlYycpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Wydfc2VuZFBhY2tldCddKHsgY21kOiAncHVicmVjJywgbWVzc2FnZUlkLCByZWFzb25Db2RlOiBjb2RlIH0sIGRvbmUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50LmluY29taW5nU3RvcmUucHV0KHBhY2tldCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50Wydfc2VuZFBhY2tldCddKHsgY21kOiAncHVicmVjJywgbWVzc2FnZUlkIH0sIGRvbmUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgICAgb3B0aW9ucy5jdXN0b21IYW5kbGVBY2tzKHRvcGljLCBtZXNzYWdlLCBwYWNrZXQsIChlcnJvciwgY29kZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyb3IgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvZGUgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsaWVudC5lbWl0KCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZhbGlkUmVhc29uQ29kZXMuaW5kZXhPZihjb2RlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsaWVudC5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignV3JvbmcgcmVhc29uIGNvZGUgZm9yIHB1YmFjaycpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5lbWl0KCdtZXNzYWdlJywgdG9waWMsIG1lc3NhZ2UsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNsaWVudC5oYW5kbGVNZXNzYWdlKHBhY2tldCwgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9uZSAmJiBkb25lKGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Wydfc2VuZFBhY2tldCddKHsgY21kOiAncHViYWNrJywgbWVzc2FnZUlkLCByZWFzb25Db2RlOiBjb2RlIH0sIGRvbmUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBjbGllbnQuZW1pdCgnbWVzc2FnZScsIHRvcGljLCBtZXNzYWdlLCBwYWNrZXQpO1xuICAgICAgICAgICAgY2xpZW50LmhhbmRsZU1lc3NhZ2UocGFja2V0LCBkb25lKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2xpZW50LmxvZygnaGFuZGxlUHVibGlzaDogdW5rbm93biBRb1MuIERvaW5nIG5vdGhpbmcuJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG59O1xuZXhwb3J0cy5kZWZhdWx0ID0gaGFuZGxlUHVibGlzaDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXB1Ymxpc2guanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/handlers/publish.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/handlers/pubrel.js":
/*!********************************************************!*\
  !*** ./node_modules/mqtt/build/lib/handlers/pubrel.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst handlePubrel = (client, packet, done) => {\n    client.log('handling pubrel packet');\n    const callback = typeof done !== 'undefined' ? done : client.noop;\n    const { messageId } = packet;\n    const comp = { cmd: 'pubcomp', messageId };\n    client.incomingStore.get(packet, (err, pub) => {\n        if (!err) {\n            client.emit('message', pub.topic, pub.payload, pub);\n            client.handleMessage(pub, (err2) => {\n                if (err2) {\n                    return callback(err2);\n                }\n                client.incomingStore.del(pub, client.noop);\n                client['_sendPacket'](comp, callback);\n            });\n        }\n        else {\n            client['_sendPacket'](comp, callback);\n        }\n    });\n};\nexports[\"default\"] = handlePubrel;\n//# sourceMappingURL=pubrel.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaGFuZGxlcnMvcHVicmVsLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdEO0FBQ0E7QUFDQTtBQUNBLFlBQVksWUFBWTtBQUN4QixtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esa0JBQWU7QUFDZiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaGFuZGxlcnMvcHVicmVsLmpzP2IxNTkiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCBoYW5kbGVQdWJyZWwgPSAoY2xpZW50LCBwYWNrZXQsIGRvbmUpID0+IHtcbiAgICBjbGllbnQubG9nKCdoYW5kbGluZyBwdWJyZWwgcGFja2V0Jyk7XG4gICAgY29uc3QgY2FsbGJhY2sgPSB0eXBlb2YgZG9uZSAhPT0gJ3VuZGVmaW5lZCcgPyBkb25lIDogY2xpZW50Lm5vb3A7XG4gICAgY29uc3QgeyBtZXNzYWdlSWQgfSA9IHBhY2tldDtcbiAgICBjb25zdCBjb21wID0geyBjbWQ6ICdwdWJjb21wJywgbWVzc2FnZUlkIH07XG4gICAgY2xpZW50LmluY29taW5nU3RvcmUuZ2V0KHBhY2tldCwgKGVyciwgcHViKSA9PiB7XG4gICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICBjbGllbnQuZW1pdCgnbWVzc2FnZScsIHB1Yi50b3BpYywgcHViLnBheWxvYWQsIHB1Yik7XG4gICAgICAgICAgICBjbGllbnQuaGFuZGxlTWVzc2FnZShwdWIsIChlcnIyKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVycjIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycjIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjbGllbnQuaW5jb21pbmdTdG9yZS5kZWwocHViLCBjbGllbnQubm9vcCk7XG4gICAgICAgICAgICAgICAgY2xpZW50Wydfc2VuZFBhY2tldCddKGNvbXAsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY2xpZW50Wydfc2VuZFBhY2tldCddKGNvbXAsIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbmV4cG9ydHMuZGVmYXVsdCA9IGhhbmRsZVB1YnJlbDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXB1YnJlbC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/handlers/pubrel.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/is-browser.js":
/*!***************************************************!*\
  !*** ./node_modules/mqtt/build/lib/is-browser.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.isReactNativeBrowser = exports.isWebWorker = void 0;\nconst isStandardBrowserEnv = () => {\n    if (typeof window !== 'undefined') {\n        const electronRenderCheck = typeof navigator !== 'undefined' &&\n            navigator.userAgent?.toLowerCase().indexOf(' electron/') > -1;\n        if (electronRenderCheck && process?.versions) {\n            const electronMainCheck = Object.prototype.hasOwnProperty.call(process.versions, 'electron');\n            return !electronMainCheck;\n        }\n        return typeof window.document !== 'undefined';\n    }\n    return false;\n};\nconst isWebWorkerEnv = () => Boolean(typeof self === 'object' &&\n    self?.constructor?.name?.includes('WorkerGlobalScope') &&\n    typeof Deno === 'undefined');\nconst isReactNativeEnv = () => typeof navigator !== 'undefined' && navigator.product === 'ReactNative';\nconst isBrowser = isStandardBrowserEnv() || isWebWorkerEnv() || isReactNativeEnv();\nexports.isWebWorker = isWebWorkerEnv();\nexports.isReactNativeBrowser = isReactNativeEnv();\nexports[\"default\"] = isBrowser;\n//# sourceMappingURL=is-browser.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaXMtYnJvd3Nlci5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCw0QkFBNEIsR0FBRyxtQkFBbUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQiw0QkFBNEI7QUFDNUIsa0JBQWU7QUFDZiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvaXMtYnJvd3Nlci5qcz9mZjU3Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5pc1JlYWN0TmF0aXZlQnJvd3NlciA9IGV4cG9ydHMuaXNXZWJXb3JrZXIgPSB2b2lkIDA7XG5jb25zdCBpc1N0YW5kYXJkQnJvd3NlckVudiA9ICgpID0+IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgY29uc3QgZWxlY3Ryb25SZW5kZXJDaGVjayA9IHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Py50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJyBlbGVjdHJvbi8nKSA+IC0xO1xuICAgICAgICBpZiAoZWxlY3Ryb25SZW5kZXJDaGVjayAmJiBwcm9jZXNzPy52ZXJzaW9ucykge1xuICAgICAgICAgICAgY29uc3QgZWxlY3Ryb25NYWluQ2hlY2sgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocHJvY2Vzcy52ZXJzaW9ucywgJ2VsZWN0cm9uJyk7XG4gICAgICAgICAgICByZXR1cm4gIWVsZWN0cm9uTWFpbkNoZWNrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0eXBlb2Ygd2luZG93LmRvY3VtZW50ICE9PSAndW5kZWZpbmVkJztcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcbmNvbnN0IGlzV2ViV29ya2VyRW52ID0gKCkgPT4gQm9vbGVhbih0eXBlb2Ygc2VsZiA9PT0gJ29iamVjdCcgJiZcbiAgICBzZWxmPy5jb25zdHJ1Y3Rvcj8ubmFtZT8uaW5jbHVkZXMoJ1dvcmtlckdsb2JhbFNjb3BlJykgJiZcbiAgICB0eXBlb2YgRGVubyA9PT0gJ3VuZGVmaW5lZCcpO1xuY29uc3QgaXNSZWFjdE5hdGl2ZUVudiA9ICgpID0+IHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci5wcm9kdWN0ID09PSAnUmVhY3ROYXRpdmUnO1xuY29uc3QgaXNCcm93c2VyID0gaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSB8fCBpc1dlYldvcmtlckVudigpIHx8IGlzUmVhY3ROYXRpdmVFbnYoKTtcbmV4cG9ydHMuaXNXZWJXb3JrZXIgPSBpc1dlYldvcmtlckVudigpO1xuZXhwb3J0cy5pc1JlYWN0TmF0aXZlQnJvd3NlciA9IGlzUmVhY3ROYXRpdmVFbnYoKTtcbmV4cG9ydHMuZGVmYXVsdCA9IGlzQnJvd3Nlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzLWJyb3dzZXIuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/is-browser.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/shared.js":
/*!***********************************************!*\
  !*** ./node_modules/mqtt/build/lib/shared.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.MQTTJS_VERSION = exports.nextTick = exports.ErrorWithSubackPacket = exports.ErrorWithReasonCode = void 0;\nexports.applyMixin = applyMixin;\nclass ErrorWithReasonCode extends Error {\n    code;\n    constructor(message, code) {\n        super(message);\n        this.code = code;\n        Object.setPrototypeOf(this, ErrorWithReasonCode.prototype);\n        Object.getPrototypeOf(this).name = 'ErrorWithReasonCode';\n    }\n}\nexports.ErrorWithReasonCode = ErrorWithReasonCode;\nclass ErrorWithSubackPacket extends Error {\n    packet;\n    constructor(message, packet) {\n        super(message);\n        this.packet = packet;\n        Object.setPrototypeOf(this, ErrorWithSubackPacket.prototype);\n        Object.getPrototypeOf(this).name = 'ErrorWithSubackPacket';\n    }\n}\nexports.ErrorWithSubackPacket = ErrorWithSubackPacket;\nfunction applyMixin(target, mixin, includeConstructor = false) {\n    const inheritanceChain = [mixin];\n    while (true) {\n        const current = inheritanceChain[0];\n        const base = Object.getPrototypeOf(current);\n        if (base?.prototype) {\n            inheritanceChain.unshift(base);\n        }\n        else {\n            break;\n        }\n    }\n    for (const ctor of inheritanceChain) {\n        for (const prop of Object.getOwnPropertyNames(ctor.prototype)) {\n            if (includeConstructor || prop !== 'constructor') {\n                Object.defineProperty(target.prototype, prop, Object.getOwnPropertyDescriptor(ctor.prototype, prop) ??\n                    Object.create(null));\n            }\n        }\n    }\n}\nexports.nextTick = typeof process?.nextTick === 'function'\n    ? process.nextTick\n    : (callback) => {\n        setTimeout(callback, 0);\n    };\nexports.MQTTJS_VERSION = __webpack_require__(/*! ../../package.json */ \"(ssr)/./node_modules/mqtt/package.json\").version;\n//# sourceMappingURL=shared.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvc2hhcmVkLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHNCQUFzQixHQUFHLGdCQUFnQixHQUFHLDZCQUE2QixHQUFHLDJCQUEyQjtBQUN2RyxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3SEFBOEQ7QUFDOUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL3NoYXJlZC5qcz9lZTk1Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5NUVRUSlNfVkVSU0lPTiA9IGV4cG9ydHMubmV4dFRpY2sgPSBleHBvcnRzLkVycm9yV2l0aFN1YmFja1BhY2tldCA9IGV4cG9ydHMuRXJyb3JXaXRoUmVhc29uQ29kZSA9IHZvaWQgMDtcbmV4cG9ydHMuYXBwbHlNaXhpbiA9IGFwcGx5TWl4aW47XG5jbGFzcyBFcnJvcldpdGhSZWFzb25Db2RlIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvZGU7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSwgY29kZSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIEVycm9yV2l0aFJlYXNvbkNvZGUucHJvdG90eXBlKTtcbiAgICAgICAgT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLm5hbWUgPSAnRXJyb3JXaXRoUmVhc29uQ29kZSc7XG4gICAgfVxufVxuZXhwb3J0cy5FcnJvcldpdGhSZWFzb25Db2RlID0gRXJyb3JXaXRoUmVhc29uQ29kZTtcbmNsYXNzIEVycm9yV2l0aFN1YmFja1BhY2tldCBleHRlbmRzIEVycm9yIHtcbiAgICBwYWNrZXQ7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSwgcGFja2V0KSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLnBhY2tldCA9IHBhY2tldDtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIEVycm9yV2l0aFN1YmFja1BhY2tldC5wcm90b3R5cGUpO1xuICAgICAgICBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykubmFtZSA9ICdFcnJvcldpdGhTdWJhY2tQYWNrZXQnO1xuICAgIH1cbn1cbmV4cG9ydHMuRXJyb3JXaXRoU3ViYWNrUGFja2V0ID0gRXJyb3JXaXRoU3ViYWNrUGFja2V0O1xuZnVuY3Rpb24gYXBwbHlNaXhpbih0YXJnZXQsIG1peGluLCBpbmNsdWRlQ29uc3RydWN0b3IgPSBmYWxzZSkge1xuICAgIGNvbnN0IGluaGVyaXRhbmNlQ2hhaW4gPSBbbWl4aW5dO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSBpbmhlcml0YW5jZUNoYWluWzBdO1xuICAgICAgICBjb25zdCBiYXNlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGN1cnJlbnQpO1xuICAgICAgICBpZiAoYmFzZT8ucHJvdG90eXBlKSB7XG4gICAgICAgICAgICBpbmhlcml0YW5jZUNoYWluLnVuc2hpZnQoYmFzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGN0b3Igb2YgaW5oZXJpdGFuY2VDaGFpbikge1xuICAgICAgICBmb3IgKGNvbnN0IHByb3Agb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoY3Rvci5wcm90b3R5cGUpKSB7XG4gICAgICAgICAgICBpZiAoaW5jbHVkZUNvbnN0cnVjdG9yIHx8IHByb3AgIT09ICdjb25zdHJ1Y3RvcicpIHtcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LnByb3RvdHlwZSwgcHJvcCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihjdG9yLnByb3RvdHlwZSwgcHJvcCkgPz9cbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmNyZWF0ZShudWxsKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLm5leHRUaWNrID0gdHlwZW9mIHByb2Nlc3M/Lm5leHRUaWNrID09PSAnZnVuY3Rpb24nXG4gICAgPyBwcm9jZXNzLm5leHRUaWNrXG4gICAgOiAoY2FsbGJhY2spID0+IHtcbiAgICAgICAgc2V0VGltZW91dChjYWxsYmFjaywgMCk7XG4gICAgfTtcbmV4cG9ydHMuTVFUVEpTX1ZFUlNJT04gPSByZXF1aXJlKCcuLi8uLi9wYWNrYWdlLmpzb24nKS52ZXJzaW9uO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2hhcmVkLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/shared.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/store.js":
/*!**********************************************!*\
  !*** ./node_modules/mqtt/build/lib/store.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst readable_stream_1 = __webpack_require__(/*! readable-stream */ \"(ssr)/./node_modules/readable-stream/lib/ours/index.js\");\nconst streamsOpts = { objectMode: true };\nconst defaultStoreOptions = {\n    clean: true,\n};\nclass Store {\n    options;\n    _inflights;\n    constructor(options) {\n        this.options = options || {};\n        this.options = { ...defaultStoreOptions, ...options };\n        this._inflights = new Map();\n    }\n    put(packet, cb) {\n        this._inflights.set(packet.messageId, packet);\n        if (cb) {\n            cb();\n        }\n        return this;\n    }\n    createStream() {\n        const stream = new readable_stream_1.Readable(streamsOpts);\n        const values = [];\n        let destroyed = false;\n        let i = 0;\n        this._inflights.forEach((value, key) => {\n            values.push(value);\n        });\n        stream._read = () => {\n            if (!destroyed && i < values.length) {\n                stream.push(values[i++]);\n            }\n            else {\n                stream.push(null);\n            }\n        };\n        stream.destroy = (err) => {\n            if (destroyed) {\n                return;\n            }\n            destroyed = true;\n            setTimeout(() => {\n                stream.emit('close');\n            }, 0);\n            return stream;\n        };\n        return stream;\n    }\n    del(packet, cb) {\n        const toDelete = this._inflights.get(packet.messageId);\n        if (toDelete) {\n            this._inflights.delete(packet.messageId);\n            cb(null, toDelete);\n        }\n        else if (cb) {\n            cb(new Error('missing packet'));\n        }\n        return this;\n    }\n    get(packet, cb) {\n        const storedPacket = this._inflights.get(packet.messageId);\n        if (storedPacket) {\n            cb(null, storedPacket);\n        }\n        else if (cb) {\n            cb(new Error('missing packet'));\n        }\n        return this;\n    }\n    close(cb) {\n        if (this.options.clean) {\n            this._inflights = null;\n        }\n        if (cb) {\n            cb();\n        }\n    }\n}\nexports[\"default\"] = Store;\n//# sourceMappingURL=store.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvc3RvcmUuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsMEJBQTBCLG1CQUFPLENBQUMsK0VBQWlCO0FBQ25ELHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFlO0FBQ2YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL3N0b3JlLmpzP2U4ZDYiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCByZWFkYWJsZV9zdHJlYW1fMSA9IHJlcXVpcmUoXCJyZWFkYWJsZS1zdHJlYW1cIik7XG5jb25zdCBzdHJlYW1zT3B0cyA9IHsgb2JqZWN0TW9kZTogdHJ1ZSB9O1xuY29uc3QgZGVmYXVsdFN0b3JlT3B0aW9ucyA9IHtcbiAgICBjbGVhbjogdHJ1ZSxcbn07XG5jbGFzcyBTdG9yZSB7XG4gICAgb3B0aW9ucztcbiAgICBfaW5mbGlnaHRzO1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0geyAuLi5kZWZhdWx0U3RvcmVPcHRpb25zLCAuLi5vcHRpb25zIH07XG4gICAgICAgIHRoaXMuX2luZmxpZ2h0cyA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgcHV0KHBhY2tldCwgY2IpIHtcbiAgICAgICAgdGhpcy5faW5mbGlnaHRzLnNldChwYWNrZXQubWVzc2FnZUlkLCBwYWNrZXQpO1xuICAgICAgICBpZiAoY2IpIHtcbiAgICAgICAgICAgIGNiKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGNyZWF0ZVN0cmVhbSgpIHtcbiAgICAgICAgY29uc3Qgc3RyZWFtID0gbmV3IHJlYWRhYmxlX3N0cmVhbV8xLlJlYWRhYmxlKHN0cmVhbXNPcHRzKTtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgICAgIGxldCBkZXN0cm95ZWQgPSBmYWxzZTtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICB0aGlzLl9pbmZsaWdodHMuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4ge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgc3RyZWFtLl9yZWFkID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFkZXN0cm95ZWQgJiYgaSA8IHZhbHVlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBzdHJlYW0ucHVzaCh2YWx1ZXNbaSsrXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHJlYW0ucHVzaChudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgc3RyZWFtLmRlc3Ryb3kgPSAoZXJyKSA9PiB7XG4gICAgICAgICAgICBpZiAoZGVzdHJveWVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHN0cmVhbS5lbWl0KCdjbG9zZScpO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICByZXR1cm4gc3RyZWFtO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3RyZWFtO1xuICAgIH1cbiAgICBkZWwocGFja2V0LCBjYikge1xuICAgICAgICBjb25zdCB0b0RlbGV0ZSA9IHRoaXMuX2luZmxpZ2h0cy5nZXQocGFja2V0Lm1lc3NhZ2VJZCk7XG4gICAgICAgIGlmICh0b0RlbGV0ZSkge1xuICAgICAgICAgICAgdGhpcy5faW5mbGlnaHRzLmRlbGV0ZShwYWNrZXQubWVzc2FnZUlkKTtcbiAgICAgICAgICAgIGNiKG51bGwsIHRvRGVsZXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjYikge1xuICAgICAgICAgICAgY2IobmV3IEVycm9yKCdtaXNzaW5nIHBhY2tldCcpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0KHBhY2tldCwgY2IpIHtcbiAgICAgICAgY29uc3Qgc3RvcmVkUGFja2V0ID0gdGhpcy5faW5mbGlnaHRzLmdldChwYWNrZXQubWVzc2FnZUlkKTtcbiAgICAgICAgaWYgKHN0b3JlZFBhY2tldCkge1xuICAgICAgICAgICAgY2IobnVsbCwgc3RvcmVkUGFja2V0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjYikge1xuICAgICAgICAgICAgY2IobmV3IEVycm9yKCdtaXNzaW5nIHBhY2tldCcpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgY2xvc2UoY2IpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jbGVhbikge1xuICAgICAgICAgICAgdGhpcy5faW5mbGlnaHRzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2IpIHtcbiAgICAgICAgICAgIGNiKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLmRlZmF1bHQgPSBTdG9yZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0b3JlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/store.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/topic-alias-recv.js":
/*!*********************************************************!*\
  !*** ./node_modules/mqtt/build/lib/topic-alias-recv.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nclass TopicAliasRecv {\n    aliasToTopic;\n    max;\n    length;\n    constructor(max) {\n        this.aliasToTopic = {};\n        this.max = max;\n    }\n    put(topic, alias) {\n        if (alias === 0 || alias > this.max) {\n            return false;\n        }\n        this.aliasToTopic[alias] = topic;\n        this.length = Object.keys(this.aliasToTopic).length;\n        return true;\n    }\n    getTopicByAlias(alias) {\n        return this.aliasToTopic[alias];\n    }\n    clear() {\n        this.aliasToTopic = {};\n    }\n}\nexports[\"default\"] = TopicAliasRecv;\n//# sourceMappingURL=topic-alias-recv.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvdG9waWMtYWxpYXMtcmVjdi5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWU7QUFDZiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvdG9waWMtYWxpYXMtcmVjdi5qcz8zYjQwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY2xhc3MgVG9waWNBbGlhc1JlY3Yge1xuICAgIGFsaWFzVG9Ub3BpYztcbiAgICBtYXg7XG4gICAgbGVuZ3RoO1xuICAgIGNvbnN0cnVjdG9yKG1heCkge1xuICAgICAgICB0aGlzLmFsaWFzVG9Ub3BpYyA9IHt9O1xuICAgICAgICB0aGlzLm1heCA9IG1heDtcbiAgICB9XG4gICAgcHV0KHRvcGljLCBhbGlhcykge1xuICAgICAgICBpZiAoYWxpYXMgPT09IDAgfHwgYWxpYXMgPiB0aGlzLm1heCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWxpYXNUb1RvcGljW2FsaWFzXSA9IHRvcGljO1xuICAgICAgICB0aGlzLmxlbmd0aCA9IE9iamVjdC5rZXlzKHRoaXMuYWxpYXNUb1RvcGljKS5sZW5ndGg7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBnZXRUb3BpY0J5QWxpYXMoYWxpYXMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxpYXNUb1RvcGljW2FsaWFzXTtcbiAgICB9XG4gICAgY2xlYXIoKSB7XG4gICAgICAgIHRoaXMuYWxpYXNUb1RvcGljID0ge307XG4gICAgfVxufVxuZXhwb3J0cy5kZWZhdWx0ID0gVG9waWNBbGlhc1JlY3Y7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10b3BpYy1hbGlhcy1yZWN2LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/topic-alias-recv.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/topic-alias-send.js":
/*!*********************************************************!*\
  !*** ./node_modules/mqtt/build/lib/topic-alias-send.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst lru_cache_1 = __webpack_require__(/*! lru-cache */ \"(ssr)/./node_modules/lru-cache/dist/commonjs/index.js\");\nconst number_allocator_1 = __webpack_require__(/*! number-allocator */ \"(ssr)/./node_modules/number-allocator/index.js\");\nclass TopicAliasSend {\n    aliasToTopic;\n    topicToAlias;\n    max;\n    numberAllocator;\n    length;\n    constructor(max) {\n        if (max > 0) {\n            this.aliasToTopic = new lru_cache_1.LRUCache({ max });\n            this.topicToAlias = {};\n            this.numberAllocator = new number_allocator_1.NumberAllocator(1, max);\n            this.max = max;\n            this.length = 0;\n        }\n    }\n    put(topic, alias) {\n        if (alias === 0 || alias > this.max) {\n            return false;\n        }\n        const entry = this.aliasToTopic.get(alias);\n        if (entry) {\n            delete this.topicToAlias[entry];\n        }\n        this.aliasToTopic.set(alias, topic);\n        this.topicToAlias[topic] = alias;\n        this.numberAllocator.use(alias);\n        this.length = this.aliasToTopic.size;\n        return true;\n    }\n    getTopicByAlias(alias) {\n        return this.aliasToTopic.get(alias);\n    }\n    getAliasByTopic(topic) {\n        const alias = this.topicToAlias[topic];\n        if (typeof alias !== 'undefined') {\n            this.aliasToTopic.get(alias);\n        }\n        return alias;\n    }\n    clear() {\n        this.aliasToTopic.clear();\n        this.topicToAlias = {};\n        this.numberAllocator.clear();\n        this.length = 0;\n    }\n    getLruAlias() {\n        const alias = this.numberAllocator.firstVacant();\n        if (alias)\n            return alias;\n        return [...this.aliasToTopic.keys()][this.aliasToTopic.size - 1];\n    }\n}\nexports[\"default\"] = TopicAliasSend;\n//# sourceMappingURL=topic-alias-send.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvdG9waWMtYWxpYXMtc2VuZC5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxvQkFBb0IsbUJBQU8sQ0FBQyx3RUFBVztBQUN2QywyQkFBMkIsbUJBQU8sQ0FBQyx3RUFBa0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxLQUFLO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWU7QUFDZiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvdG9waWMtYWxpYXMtc2VuZC5qcz8wZmFhIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgbHJ1X2NhY2hlXzEgPSByZXF1aXJlKFwibHJ1LWNhY2hlXCIpO1xuY29uc3QgbnVtYmVyX2FsbG9jYXRvcl8xID0gcmVxdWlyZShcIm51bWJlci1hbGxvY2F0b3JcIik7XG5jbGFzcyBUb3BpY0FsaWFzU2VuZCB7XG4gICAgYWxpYXNUb1RvcGljO1xuICAgIHRvcGljVG9BbGlhcztcbiAgICBtYXg7XG4gICAgbnVtYmVyQWxsb2NhdG9yO1xuICAgIGxlbmd0aDtcbiAgICBjb25zdHJ1Y3RvcihtYXgpIHtcbiAgICAgICAgaWYgKG1heCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuYWxpYXNUb1RvcGljID0gbmV3IGxydV9jYWNoZV8xLkxSVUNhY2hlKHsgbWF4IH0pO1xuICAgICAgICAgICAgdGhpcy50b3BpY1RvQWxpYXMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMubnVtYmVyQWxsb2NhdG9yID0gbmV3IG51bWJlcl9hbGxvY2F0b3JfMS5OdW1iZXJBbGxvY2F0b3IoMSwgbWF4KTtcbiAgICAgICAgICAgIHRoaXMubWF4ID0gbWF4O1xuICAgICAgICAgICAgdGhpcy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIHB1dCh0b3BpYywgYWxpYXMpIHtcbiAgICAgICAgaWYgKGFsaWFzID09PSAwIHx8IGFsaWFzID4gdGhpcy5tYXgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbnRyeSA9IHRoaXMuYWxpYXNUb1RvcGljLmdldChhbGlhcyk7XG4gICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMudG9waWNUb0FsaWFzW2VudHJ5XTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFsaWFzVG9Ub3BpYy5zZXQoYWxpYXMsIHRvcGljKTtcbiAgICAgICAgdGhpcy50b3BpY1RvQWxpYXNbdG9waWNdID0gYWxpYXM7XG4gICAgICAgIHRoaXMubnVtYmVyQWxsb2NhdG9yLnVzZShhbGlhcyk7XG4gICAgICAgIHRoaXMubGVuZ3RoID0gdGhpcy5hbGlhc1RvVG9waWMuc2l6ZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGdldFRvcGljQnlBbGlhcyhhbGlhcykge1xuICAgICAgICByZXR1cm4gdGhpcy5hbGlhc1RvVG9waWMuZ2V0KGFsaWFzKTtcbiAgICB9XG4gICAgZ2V0QWxpYXNCeVRvcGljKHRvcGljKSB7XG4gICAgICAgIGNvbnN0IGFsaWFzID0gdGhpcy50b3BpY1RvQWxpYXNbdG9waWNdO1xuICAgICAgICBpZiAodHlwZW9mIGFsaWFzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdGhpcy5hbGlhc1RvVG9waWMuZ2V0KGFsaWFzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWxpYXM7XG4gICAgfVxuICAgIGNsZWFyKCkge1xuICAgICAgICB0aGlzLmFsaWFzVG9Ub3BpYy5jbGVhcigpO1xuICAgICAgICB0aGlzLnRvcGljVG9BbGlhcyA9IHt9O1xuICAgICAgICB0aGlzLm51bWJlckFsbG9jYXRvci5jbGVhcigpO1xuICAgICAgICB0aGlzLmxlbmd0aCA9IDA7XG4gICAgfVxuICAgIGdldExydUFsaWFzKCkge1xuICAgICAgICBjb25zdCBhbGlhcyA9IHRoaXMubnVtYmVyQWxsb2NhdG9yLmZpcnN0VmFjYW50KCk7XG4gICAgICAgIGlmIChhbGlhcylcbiAgICAgICAgICAgIHJldHVybiBhbGlhcztcbiAgICAgICAgcmV0dXJuIFsuLi50aGlzLmFsaWFzVG9Ub3BpYy5rZXlzKCldW3RoaXMuYWxpYXNUb1RvcGljLnNpemUgLSAxXTtcbiAgICB9XG59XG5leHBvcnRzLmRlZmF1bHQgPSBUb3BpY0FsaWFzU2VuZDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRvcGljLWFsaWFzLXNlbmQuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/topic-alias-send.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/unique-message-id-provider.js":
/*!*******************************************************************!*\
  !*** ./node_modules/mqtt/build/lib/unique-message-id-provider.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst number_allocator_1 = __webpack_require__(/*! number-allocator */ \"(ssr)/./node_modules/number-allocator/index.js\");\nclass UniqueMessageIdProvider {\n    numberAllocator;\n    lastId;\n    constructor() {\n        this.numberAllocator = new number_allocator_1.NumberAllocator(1, 65535);\n    }\n    allocate() {\n        this.lastId = this.numberAllocator.alloc();\n        return this.lastId;\n    }\n    getLastAllocated() {\n        return this.lastId;\n    }\n    register(messageId) {\n        return this.numberAllocator.use(messageId);\n    }\n    deallocate(messageId) {\n        this.numberAllocator.free(messageId);\n    }\n    clear() {\n        this.numberAllocator.clear();\n    }\n}\nexports[\"default\"] = UniqueMessageIdProvider;\n//# sourceMappingURL=unique-message-id-provider.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvdW5pcXVlLW1lc3NhZ2UtaWQtcHJvdmlkZXIuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsMkJBQTJCLG1CQUFPLENBQUMsd0VBQWtCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBZTtBQUNmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29sZC1zdG9yYWdlLXN5c3RlbS8uL25vZGVfbW9kdWxlcy9tcXR0L2J1aWxkL2xpYi91bmlxdWUtbWVzc2FnZS1pZC1wcm92aWRlci5qcz9hYWVmIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgbnVtYmVyX2FsbG9jYXRvcl8xID0gcmVxdWlyZShcIm51bWJlci1hbGxvY2F0b3JcIik7XG5jbGFzcyBVbmlxdWVNZXNzYWdlSWRQcm92aWRlciB7XG4gICAgbnVtYmVyQWxsb2NhdG9yO1xuICAgIGxhc3RJZDtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5udW1iZXJBbGxvY2F0b3IgPSBuZXcgbnVtYmVyX2FsbG9jYXRvcl8xLk51bWJlckFsbG9jYXRvcigxLCA2NTUzNSk7XG4gICAgfVxuICAgIGFsbG9jYXRlKCkge1xuICAgICAgICB0aGlzLmxhc3RJZCA9IHRoaXMubnVtYmVyQWxsb2NhdG9yLmFsbG9jKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmxhc3RJZDtcbiAgICB9XG4gICAgZ2V0TGFzdEFsbG9jYXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGFzdElkO1xuICAgIH1cbiAgICByZWdpc3RlcihtZXNzYWdlSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubnVtYmVyQWxsb2NhdG9yLnVzZShtZXNzYWdlSWQpO1xuICAgIH1cbiAgICBkZWFsbG9jYXRlKG1lc3NhZ2VJZCkge1xuICAgICAgICB0aGlzLm51bWJlckFsbG9jYXRvci5mcmVlKG1lc3NhZ2VJZCk7XG4gICAgfVxuICAgIGNsZWFyKCkge1xuICAgICAgICB0aGlzLm51bWJlckFsbG9jYXRvci5jbGVhcigpO1xuICAgIH1cbn1cbmV4cG9ydHMuZGVmYXVsdCA9IFVuaXF1ZU1lc3NhZ2VJZFByb3ZpZGVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dW5pcXVlLW1lc3NhZ2UtaWQtcHJvdmlkZXIuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/unique-message-id-provider.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/lib/validations.js":
/*!****************************************************!*\
  !*** ./node_modules/mqtt/build/lib/validations.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.validateTopic = validateTopic;\nexports.validateTopics = validateTopics;\nfunction validateTopic(topic) {\n    const parts = topic.split('/');\n    for (let i = 0; i < parts.length; i++) {\n        if (parts[i] === '+') {\n            continue;\n        }\n        if (parts[i] === '#') {\n            return i === parts.length - 1;\n        }\n        if (parts[i].indexOf('+') !== -1 || parts[i].indexOf('#') !== -1) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction validateTopics(topics) {\n    if (topics.length === 0) {\n        return 'empty_topic_list';\n    }\n    for (let i = 0; i < topics.length; i++) {\n        if (!validateTopic(topics[i])) {\n            return topics[i];\n        }\n    }\n    return null;\n}\n//# sourceMappingURL=validations.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9saWIvdmFsaWRhdGlvbnMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QscUJBQXFCO0FBQ3JCLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0Esb0JBQW9CLGtCQUFrQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixtQkFBbUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2xkLXN0b3JhZ2Utc3lzdGVtLy4vbm9kZV9tb2R1bGVzL21xdHQvYnVpbGQvbGliL3ZhbGlkYXRpb25zLmpzP2Y5NzkiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLnZhbGlkYXRlVG9waWMgPSB2YWxpZGF0ZVRvcGljO1xuZXhwb3J0cy52YWxpZGF0ZVRvcGljcyA9IHZhbGlkYXRlVG9waWNzO1xuZnVuY3Rpb24gdmFsaWRhdGVUb3BpYyh0b3BpYykge1xuICAgIGNvbnN0IHBhcnRzID0gdG9waWMuc3BsaXQoJy8nKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChwYXJ0c1tpXSA9PT0gJysnKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFydHNbaV0gPT09ICcjJykge1xuICAgICAgICAgICAgcmV0dXJuIGkgPT09IHBhcnRzLmxlbmd0aCAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcnRzW2ldLmluZGV4T2YoJysnKSAhPT0gLTEgfHwgcGFydHNbaV0uaW5kZXhPZignIycpICE9PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVUb3BpY3ModG9waWNzKSB7XG4gICAgaWYgKHRvcGljcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuICdlbXB0eV90b3BpY19saXN0JztcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3BpY3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKCF2YWxpZGF0ZVRvcGljKHRvcGljc1tpXSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0b3BpY3NbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD12YWxpZGF0aW9ucy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/lib/validations.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/build/mqtt.js":
/*!*****************************************!*\
  !*** ./node_modules/mqtt/build/mqtt.js ***!
  \*****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.ReasonCodes = exports.KeepaliveManager = exports.UniqueMessageIdProvider = exports.DefaultMessageIdProvider = exports.Store = exports.MqttClient = exports.connectAsync = exports.connect = exports.Client = void 0;\nconst client_1 = __importDefault(__webpack_require__(/*! ./lib/client */ \"(ssr)/./node_modules/mqtt/build/lib/client.js\"));\nexports.MqttClient = client_1.default;\nconst default_message_id_provider_1 = __importDefault(__webpack_require__(/*! ./lib/default-message-id-provider */ \"(ssr)/./node_modules/mqtt/build/lib/default-message-id-provider.js\"));\nexports.DefaultMessageIdProvider = default_message_id_provider_1.default;\nconst unique_message_id_provider_1 = __importDefault(__webpack_require__(/*! ./lib/unique-message-id-provider */ \"(ssr)/./node_modules/mqtt/build/lib/unique-message-id-provider.js\"));\nexports.UniqueMessageIdProvider = unique_message_id_provider_1.default;\nconst store_1 = __importDefault(__webpack_require__(/*! ./lib/store */ \"(ssr)/./node_modules/mqtt/build/lib/store.js\"));\nexports.Store = store_1.default;\nconst connect_1 = __importStar(__webpack_require__(/*! ./lib/connect */ \"(ssr)/./node_modules/mqtt/build/lib/connect/index.js\"));\nexports.connect = connect_1.default;\nObject.defineProperty(exports, \"connectAsync\", ({ enumerable: true, get: function () { return connect_1.connectAsync; } }));\nconst KeepaliveManager_1 = __importDefault(__webpack_require__(/*! ./lib/KeepaliveManager */ \"(ssr)/./node_modules/mqtt/build/lib/KeepaliveManager.js\"));\nexports.KeepaliveManager = KeepaliveManager_1.default;\nexports.Client = client_1.default;\n__exportStar(__webpack_require__(/*! ./lib/client */ \"(ssr)/./node_modules/mqtt/build/lib/client.js\"), exports);\n__exportStar(__webpack_require__(/*! ./lib/shared */ \"(ssr)/./node_modules/mqtt/build/lib/shared.js\"), exports);\nvar ack_1 = __webpack_require__(/*! ./lib/handlers/ack */ \"(ssr)/./node_modules/mqtt/build/lib/handlers/ack.js\");\nObject.defineProperty(exports, \"ReasonCodes\", ({ enumerable: true, get: function () { return ack_1.ReasonCodes; } }));\n//# sourceMappingURL=mqtt.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9tcXR0LmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG9DQUFvQztBQUNuRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwwQ0FBMEMsNEJBQTRCO0FBQ3RFLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsY0FBYztBQUN6RTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsbUJBQW1CLEdBQUcsd0JBQXdCLEdBQUcsK0JBQStCLEdBQUcsZ0NBQWdDLEdBQUcsYUFBYSxHQUFHLGtCQUFrQixHQUFHLG9CQUFvQixHQUFHLGVBQWUsR0FBRyxjQUFjO0FBQ2xOLGlDQUFpQyxtQkFBTyxDQUFDLG1FQUFjO0FBQ3ZELGtCQUFrQjtBQUNsQixzREFBc0QsbUJBQU8sQ0FBQyw2R0FBbUM7QUFDakcsZ0NBQWdDO0FBQ2hDLHFEQUFxRCxtQkFBTyxDQUFDLDJHQUFrQztBQUMvRiwrQkFBK0I7QUFDL0IsZ0NBQWdDLG1CQUFPLENBQUMsaUVBQWE7QUFDckQsYUFBYTtBQUNiLCtCQUErQixtQkFBTyxDQUFDLDJFQUFlO0FBQ3RELGVBQWU7QUFDZixnREFBK0MsRUFBRSxxQ0FBcUMsa0NBQWtDLEVBQUM7QUFDekgsMkNBQTJDLG1CQUFPLENBQUMsdUZBQXdCO0FBQzNFLHdCQUF3QjtBQUN4QixjQUFjO0FBQ2QsYUFBYSxtQkFBTyxDQUFDLG1FQUFjO0FBQ25DLGFBQWEsbUJBQU8sQ0FBQyxtRUFBYztBQUNuQyxZQUFZLG1CQUFPLENBQUMsK0VBQW9CO0FBQ3hDLCtDQUE4QyxFQUFFLHFDQUFxQyw2QkFBNkIsRUFBQztBQUNuSCIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbGQtc3RvcmFnZS1zeXN0ZW0vLi9ub2RlX21vZHVsZXMvbXF0dC9idWlsZC9tcXR0LmpzPzgxMGYiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0KSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xufSkgOiBmdW5jdGlvbihvLCB2KSB7XG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xufSk7XG52YXIgX19pbXBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG93bktleXMgPSBmdW5jdGlvbihvKSB7XG4gICAgICAgIG93bktleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiAobykge1xuICAgICAgICAgICAgdmFyIGFyID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIG8pIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgaykpIGFyW2FyLmxlbmd0aF0gPSBrO1xuICAgICAgICAgICAgcmV0dXJuIGFyO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gb3duS2V5cyhvKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrID0gb3duS2V5cyhtb2QpLCBpID0gMDsgaSA8IGsubGVuZ3RoOyBpKyspIGlmIChrW2ldICE9PSBcImRlZmF1bHRcIikgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrW2ldKTtcbiAgICAgICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xufSkoKTtcbnZhciBfX2V4cG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9fZXhwb3J0U3RhcikgfHwgZnVuY3Rpb24obSwgZXhwb3J0cykge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0cywgcCkpIF9fY3JlYXRlQmluZGluZyhleHBvcnRzLCBtLCBwKTtcbn07XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLlJlYXNvbkNvZGVzID0gZXhwb3J0cy5LZWVwYWxpdmVNYW5hZ2VyID0gZXhwb3J0cy5VbmlxdWVNZXNzYWdlSWRQcm92aWRlciA9IGV4cG9ydHMuRGVmYXVsdE1lc3NhZ2VJZFByb3ZpZGVyID0gZXhwb3J0cy5TdG9yZSA9IGV4cG9ydHMuTXF0dENsaWVudCA9IGV4cG9ydHMuY29ubmVjdEFzeW5jID0gZXhwb3J0cy5jb25uZWN0ID0gZXhwb3J0cy5DbGllbnQgPSB2b2lkIDA7XG5jb25zdCBjbGllbnRfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9saWIvY2xpZW50XCIpKTtcbmV4cG9ydHMuTXF0dENsaWVudCA9IGNsaWVudF8xLmRlZmF1bHQ7XG5jb25zdCBkZWZhdWx0X21lc3NhZ2VfaWRfcHJvdmlkZXJfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9saWIvZGVmYXVsdC1tZXNzYWdlLWlkLXByb3ZpZGVyXCIpKTtcbmV4cG9ydHMuRGVmYXVsdE1lc3NhZ2VJZFByb3ZpZGVyID0gZGVmYXVsdF9tZXNzYWdlX2lkX3Byb3ZpZGVyXzEuZGVmYXVsdDtcbmNvbnN0IHVuaXF1ZV9tZXNzYWdlX2lkX3Byb3ZpZGVyXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vbGliL3VuaXF1ZS1tZXNzYWdlLWlkLXByb3ZpZGVyXCIpKTtcbmV4cG9ydHMuVW5pcXVlTWVzc2FnZUlkUHJvdmlkZXIgPSB1bmlxdWVfbWVzc2FnZV9pZF9wcm92aWRlcl8xLmRlZmF1bHQ7XG5jb25zdCBzdG9yZV8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL2xpYi9zdG9yZVwiKSk7XG5leHBvcnRzLlN0b3JlID0gc3RvcmVfMS5kZWZhdWx0O1xuY29uc3QgY29ubmVjdF8xID0gX19pbXBvcnRTdGFyKHJlcXVpcmUoXCIuL2xpYi9jb25uZWN0XCIpKTtcbmV4cG9ydHMuY29ubmVjdCA9IGNvbm5lY3RfMS5kZWZhdWx0O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiY29ubmVjdEFzeW5jXCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBjb25uZWN0XzEuY29ubmVjdEFzeW5jOyB9IH0pO1xuY29uc3QgS2VlcGFsaXZlTWFuYWdlcl8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL2xpYi9LZWVwYWxpdmVNYW5hZ2VyXCIpKTtcbmV4cG9ydHMuS2VlcGFsaXZlTWFuYWdlciA9IEtlZXBhbGl2ZU1hbmFnZXJfMS5kZWZhdWx0O1xuZXhwb3J0cy5DbGllbnQgPSBjbGllbnRfMS5kZWZhdWx0O1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2xpYi9jbGllbnRcIiksIGV4cG9ydHMpO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2xpYi9zaGFyZWRcIiksIGV4cG9ydHMpO1xudmFyIGFja18xID0gcmVxdWlyZShcIi4vbGliL2hhbmRsZXJzL2Fja1wiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIlJlYXNvbkNvZGVzXCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBhY2tfMS5SZWFzb25Db2RlczsgfSB9KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1xdHQuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/mqtt/build/mqtt.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/mqtt/package.json":
/*!****************************************!*\
  !*** ./node_modules/mqtt/package.json ***!
  \****************************************/
/***/ ((module) => {

module.exports = /*#__PURE__*/JSON.parse('{"name":"mqtt","description":"A library for the MQTT protocol","version":"5.14.1","contributors":["Adam Rudd <adamvrr@gmail.com>","Matteo Collina <matteo.collina@gmail.com> (https://github.com/mcollina)","Siarhei Buntsevich <scarry0506@gmail.com> (https://github.com/scarry1992)","Yoseph Maguire <yomaguir@microsoft.com> (https://github.com/YoDaMa)","Daniel Lando <daniel.sorridi@gmail.com> (https://github.com/robertsLando)"],"keywords":["mqtt","publish/subscribe","publish","subscribe"],"license":"MIT","repository":{"type":"git","url":"git://github.com/mqttjs/MQTT.js.git"},"main":"./build/index.js","module":"./dist/mqtt.esm.js","bin":{"mqtt_pub":"./build/bin/pub.js","mqtt_sub":"./build/bin/sub.js","mqtt":"./build/bin/mqtt.js"},"files":["dist/","CONTRIBUTING.md","LICENSE.md","help/","build/"],"exports":{".":{"react-native":"./dist/mqtt.esm.js","browser":{"import":"./dist/mqtt.esm.js","default":"./dist/mqtt.min.js"},"default":"./build/index.js"},"./package.json":"./package.json","./*.map":"./build/*.js.map","./dist/*":"./dist/*.js","./*":"./build/*.js"},"types":"build/index.d.ts","typesVersions":{"*":{"*":["./build/index.d.ts"]}},"scripts":{"lint":"eslint --ext .ts .","lint-fix":"eslint --fix --ext .ts .","build:ts":"rimraf build/ && tsc -p tsconfig.build.json","build:browser":"node esbuild.js","build":"npm run build:ts && npm run build:browser","prepare":"npm run build","unit-test:node":"node -r esbuild-register --test-concurrency 4 --test-reporter=junit --test-reporter-destination=junit.xml --test-reporter=spec --test-reporter-destination=stdout --test test/node/*.ts ","unit-test:browser":"wtr","test:node":"node_modules/.bin/nyc npm run unit-test:node","test:browser":"npm run build && npm run unit-test:browser","test":"npm run test:node","changelog":"conventional-changelog -p angular -i CHANGELOG.md -s && git add CHANGELOG.md","changelog-init":"conventional-changelog -p angular -i CHANGELOG.md -s -r 0","release":"read -p \'GITHUB_TOKEN: \' GITHUB_TOKEN && export GITHUB_TOKEN=$GITHUB_TOKEN && release-it"},"release-it":{"github":{"release":true},"git":{"tagName":"v${version}","commitMessage":"chore(release): ${version}"},"hooks":{"before:init":["npm run test"]},"npm":{"publish":true},"plugins":{"@release-it/conventional-changelog":{"preset":"angular","infile":"CHANGELOG.md"}}},"publishConfig":{"provenance":true},"pre-commit":["lint"],"engines":{"node":">=16.0.0"},"browser":{"./mqtt.js":"./dist/mqtt.js","fs":false,"tls":false,"net":false},"dependencies":{"@types/readable-stream":"^4.0.21","@types/ws":"^8.18.1","commist":"^3.2.0","concat-stream":"^2.0.0","debug":"^4.4.1","help-me":"^5.0.0","lru-cache":"^10.4.3","minimist":"^1.2.8","mqtt-packet":"^9.0.2","number-allocator":"^1.0.14","readable-stream":"^4.7.0","rfdc":"^1.4.1","socks":"^2.8.6","split2":"^4.2.0","worker-timers":"^8.0.23","ws":"^8.18.3"},"devDependencies":{"@eslint/eslintrc":"^3.3.1","@eslint/js":"^9.32.0","@esm-bundle/chai":"^4.3.4","@release-it/conventional-changelog":"^10.0.1","@tsconfig/node20":"^20.1.6","@types/chai":"^5.2.2","@types/node":"^20.17.16","@types/sinon":"^17.0.4","@types/tape":"^5.8.1","@typescript-eslint/eslint-plugin":"^8.38.0","@typescript-eslint/parser":"^8.38.0","@web/test-runner":"^0.20.2","@web/test-runner-playwright":"^0.11.1","aedes-cli":"^0.8.0","chai":"^5.2.1","chokidar":"^4.0.3","conventional-changelog-cli":"^5.0.0","end-of-stream":"^1.4.5","esbuild":"^0.25.8","esbuild-plugin-polyfill-node":"^0.3.0","esbuild-register":"^3.6.0","eslint":"^9.32.0","eslint-config-prettier":"^10.1.8","eslint-plugin-import":"^2.32.0","eslint-plugin-prettier":"^5.5.3","global":"^4.4.0","globals":"^16.3.0","leaked-handles":"^5.2.0","mkdirp":"^3.0.1","mqtt-connection":"^4.1.0","mqtt-level-store":"^3.1.0","nyc":"^17.1.0","pre-commit":"^1.2.2","prettier":"^3.6.2","release-it":"^19.0.4","rimraf":"^6.0.1","should":"^13.2.3","sinon":"^17.0.2","snazzy":"^9.0.0","tape":"^5.9.0","ts-node":"^10.9.2","typescript":"^5.8.3"}}');

/***/ })

};
;